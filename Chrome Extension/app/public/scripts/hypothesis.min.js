(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){var AnnotationSync,extend,slice=[].slice;extend=require("extend");module.exports=AnnotationSync=function(){AnnotationSync.prototype.options={formatter:function(annotation){return annotation},parser:function(annotation){return annotation},merge:function(local,remote){var k,v;for(k in remote){v=remote[k];local[k]=v}return local},emit:function(){var args,event;event=arguments[0],args=2<=arguments.length?slice.call(arguments,1):[];throw new Error("options.emit unspecified for AnnotationSync.")},on:function(event,handler){throw new Error("options.on unspecified for AnnotationSync.")}};AnnotationSync.prototype.cache=null;function AnnotationSync(bridge,options){var event,func,handler,method,onConnect,ref,ref1;this.bridge=bridge;this.options=extend(true,{},this.options,options);this.cache={};this._on=this.options.on;this._emit=this.options.emit;ref=this._eventListeners;for(event in ref){handler=ref[event];this._on(event,handler.bind(this))}ref1=this._channelListeners;for(method in ref1){func=ref1[method];this.bridge.on(method,func.bind(this))}onConnect=function(_this){return function(channel){return _this._syncCache(channel)}}(this);this.bridge.onConnect(onConnect)}AnnotationSync.prototype.getAnnotationForTag=function(tag){return this.cache[tag]||null};AnnotationSync.prototype.sync=function(annotations,cb){var a;annotations=function(){var i,len,results1;results1=[];for(i=0,len=annotations.length;i<len;i++){a=annotations[i];results1.push(this._format(a))}return results1}.call(this);this.bridge.call({method:"sync",params:annotations,callback:cb});return this};AnnotationSync.prototype._channelListeners={beforeCreateAnnotation:function(txn,body){var annotation;annotation=this._parse(body);delete this.cache[annotation.$$tag];this._emit("beforeAnnotationCreated",annotation);this.cache[annotation.$$tag]=annotation;return this._format(annotation)},createAnnotation:function(txn,body){var annotation;annotation=this._parse(body);delete this.cache[annotation.$$tag];this._emit("annotationCreated",annotation);this.cache[annotation.$$tag]=annotation;return this._format(annotation)},updateAnnotation:function(txn,body){var annotation;annotation=this._parse(body);delete this.cache[annotation.$$tag];this._emit("beforeAnnotationUpdated",annotation);this._emit("annotationUpdated",annotation);this.cache[annotation.$$tag]=annotation;return this._format(annotation)},deleteAnnotation:function(txn,body){var annotation,res;annotation=this._parse(body);delete this.cache[annotation.$$tag];this._emit("annotationDeleted",annotation);res=this._format(annotation);return res},sync:function(ctx,bodies){var b,i,len,results1;results1=[];for(i=0,len=bodies.length;i<len;i++){b=bodies[i];results1.push(this._format(this._parse(b)))}return results1},loadAnnotations:function(txn,bodies){var a,annotations;annotations=function(){var i,len,results1;results1=[];for(i=0,len=bodies.length;i<len;i++){a=bodies[i];results1.push(this._parse(a))}return results1}.call(this);return this._emit("loadAnnotations",annotations)}};AnnotationSync.prototype._eventListeners={beforeAnnotationCreated:function(annotation){if(annotation.$$tag!=null){return}return this._mkCallRemotelyAndParseResults("beforeCreateAnnotation")(annotation)},annotationCreated:function(annotation){if(!(annotation.$$tag!=null&&this.cache[annotation.$$tag])){return}return this._mkCallRemotelyAndParseResults("createAnnotation")(annotation)},annotationUpdated:function(annotation){if(!(annotation.$$tag!=null&&this.cache[annotation.$$tag])){return}return this._mkCallRemotelyAndParseResults("updateAnnotation")(annotation)},annotationDeleted:function(annotation){var onFailure;if(!(annotation.$$tag!=null&&this.cache[annotation.$$tag])){return}onFailure=function(_this){return function(err){if(!err){return delete _this.cache[annotation.$$tag]}}}(this);return this._mkCallRemotelyAndParseResults("deleteAnnotation",onFailure)(annotation)},annotationsLoaded:function(annotations){var a,bodies;bodies=function(){var i,len,results1;results1=[];for(i=0,len=annotations.length;i<len;i++){a=annotations[i];if(!a.$$tag){results1.push(this._format(a))}}return results1}.call(this);if(!bodies.length){return}return this.bridge.notify({method:"loadAnnotations",params:bodies})}};AnnotationSync.prototype._syncCache=function(channel){var a,annotations,t;annotations=function(){var ref,results1;ref=this.cache;results1=[];for(t in ref){a=ref[t];results1.push(this._format(a))}return results1}.call(this);if(annotations.length){return channel.notify({method:"loadAnnotations",params:annotations})}};AnnotationSync.prototype._mkCallRemotelyAndParseResults=function(method,callBack){return function(_this){return function(annotation){var options,wrappedCallback;wrappedCallback=function(failure,results){if(failure==null){_this._parseResults(results)}return typeof callBack==="function"?callBack(failure,results):void 0};options={method:method,callback:wrappedCallback,params:_this._format(annotation)};return _this.bridge.call(options)}}(this)};AnnotationSync.prototype._parseResults=function(results){var bodies,body,i,j,len,len1;for(i=0,len=results.length;i<len;i++){bodies=results[i];bodies=[].concat(bodies);for(j=0,len1=bodies.length;j<len1;j++){body=bodies[j];if(body!==null){this._parse(body)}}}};AnnotationSync.prototype._tag=function(ann,tag){if(ann.$$tag){return ann}tag=tag||window.btoa(Math.random());Object.defineProperty(ann,"$$tag",{value:tag});this.cache[tag]=ann;return ann};AnnotationSync.prototype._parse=function(body){var local,merged,remote;local=this.cache[body.tag];remote=this.options.parser(body.msg);if(local!=null){merged=this.options.merge(local,remote)}else{merged=remote}return this._tag(merged,body.tag)};AnnotationSync.prototype._format=function(ann){this._tag(ann);return{tag:ann.$$tag,msg:this.options.formatter(ann)}};return AnnotationSync}()},{extend:32}],2:[function(require,module,exports){var $,Annotator,Guest,Promise,bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){for(var key in parent){if(hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child},hasProp={}.hasOwnProperty,slice=[].slice,indexOf=[].indexOf||function(item){for(var i=0,l=this.length;i<l;i++){if(i in this&&this[i]===item)return i}return-1};Promise=require("es6-promise").Promise;Annotator=require("annotator");$=Annotator.$;module.exports=Guest=function(superClass){var SHOW_HIGHLIGHTS_CLASS;extend(Guest,superClass);SHOW_HIGHLIGHTS_CLASS="annotator-highlights-always-on";Guest.prototype.events={".annotator-adder button click":"onAdderClick",".annotator-adder button mousedown":"onAdderMousedown",".annotator-adder button mouseup":"onAdderMouseup",setVisibleHighlights:"setVisibleHighlights"};Guest.prototype.options={TextHighlights:{},EnhancedAnchoring:{},DomTextMapper:{},TextSelection:{},TextRange:{},TextPosition:{},TextQuote:{},FuzzyTextAnchors:{},FragmentSelector:{}};Guest.prototype.visibleHighlights=false;Guest.prototype.html=jQuery.extend({},Annotator.prototype.html,{adder:'<div class="annotator-adder">\n  <button class="h-icon-insert-comment" data-action="comment" title="New Note"></button>\n  <button class="h-icon-border-color" data-action="highlight" title="Highlight"></button>\n</div>'});function Guest(element,options,config){var cfOptions,name,opts,ref,ref1;if(config==null){config={}}this.onAdderClick=bind(this.onAdderClick,this);this.onAnchorClick=bind(this.onAnchorClick,this);this.selectAnnotations=bind(this.selectAnnotations,this);this.focusAnnotations=bind(this.focusAnnotations,this);this.updateAnnotations=bind(this.updateAnnotations,this);this.toggleAnnotationSelection=bind(this.toggleAnnotationSelection,this);this.showAnnotations=bind(this.showAnnotations,this);this.getMetadata=bind(this.getMetadata,this);options.noScan=true;Guest.__super__.constructor.apply(this,arguments);delete this.options.noScan;if((ref=window.PDFTextMapper)!=null?ref.applicable():void 0){this.options.PDF={}}else{this.options.Document={}}delete this.options.app;cfOptions={on:function(_this){return function(event,handler){return _this.subscribe(event,handler)}}(this),emit:function(_this){return function(){var args,event;event=arguments[0],args=2<=arguments.length?slice.call(arguments,1):[];switch(event){case"annotationDeleted":return _this.deleteAnnotation.apply(_this,args);case"loadAnnotations":return _this.loadAnnotations.apply(_this,args);default:return _this.publish(event,args)}}}(this),formatter:function(_this){return function(annotation){var formatted,k,ref1,v;formatted={};formatted.uri=_this.getHref();for(k in annotation){v=annotation[k];if(k!=="anchors"){formatted[k]=v}}if((ref1=formatted.document)!=null?ref1.title:void 0){formatted.document.title=formatted.document.title.slice()}return formatted}}(this)};this.addPlugin("CrossFrame",cfOptions);this.crossframe=this._connectAnnotationUISync(this.plugins.CrossFrame);ref1=this.options;for(name in ref1){if(!hasProp.call(ref1,name))continue;opts=ref1[name];if(!this.plugins[name]&&Annotator.Plugin[name]){this.addPlugin(name,opts)}}if(!config.dontScan){this.anchoring._scan()}this.subscribe("highlightsCreated",function(_this){return function(highlights){var annotations,hl;if(!Array.isArray(highlights)){highlights=[highlights]}highlights.forEach(function(hl){var firstHl,firstPage,hls,pages;hls=hl.anchor.highlight;pages=Object.keys(hls).map(function(s){return parseInt(s)});firstPage=pages.sort()[0];firstHl=hls[firstPage];return hl.anchor.target.pos={top:hl.getTop(),height:hl.getHeight()}});annotations=function(){var i,len,results;results=[];for(i=0,len=highlights.length;i<len;i++){hl=highlights[i];results.push(hl.annotation)}return results}();return _this.plugins.CrossFrame.sync(annotations)}}(this));this.subscribe("highlightRemoved",function(_this){return function(highlight){var firstHl,firstPage,hls,pages;hls=highlight.anchor.highlight;pages=Object.keys(hls).map(function(s){return parseInt(s)});if(pages.length){firstPage=pages.sort()[0];firstHl=hls[firstPage];highlight.anchor.target.pos={top:highlight.getTop(),heigth:highlight.getHeight()}}else{delete highlight.anchor.target.pos}return _this.plugins.CrossFrame.sync([highlight.annotation])}}(this))}Guest.prototype._removeHash=function(url){url=new URL(url);url.hash="";return url.toString()};Guest.prototype.getRawHref=function(){if(this.plugins.PDF){return this.plugins.PDF.uri()}else{return this.plugins.Document.uri()}};Guest.prototype.getHref=function(){return this._removeHash(this.getRawHref())};Guest.prototype.getMetadata=function(){var metadata,ref,ref1;metadata=(ref=this.plugins.Document)!=null?ref.metadata:void 0;if((ref1=metadata.link)!=null){ref1.forEach(function(_this){return function(link){return link.href=_this._removeHash(link.href)}}(this))}return metadata};Guest.prototype._connectAnnotationUISync=function(crossframe){crossframe.onConnect(function(_this){return function(){return _this.publish("panelReady")}}(this));crossframe.on("onEditorHide",this.onEditorHide);crossframe.on("onEditorSubmit",this.onEditorSubmit);crossframe.on("focusAnnotations",function(_this){return function(ctx,tags){var hl,i,len,ref,ref1,results;if(tags==null){tags=[]}ref=_this.anchoring.getHighlights();results=[];for(i=0,len=ref.length;i<len;i++){hl=ref[i];if(ref1=hl.annotation.$$tag,indexOf.call(tags,ref1)>=0){results.push(hl.setFocused(true))}else{results.push(hl.setFocused(false))}}return results}}(this));crossframe.on("scrollToAnnotation",function(_this){return function(ctx,tag){var a,i,len,ref;ref=_this.anchoring.getAnchors();for(i=0,len=ref.length;i<len;i++){a=ref[i];if(a.annotation.$$tag===tag){a.scrollToView();return}}}}(this));crossframe.on("getDocumentInfo",function(_this){return function(trans){var ref,ref1;((ref=(ref1=_this.plugins.PDF)!=null?ref1.getMetaData():void 0)!=null?ref:Promise.reject()).then(function(md){return trans.complete({uri:_this.getHref(),metadata:md})})["catch"](function(problem){return trans.complete({uri:_this.getHref(),metadata:_this.getMetadata()})})["catch"](function(e){});return trans.delayReturn(true)}}(this));return crossframe.on("setVisibleHighlights",function(_this){return function(ctx,state){return _this.publish("setVisibleHighlights",state)}}(this))};Guest.prototype._setupWrapper=function(){this.wrapper=this.element.on("click",function(_this){return function(event){var ref;if(!((ref=_this.selectedTargets)!=null?ref.length:void 0)){return _this.triggerHideFrame()}}}(this));return this};Guest.prototype._setupDynamicStyle=function(){return this};Guest.prototype._setupViewer=function(){return this};Guest.prototype._setupEditor=function(){return this};Guest.prototype._setupDocumentEvents=function(){return this};Guest.prototype.destroy=function(){var name,plugin,ref;$("#annotator-dynamic-style").remove();this.adder.remove();this.wrapper.find(".annotator-hl").each(function(){$(this).contents().insertBefore(this);return $(this).remove()});this.element.data("annotator",null);ref=this.plugins;for(name in ref){plugin=ref[name];this.plugins[name].destroy()}return this.removeEvents()};Guest.prototype.setupAnnotation=function(){var annotation;annotation=Guest.__super__.setupAnnotation.apply(this,arguments);this.plugins.CrossFrame.sync([annotation]);return annotation};Guest.prototype.createAnnotation=function(){var annotation;annotation=Guest.__super__.createAnnotation.apply(this,arguments);this.plugins.CrossFrame.sync([annotation]);return annotation};Guest.prototype.createHighlight=function(){var annotation;annotation={$highlight:true};this.publish("beforeAnnotationCreated",[annotation]);this.plugins.CrossFrame.sync([annotation]);return annotation};Guest.prototype.showAnnotations=function(annotations){var a,ref;return(ref=this.crossframe)!=null?ref.notify({method:"showAnnotations",params:function(){var i,len,results;results=[];for(i=0,len=annotations.length;i<len;i++){a=annotations[i];results.push(a.$$tag)}return results}()}):void 0};Guest.prototype.toggleAnnotationSelection=function(annotations){var a,ref;return(ref=this.crossframe)!=null?ref.notify({method:"toggleAnnotationSelection",params:function(){var i,len,results;results=[];for(i=0,len=annotations.length;i<len;i++){a=annotations[i];results.push(a.$$tag)}return results}()}):void 0};Guest.prototype.updateAnnotations=function(annotations){var a,ref;return(ref=this.crossframe)!=null?ref.notify({method:"updateAnnotations",params:function(){var i,len,results;results=[];for(i=0,len=annotations.length;i<len;i++){a=annotations[i];results.push(a.$$tag)}return results}()}):void 0};Guest.prototype.focusAnnotations=function(annotations){var a,ref;return(ref=this.crossframe)!=null?ref.notify({method:"focusAnnotations",params:function(){var i,len,results;results=[];for(i=0,len=annotations.length;i<len;i++){a=annotations[i];results.push(a.$$tag)}return results}()}):void 0};Guest.prototype.onAnchorMousedown=function(){};Guest.prototype._getTargetFromSelection=function(selection){return{source:this.getHref(),selector:this.anchoring.getSelectorsFromSelection(selection)}};Guest.prototype.confirmSelection=function(){var quote;if(this.selectedTargets.length!==1){return true}quote=this.getQuoteForTarget(this.selectedTargets[0]);if(quote.length>2){return true}return confirm("You have selected a very short piece of text: only "+length+" chars. Are you sure you want to highlight this?")};Guest.prototype.onSuccessfulSelection=function(event,immediate){var s;if(event==null){throw"Called onSuccessfulSelection without an event!"}if(event.segments==null){throw"Called onSuccessulSelection with an event with missing segments!"}this.selectedTargets=function(){var i,len,ref,results;ref=event.segments;results=[];for(i=0,len=ref.length;i<len;i++){s=ref[i];results.push(this._getTargetFromSelection(s))}return results}.call(this);if(immediate){this.onAdderClick(event)}else{this.adder.css(Annotator.Util.mousePosition(event,this.wrapper[0])).show()}return true};Guest.prototype.onFailedSelection=function(event){this.adder.hide();return this.selectedTargets=[]};Guest.prototype.selectAnnotations=function(annotations,toggle){if(toggle){return this.toggleAnnotationSelection(annotations)}else{this.triggerShowFrame();return this.showAnnotations(annotations)}};Guest.prototype.onAnchorMouseover=function(event){var annotations;if(this.visibleHighlights){event.stopPropagation();annotations=event.data.getAnnotations(event);return this.focusAnnotations(annotations)}};Guest.prototype.onAnchorMouseout=function(event){if(this.visibleHighlights){event.stopPropagation();return this.focusAnnotations([])}};Guest.prototype.onAnchorClick=function(event){if(this.visibleHighlights){event.stopPropagation();return this.selectAnnotations(event.data.getAnnotations(event),event.metaKey||event.ctrlKey)}};Guest.prototype.setVisibleHighlights=function(shouldShowHighlights){var ref;if(this.visibleHighlights===shouldShowHighlights){return}if((ref=this.crossframe)!=null){ref.notify({method:"setVisibleHighlights",params:shouldShowHighlights})}return this.toggleHighlightClass(shouldShowHighlights)};Guest.prototype.toggleHighlightClass=function(shouldShowHighlights){if(shouldShowHighlights){this.element.addClass(SHOW_HIGHLIGHTS_CLASS)}else{this.element.removeClass(SHOW_HIGHLIGHTS_CLASS)}return this.visibleHighlights=shouldShowHighlights};Guest.prototype.triggerShowFrame=function(){var ref;return(ref=this.crossframe)!=null?ref.notify({method:"open"}):void 0};Guest.prototype.triggerHideFrame=function(){var ref;return(ref=this.crossframe)!=null?ref.notify({method:"back"}):void 0};Guest.prototype.onAdderMouseup=function(event){event.preventDefault();return event.stopPropagation()};Guest.prototype.onAdderMousedown=function(){};Guest.prototype.onAdderClick=function(event){if(typeof event.preventDefault==="function"){event.preventDefault()}if(typeof event.stopPropagation==="function"){event.stopPropagation()}this.adder.hide();switch(event.target.dataset.action){case"highlight":this.setVisibleHighlights(true);this.setupAnnotation(this.createHighlight());break;case"comment":this.setupAnnotation(this.createAnnotation());this.triggerShowFrame()}return Annotator.Util.getGlobal().getSelection().removeAllRanges()};return Guest}(Annotator)},{annotator:22,"es6-promise":31}],3:[function(require,module,exports){var $,Annotator,Guest,Hammer,Host,MIN_RESIZE,bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){for(var key in parent){if(hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child},hasProp={}.hasOwnProperty,indexOf=[].indexOf||function(item){for(var i=0,l=this.length;i<l;i++){if(i in this&&this[i]===item)return i}return-1};Annotator=require("annotator");$=Annotator.$;Hammer=require("hammerjs");Guest=require("./guest");MIN_RESIZE=280;module.exports=Host=function(superClass){extend(Host,superClass);Host.prototype.gestureState=null;function Host(element,options){this.onSwipe=bind(this.onSwipe,this);this.onPan=bind(this.onPan,this);var app,src;src=options.app;if(options.firstRun){src=src+(indexOf.call(src,"?")>=0?"&":"?")+"firstrun"}app=$("<iframe></iframe>").attr("name","hyp_sidebar_frame").attr("seamless","").attr("src",src);this.frame=$("<div></div>").css("display","none").addClass("annotator-frame annotator-outer annotator-collapsed").appendTo(element);Host.__super__.constructor.call(this,element,options,{dontScan:true});this._addCrossFrameListeners();app.appendTo(this.frame);if(options.firstRun){this.on("panelReady",function(_this){return function(){return _this.showFrame({transition:false})}}(this))}this.on("panelReady",function(_this){return function(){_this.anchoring._scan();_this.publish("setVisibleHighlights",!!options.showHighlights);return _this.frame.css("display","")}}(this));if(this.plugins.BucketBar!=null){this._setupGestures();this.plugins.BucketBar.element.on("click",function(_this){return function(event){if(_this.frame.hasClass("annotator-collapsed")){return _this.showFrame()}}}(this))}}Host.prototype.destroy=function(){this.frame.remove();return Host.__super__.destroy.apply(this,arguments)};Host.prototype.showFrame=function(options){if(options==null){options={transition:true}}if(options.transition){this.frame.removeClass("annotator-no-transition")}else{this.frame.addClass("annotator-no-transition")}this.frame.css({"margin-left":-1*this.frame.width()+"px"});this.frame.removeClass("annotator-collapsed");if(this.toolbar!=null){return this.toolbar.find("[name=sidebar-toggle]").removeClass("h-icon-chevron-left").addClass("h-icon-chevron-right")}};Host.prototype.hideFrame=function(){this.frame.css({"margin-left":""});this.frame.removeClass("annotator-no-transition");this.frame.addClass("annotator-collapsed");if(this.toolbar!=null){return this.toolbar.find("[name=sidebar-toggle]").removeClass("h-icon-chevron-right").addClass("h-icon-chevron-left")}};Host.prototype._addCrossFrameListeners=function(){this.crossframe.on("showFrame",this.showFrame.bind(this,null));return this.crossframe.on("hideFrame",this.hideFrame.bind(this,null))};Host.prototype._initializeGestureState=function(){return this.gestureState={acc:null,initial:null,renderFrame:null}};Host.prototype.onPan=function(event){var _updateLayout,acc,d,m;_updateLayout=function(_this){return function(){if(_this.gestureState.renderFrame){return}return _this.gestureState.renderFrame=window.requestAnimationFrame(function(){var m,w;_this.gestureState.renderFrame=null;if(_this.gestureState.acc==null){return}m=_this.gestureState.acc;w=-m;_this.frame.css("margin-left",m+"px");if(w>=MIN_RESIZE){return _this.frame.css("width",-m+"px")}})}}(this);switch(event.type){case"panstart":this._initializeGestureState();this.frame.addClass("annotator-no-transition");this.frame.css("pointer-events","none");return this.gestureState.initial=parseInt(getComputedStyle(this.frame[0]).marginLeft);case"panend":this.frame.removeClass("annotator-no-transition");this.frame.css("pointer-events","");if(this.gestureState.acc<=-MIN_RESIZE){this.showFrame()}else{this.hideFrame()}return this._initializeGestureState();case"panleft":case"panright":if(this.gestureState.initial==null){return}m=this.gestureState.initial;d=event.deltaX;acc=Math.min(Math.round(m+d),0);this.gestureState.acc=acc;return _updateLayout()}};Host.prototype.onSwipe=function(event){switch(event.type){case"swipeleft":return this.showFrame();case"swiperight":return this.hideFrame()}};Host.prototype._setupGestures=function(){var $toggle,mgr,pan,swipe;$toggle=this.toolbar.find("[name=sidebar-toggle]");$toggle.on("touchmove",function(event){return event.preventDefault()});mgr=new Hammer.Manager($toggle[0]).on("panstart panend panleft panright",this.onPan).on("swipeleft swiperight",this.onSwipe);pan=mgr.add(new Hammer.Pan({direction:Hammer.DIRECTION_HORIZONTAL}));swipe=mgr.add(new Hammer.Swipe({direction:Hammer.DIRECTION_HORIZONTAL}));swipe.recognizeWith(pan);this._initializeGestureState();return this};return Host}(Guest)},{"./guest":2,annotator:22,hammerjs:33}],4:[function(require,module,exports){var Annotator=require("annotator");require("./monkey");Annotator.Guest=require("./guest");Annotator.Host=require("./host");Annotator.Plugin.CrossFrame=require("./plugin/cross-frame");Annotator.Plugin.CrossFrame.Bridge=require("../bridge");Annotator.Plugin.CrossFrame.AnnotationSync=require("../annotation-sync");Annotator.Plugin.CrossFrame.Discovery=require("../discovery");require("../vendor/annotator.document");require("./plugin/bucket-bar");require("./plugin/toolbar");require("./plugin/texthighlights");require("./plugin/textselection");require("./plugin/fragmentselector");require("diff-match-patch");require("dom-text-mapper");require("dom-text-matcher");require("page-text-mapper-core");require("text-match-engines");require("./plugin/enhancedanchoring");require("./plugin/domtextmapper");require("./plugin/fuzzytextanchors");require("./plugin/pdf");require("./plugin/textquote");require("./plugin/textposition");require("./plugin/textrange");var Klass=Annotator.Host;var docs="https://github.com/hypothesis/h/blob/master/README.rst#customized-embedding";var options={app:jQuery('link[type="application/annotator+html"]').attr("href"),BucketBar:{container:".annotator-frame"},Toolbar:{container:".annotator-frame"}};if(window.hasOwnProperty("hypothesisRole")){if(typeof window.hypothesisRole==="function"){Klass=window.hypothesisRole}else{throw new TypeError("hypothesisRole must be a constructor function, see: "+docs)}}var ua=window.navigator.userAgent;if(ua.indexOf("MSIE ")>0||ua.indexOf("Trident/")>0||ua.indexOf("Edge/")>0){options["DomTextMapper"]={skip:true}}if(window.hasOwnProperty("hypothesisConfig")){if(typeof window.hypothesisConfig==="function"){options=jQuery.extend(options,window.hypothesisConfig())}else{throw new TypeError("hypothesisConfig must be a function, see: "+docs)}}Annotator.noConflict().$.noConflict(true)(function(){window.annotator=new Klass(document.body,options)})},{"../annotation-sync":1,"../bridge":19,"../discovery":20,"../vendor/annotator.document":21,"./guest":2,"./host":3,"./monkey":5,"./plugin/bucket-bar":6,"./plugin/cross-frame":7,"./plugin/domtextmapper":8,"./plugin/enhancedanchoring":9,"./plugin/fragmentselector":10,"./plugin/fuzzytextanchors":11,"./plugin/pdf":12,"./plugin/texthighlights":13,"./plugin/textposition":14,"./plugin/textquote":15,"./plugin/textrange":16,"./plugin/textselection":17,"./plugin/toolbar":18,annotator:22,"diff-match-patch":23,"dom-text-mapper":24,"dom-text-matcher":25,"page-text-mapper-core":29,"text-match-engines":30}],5:[function(require,module,exports){var Annotator,Range,Util,g;Annotator=require("annotator");Range=Annotator.Range;Util=Annotator.Util;delete Annotator.prototype.events[".annotator-hl mouseover"];delete Annotator.prototype.events[".annotator-hl mouseout"];Annotator.prototype.setupAnnotation=function(annotation){var anchor,exception,i,len,ref,ref1,ref2,ref3,ref4,result,t;if(annotation.target==null){annotation.target=this.selectedTargets}this.selectedTargets=[];annotation.anchors=[];ref1=(ref=annotation.target)!=null?ref:[];for(i=0,len=ref1.length;i<len;i++){t=ref1[i];try{result=this.anchoring.createAnchor(annotation,t);anchor=result.result;if((result.error!=null)instanceof Range.RangeError){this.publish("rangeNormalizeFail",[annotation,result.error.range,result.error])}if(anchor!=null){t.diffHTML=anchor.diffHTML;t.diffCaseOnly=anchor.diffCaseOnly}}catch(_error){exception=_error;console.log("Error in setupAnnotation for",annotation.id,":",(ref2=exception.stack)!=null?ref2:exception)}}if(((ref3=annotation.target)!=null?ref3.length:void 0)&&!((ref4=annotation.anchors)!=null?ref4.length:void 0)){annotation.$orphan=true}return annotation};Annotator.prototype.deleteAnnotation=function(annotation){var a,i,len,ref;if(annotation.anchors!=null){ref=annotation.anchors;for(i=0,len=ref.length;i<len;i++){a=ref[i];a.remove()}}this.publish("annotationDeleted",[annotation]);return annotation};g=Annotator.Util.getGlobal();if(g.wgxpath!=null){g.wgxpath.install()}Range.BrowserRange.prototype.normalize=function(root){var changed,event,n,node,nr,prev,r;if(this.tainted){console.error(_t("You may only call normalize() once on a BrowserRange!"));return false}else{this.tainted=true}r={};if(this.startContainer.nodeType===Node.ELEMENT_NODE){r.start=Util.getFirstTextNodeNotBefore(this.startContainer.childNodes[this.startOffset]);r.startOffset=0}else{r.start=this.startContainer;r.startOffset=this.startOffset}if(this.endContainer.nodeType===Node.ELEMENT_NODE){node=this.endContainer.childNodes[this.endOffset];if(node!=null){n=node;while(n!=null&&n.nodeType!==Node.TEXT_NODE){n=n.firstChild}if(n!=null){prev=n.previousSibling;if(prev!=null&&prev.nodeType===Node.TEXT_NODE){r.end=prev;r.endOffset=prev.nodeValue.length}else{r.end=n;r.endOffset=0}}}if(r.end==null){if(this.endOffset){node=this.endContainer.childNodes[this.endOffset-1]}else{node=this.endContainer.previousSibling}r.end=Util.getLastTextNodeUpTo(node);r.endOffset=r.end.nodeValue.length}}else{r.end=this.endContainer;r.endOffset=this.endOffset}nr={};changed=false;if(r.startOffset>0){if(r.start.nodeValue.length>r.startOffset){nr.start=r.start.splitText(r.startOffset);changed=true}else{nr.start=r.start.nextSibling}}else{nr.start=r.start}if(r.start===r.end){if(nr.start.nodeValue.length>r.endOffset-r.startOffset){nr.start.splitText(r.endOffset-r.startOffset);changed=true}nr.end=nr.start}else{if(r.end.nodeValue.length>r.endOffset){r.end.splitText(r.endOffset);changed=true}nr.end=r.end}nr.commonAncestor=this.commonAncestorContainer;while(nr.commonAncestor.nodeType!==Node.ELEMENT_NODE){nr.commonAncestor=nr.commonAncestor.parentNode}if(changed){event=document.createEvent("UIEvents");event.initUIEvent("domChange",true,false,window,0);event.reason="range normalization";event.data=nr;nr.commonAncestor.dispatchEvent(event)}return new Range.NormalizedRange(nr)}},{annotator:22}],6:[function(require,module,exports){var $,Annotator,raf,bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){for(var key in parent){if(hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child},hasProp={}.hasOwnProperty,indexOf=[].indexOf||function(item){for(var i=0,l=this.length;i<l;i++){if(i in this&&this[i]===item)return i}return-1};raf=require("raf");Annotator=require("annotator");$=Annotator.$;Annotator.Plugin.BucketBar=function(superClass){extend(BucketBar,superClass);BucketBar.prototype.BUCKET_THRESHOLD_PAD=106;BucketBar.prototype.BUCKET_SIZE=16;BucketBar.prototype.html='<div class="annotator-bucket-bar">\n</div>';BucketBar.prototype.options={gapSize:60};BucketBar.prototype.buckets=[];BucketBar.prototype.index=[];BucketBar.prototype.tabs=null;function BucketBar(element,options){this._update=bind(this._update,this);this._scheduleUpdate=bind(this._scheduleUpdate,this);BucketBar.__super__.constructor.call(this,$(this.html),options);if(this.options.container!=null){$(this.options.container).append(this.element)}else{$(element).append(this.element)}}BucketBar.prototype.pluginInit=function(){var event,events,k,len;events=["annotationCreated","annotationUpdated","annotationDeleted","annotationsLoaded"];for(k=0,len=events.length;k<len;k++){event=events[k];this.annotator.subscribe(event,this._scheduleUpdate)}$(window).on("resize scroll",this._scheduleUpdate);$(document.body).on("resize scroll","*",this._scheduleUpdate);this.annotator.subscribe("highlightsCreated",function(_this){return function(highlights){var anchor;anchor=Array.isArray(highlights)?highlights[0].anchor:highlights.anchor;if(anchor.annotation.id!=null){return _this._scheduleUpdate()}}}(this));this.annotator.subscribe("highlightRemoved",function(_this){return function(highlight){if(highlight.annotation.id!=null){return _this._scheduleUpdate()}}}(this));return addEventListener("docPageScrolling",this._scheduleUpdate)};BucketBar.prototype._scheduleUpdate=function(){if(this._updatePending!=null){return}return this._updatePending=raf(function(_this){return function(){delete _this._updatePending;return _this._update()}}(this))};BucketBar.prototype._collate=function(a,b){var i,k,ref;for(i=k=0,ref=a.length-1;0<=ref?k<=ref:k>=ref;i=0<=ref?++k:--k){if(a[i]<b[i]){return-1}if(a[i]>b[i]){return 1}}return 0;
};BucketBar.prototype._collectVirtualAnnotations=function(startPage,endPage){var anchor,anchors,k,page,ref,ref1,results;results=[];for(page=k=ref=startPage,ref1=endPage;ref<=ref1?k<=ref1:k>=ref1;page=ref<=ref1?++k:--k){anchors=this.annotator.anchoring.anchors[page];if(anchors!=null){$.merge(results,function(){var l,len,results1;results1=[];for(l=0,len=anchors.length;l<len;l++){anchor=anchors[l];if(!anchor.fullyRealized){results1.push(anchor.annotation)}}return results1}())}}return results};BucketBar.prototype._jumpMinMax=function(annotations,direction){var anchor,dir,next;if(direction!=="up"&&direction!=="down"){throw"Direction is mandatory!"}dir=direction==="up"?+1:-1;next=annotations.reduce(function(acc,ann){var anchor,hl,rect,ref,start;start=acc.start,next=acc.next;anchor=ann.anchors[0];hl=anchor.highlight[anchor.startPage];if(hl!=null){rect=hl.getBoundingClientRect();switch(dir){case 1:if(rect.bottom>=0){return acc}break;case-1:if(rect.top<=window.innerHeight){return acc}}}if(next==null||start.page*dir<anchor.startPage*dir){return{start:{page:anchor.startPage,top:(ref=anchor.highlight[anchor.startPage])!=null?ref.getTop():void 0},next:[anchor]}}else if(start.page===anchor.startPage){if(hl!=null){if(start.top*dir<hl.getTop()*dir){return{start:{page:start.page,top:hl.getTop()},next:[anchor]}}else{return acc}}else{return{start:{page:start.page},next:$.merge(next,[anchor])}}}else{return acc}},{}).next;anchor=next[0];return anchor.scrollToView()};BucketBar.prototype._update=function(){var above,b,below,currentPage,defaultView,element,firstPage,highlights,k,lastPage,len,mapper,max,points,ref,ref1,wrapper;wrapper=this.annotator.wrapper;highlights=this.annotator.anchoring.getHighlights();defaultView=wrapper[0].ownerDocument.defaultView;above=[];below=[];mapper=this.annotator.anchoring.document;if(mapper==null){return}firstPage=0;currentPage=mapper.getPageIndex();lastPage=mapper.getPageCount()-1;$.merge(above,this._collectVirtualAnnotations(0,currentPage-1));$.merge(below,this._collectVirtualAnnotations(currentPage+1,lastPage));points=highlights.reduce(function(_this){return function(points,hl,i){var d,h,x;d=hl.annotation;x=hl.getTop()-defaultView.pageYOffset;h=hl.getHeight();if(x<0){if(indexOf.call(above,d)<0){above.push(d)}}else if(x+h>window.innerHeight){if(indexOf.call(below,d)<0){below.push(d)}}else{points.push([x,1,d]);points.push([x+h,-1,d])}return points}}(this),[]);ref=points.sort(this._collate).reduce(function(_this){return function(arg,arg1,i,points){var a,a0,buckets,carry,d,index,j,k,l,last,len,len1,ref,ref1,toMerge,x;buckets=arg.buckets,index=arg.index,carry=arg.carry;x=arg1[0],d=arg1[1],a=arg1[2];if(d>0){if((j=carry.annotations.indexOf(a))<0){carry.annotations.unshift(a);carry.counts.unshift(1)}else{carry.counts[j]++}}else{j=carry.annotations.indexOf(a);if(--carry.counts[j]===0){carry.annotations.splice(j,1);carry.counts.splice(j,1)}}if(index.length===0||i===points.length-1||carry.annotations.length===0||x-index[index.length-1]>_this.options.gapSize){buckets.push(carry.annotations.slice());index.push(x)}else{if((ref=buckets[buckets.length-2])!=null?ref.length:void 0){last=buckets[buckets.length-2];toMerge=buckets.pop();index.pop()}else{last=buckets[buckets.length-1];toMerge=[]}ref1=carry.annotations;for(k=0,len=ref1.length;k<len;k++){a0=ref1[k];if(indexOf.call(last,a0)<0){last.push(a0)}}for(l=0,len1=toMerge.length;l<len1;l++){a0=toMerge[l];if(indexOf.call(last,a0)<0){last.push(a0)}}}return{buckets:buckets,index:index,carry:carry}}}(this),{buckets:[],index:[],carry:{annotations:[],counts:[],latest:0}}),this.buckets=ref.buckets,this.index=ref.index;this.buckets.unshift([],above,[]);this.index.unshift(0,this.BUCKET_THRESHOLD_PAD+6,this.BUCKET_THRESHOLD_PAD+this.BUCKET_SIZE+6);this.buckets.push([],below,[]);this.index.push($(window).height()-this.BUCKET_SIZE-12,$(window).height()-this.BUCKET_SIZE-11,$(window).height());max=0;ref1=this.buckets;for(k=0,len=ref1.length;k<len;k++){b=ref1[k];max=Math.max(max,b.length)}element=this.element;this.tabs||(this.tabs=$([]));this.tabs.slice(this.buckets.length).remove();this.tabs=this.tabs.slice(0,this.buckets.length);$.each(this.buckets.slice(this.tabs.length),function(_this){return function(){var div;div=$("<div/>").appendTo(element);_this.tabs.push(div[0]);return div.addClass("annotator-bucket-indicator").on("mousemove",function(event){var bucket,hl,l,len1,ref2,ref3,results1;bucket=_this.tabs.index(event.currentTarget);ref2=_this.annotator.anchoring.getHighlights();results1=[];for(l=0,len1=ref2.length;l<len1;l++){hl=ref2[l];if(ref3=hl.annotation,indexOf.call(_this.buckets[bucket],ref3)>=0){results1.push(hl.setFocused(true))}else{results1.push(hl.setFocused(false))}}return results1}).on("mouseout",function(){var hl,l,len1,ref2,results1;ref2=_this.annotator.anchoring.getHighlights();results1=[];for(l=0,len1=ref2.length;l<len1;l++){hl=ref2[l];results1.push(hl.setFocused(false))}return results1}).on("click",function(event){var annotations,bucket,pad;bucket=_this.tabs.index(event.currentTarget);event.stopPropagation();pad=defaultView.innerHeight*.2;if(_this.isUpper(bucket)){return _this._jumpMinMax(_this.buckets[bucket],"up")}else if(_this.isLower(bucket)){return _this._jumpMinMax(_this.buckets[bucket],"down")}else{annotations=_this.buckets[bucket].slice();return annotator.selectAnnotations(annotations,event.ctrlKey||event.metaKey)}})}}(this));return this._buildTabs(this.tabs,this.buckets)};BucketBar.prototype._buildTabs=function(){return this.tabs.each(function(_this){return function(d,el){var bucket,bucketLength,title;el=$(el);bucket=_this.buckets[d];bucketLength=bucket!=null?bucket.length:void 0;title=bucketLength!==1?"Show "+bucketLength+" annotations":bucketLength>0?"Show one annotation":void 0;el.attr("title",title);el.toggleClass("upper",_this.isUpper(d));el.toggleClass("lower",_this.isLower(d));el.css({top:(_this.index[d]+_this.index[d+1])/2,marginTop:_this.isUpper(d)||_this.isLower(d)?-9:-8,display:!bucketLength?"none":""});if(bucket){return el.html("<div class='label'>"+bucketLength+"</div>")}}}(this))};BucketBar.prototype.isUpper=function(i){return i===1};BucketBar.prototype.isLower=function(i){return i===this.index.length-2};return BucketBar}(Annotator.Plugin);exports.BucketBar=Annotator.Plugin.BucketBar},{annotator:22,raf:34}],7:[function(require,module,exports){var $,Annotator,CrossFrame,extract,slice=[].slice,extend=function(child,parent){for(var key in parent){if(hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child},hasProp={}.hasOwnProperty;Annotator=require("annotator");$=Annotator.$;extract=extract=function(){var i,key,keys,len,obj,ret;obj=arguments[0],keys=2<=arguments.length?slice.call(arguments,1):[];ret={};for(i=0,len=keys.length;i<len;i++){key=keys[i];if(obj.hasOwnProperty(key)){ret[key]=obj[key]}}return ret};module.exports=CrossFrame=function(superClass){extend(CrossFrame,superClass);function CrossFrame(elem,options){var annotationSync,bridge,discovery,opts;CrossFrame.__super__.constructor.apply(this,arguments);opts=extract(options,"server");discovery=new CrossFrame.Discovery(window,opts);bridge=new CrossFrame.Bridge;opts=extract(options,"on","emit","formatter","parser");annotationSync=new CrossFrame.AnnotationSync(bridge,opts);this.pluginInit=function(){var onDiscoveryCallback;onDiscoveryCallback=function(source,origin,token){return bridge.createChannel(source,origin,token)};return discovery.startDiscovery(onDiscoveryCallback)};this.destroy=function(){Annotator.Plugin.prototype.destroy.apply(this,arguments);return discovery.stopDiscovery()};this.sync=function(annotations,cb){return annotationSync.sync(annotations,cb)};this.on=function(event,fn){return bridge.on(event,fn)};this.notify=function(message){return bridge.notify(message)};this.onConnect=function(fn){return bridge.onConnect(fn)}}return CrossFrame}(Annotator.Plugin)},{annotator:22}],8:[function(require,module,exports){var extend=function(child,parent){for(var key in parent){if(hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child},hasProp={}.hasOwnProperty;Annotator.Plugin.DomTextMapper=function(superClass){extend(DomTextMapper,superClass);function DomTextMapper(){return DomTextMapper.__super__.constructor.apply(this,arguments)}DomTextMapper.prototype.pluginInit=function(){if(this.options.skip){console.log("Not registering DOM-Text-Mapper.");return}this.anchoring=this.annotator.anchoring;return this.anchoring.documentAccessStrategies.unshift({name:"DOM-Text-Mapper",mapper:window.DomTextMapper,init:function(_this){return function(){return _this.anchoring.document.setRootNode(_this.annotator.wrapper[0])}}(this)})};return DomTextMapper}(Annotator.Plugin)},{}],9:[function(require,module,exports){var $,Anchor,Annotator,DummyDocumentAccess,bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){for(var key in parent){if(hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child},hasProp={}.hasOwnProperty;Annotator=require("annotator");$=Annotator.$;DummyDocumentAccess=function(){function DummyDocumentAccess(){}DummyDocumentAccess.applicable=function(){return true};DummyDocumentAccess.prototype.getPageIndex=function(){return 0};DummyDocumentAccess.prototype.getPageCount=function(){return 1};DummyDocumentAccess.prototype.getPageIndexForPos=function(){return 0};DummyDocumentAccess.prototype.isPageMapped=function(){return true};DummyDocumentAccess.prototype.scan=function(){};return DummyDocumentAccess}();Anchor=function(){function Anchor(anchoring,annotation1,target1,startPage,endPage,quote,diffHTML,diffCaseOnly){this.anchoring=anchoring;this.annotation=annotation1;this.target=target1;this.startPage=startPage;this.endPage=endPage;this.quote=quote;this.diffHTML=diffHTML;this.diffCaseOnly=diffCaseOnly;this.virtualize=bind(this.virtualize,this);this.realize=bind(this.realize,this);if(this.anchoring==null){throw"anchoring manager is required!"}if(this.annotation==null){throw"annotation is required!"}if(this.target==null){throw"target is required!"}if(this.startPage==null){"startPage is required!"}if(this.endPage==null){throw"endPage is required!"}if(this.quote==null){throw"quote is required!"}this.highlight={}}Anchor.prototype._getSegment=function(page){throw"Function not implemented"};Anchor.prototype.realize=function(){var created,hl,j,page,pagesTodo,ref,ref1,renderedPages,results1;if(this.fullyRealized){return}renderedPages=function(){results1=[];for(var j=ref=this.startPage,ref1=this.endPage;ref<=ref1?j<=ref1:j>=ref1;ref<=ref1?j++:j--){results1.push(j)}return results1}.apply(this).filter(function(_this){return function(index){return _this.anchoring.document.isPageMapped(index)}}(this));pagesTodo=renderedPages.filter(function(_this){return function(index){return _this.highlight[index]==null}}(this));if(!pagesTodo.length){return}created=function(){var k,len,results2;results2=[];for(k=0,len=pagesTodo.length;k<len;k++){page=pagesTodo[k];results2.push(this.highlight[page]=Annotator.TextHighlight.createFrom(this._getSegment(page),this,page))}return results2}.call(this);this.fullyRealized=renderedPages.length===this.endPage-this.startPage+1;this.anchoring.annotator.publish("highlightsCreated",created);if(this.pendingScrollTargetPage!=null&&(hl=this.highlight[this.pendingScrollTargetPage])){hl.scrollToView();return delete this.pendingScrollTargetPage}};Anchor.prototype.virtualize=function(pageIndex){var highlight;highlight=this.highlight[pageIndex];if(highlight==null){return}highlight.removeFromDocument();delete this.highlight[pageIndex];this.fullyRealized=false;return this.anchoring.annotator.publish("highlightRemoved",highlight)};Anchor.prototype.remove=function(){var anchors,i,index,j,ref,ref1,ref2,results1;results1=[];for(index=j=ref=this.startPage,ref1=this.endPage;ref<=ref1?j<=ref1:j>=ref1;index=ref<=ref1?++j:--j){this.virtualize(index);anchors=this.anchoring.anchors[index];i=anchors.indexOf(this);[].splice.apply(anchors,[i,i-i+1].concat(ref2=[])),ref2;if(!anchors.length){results1.push(delete this.anchoring.anchors[index])}else{results1.push(void 0)}}return results1};Anchor.prototype.scrollToView=function(){var currentPage,scrollPage,wantedPage;currentPage=this.anchoring.document.getPageIndex();if(this.startPage===this.endPage&&currentPage===this.startPage){return this.highlight[this.startPage].scrollToView()}else{if(currentPage<this.startPage){wantedPage=this.startPage;scrollPage=wantedPage-1}else if(currentPage>this.endPage){wantedPage=this.endPage;scrollPage=wantedPage+1}else{wantedPage=this.startPage;scrollPage=wantedPage}if(this.anchoring.document.isPageMapped(wantedPage)){return this.highlight[wantedPage].scrollToView()}else{this.pendingScrollTargetPage=wantedPage;this.anchoring.document.setPageIndex(scrollPage);return null}}};return Anchor}();Annotator.Anchor=Anchor;Annotator.Plugin.EnhancedAnchoring=function(superClass){extend(EnhancedAnchoring,superClass);function EnhancedAnchoring(){this.getSelectorsFromSelection=bind(this.getSelectorsFromSelection,this)}EnhancedAnchoring.prototype._setupDocumentAccessStrategies=function(){this.documentAccessStrategies=[{name:"Dummy",mapper:DummyDocumentAccess}];return this};EnhancedAnchoring.prototype.chooseAccessPolicy=function(){var j,len,ref,s;if(this.document!=null){return}ref=this.documentAccessStrategies;for(j=0,len=ref.length;j<len;j++){s=ref[j];if(s.mapper.applicable()){this.documentAccessStrategy=s;this.document=new s.mapper;this.anchors={};addEventListener("docPageMapped",function(_this){return function(evt){return _this._realizePage(evt.pageIndex)}}(this));addEventListener("docPageUnmapped",function(_this){return function(evt){return _this._virtualizePage(evt.pageIndex)}}(this));if(typeof s.init==="function"){s.init()}return this}}};EnhancedAnchoring.prototype._removeCurrentAccessPolicy=function(){var base,index,list;if(this.document==null){return}list=this.documentAccessStrategies;index=list.indexOf(this.documentAccessStrategy);if(index!==-1){list.splice(index,1)}if(typeof(base=this.document).destroy==="function"){base.destroy()}return delete this.document};EnhancedAnchoring.prototype._scan=function(){this.chooseAccessPolicy();try{return this.pendingScan=this.document.scan()}catch(_error){this._removeCurrentAccessPolicy();this._scan()}};EnhancedAnchoring.prototype.pluginInit=function(){var _loadAnnotations,self;this.selectorCreators=[];this.strategies=[];this._setupDocumentAccessStrategies();self=this;this.annotator.anchoring=this;_loadAnnotations=Annotator.prototype.loadAnnotations;return Annotator.prototype.loadAnnotations=function(annotations){if(annotations==null){annotations=[]}if(self.pendingScan!=null){return self.pendingScan.then(function(_this){return function(){return _loadAnnotations.call(_this,annotations)}}(this))}else{return _loadAnnotations.call(this,annotations)}}};EnhancedAnchoring.prototype.createAnchor=function(annotation,target){var a,anchor,base,error,j,k,len,pageIndex,ref,ref1,ref2,ref3,s;if(target==null){throw new Error("Trying to find anchor for null target!")}error=null;anchor=null;ref=this.strategies;for(j=0,len=ref.length;j<len;j++){s=ref[j];try{a=s.code.call(this,annotation,target);if(a){annotation.anchors.push(a);for(pageIndex=k=ref1=a.startPage,ref2=a.endPage;ref1<=ref2?k<=ref2:k>=ref2;pageIndex=ref1<=ref2?++k:--k){if((base=this.anchors)[pageIndex]==null){base[pageIndex]=[]}this.anchors[pageIndex].push(a)}a.realize();return{result:a}}}catch(_error){error=_error;console.log("Strategy '"+s.name+"' has thrown an error.",(ref3=error.stack)!=null?ref3:error)}}return{error:"No strategies worked."}};EnhancedAnchoring.prototype.normalizeString=function(string){return string.replace(/\s{2,}/g," ")};EnhancedAnchoring.prototype.findSelector=function(selectors,type){var j,len,selector;for(j=0,len=selectors.length;j<len;j++){selector=selectors[j];if(selector.type===type){return selector}}return null};EnhancedAnchoring.prototype._realizePage=function(index){var anchor,j,len,ref,ref1,results1;if(!this.document.isPageMapped(index)){return}ref1=(ref=this.anchors[index])!=null?ref:[];results1=[];for(j=0,len=ref1.length;j<len;j++){anchor=ref1[j];results1.push(anchor.realize())}return results1};EnhancedAnchoring.prototype._virtualizePage=function(index){var anchor,j,len,ref,ref1,results1;ref1=(ref=this.anchors[index])!=null?ref:[];results1=[];for(j=0,len=ref1.length;j<len;j++){anchor=ref1[j];results1.push(anchor.virtualize(index))}return results1};EnhancedAnchoring.prototype.getHighlights=function(annotations){var anchor,highlight,j,len,page,ref,ref1,results;results=[];ref=this.getAnchors(annotations);for(j=0,len=ref.length;j<len;j++){anchor=ref[j];ref1=anchor.highlight;for(page in ref1){highlight=ref1[page];results.push(highlight)}}return results};EnhancedAnchoring.prototype.getAnchors=function(annotations){var anchors,annotation,j,len,page,ref,results;results=[];if(annotations!=null){for(j=0,len=annotations.length;j<len;j++){annotation=annotations[j];$.merge(results,annotation.anchors)}}else{ref=this.anchors;for(page in ref){anchors=ref[page];$.merge(results,anchors)}}return results};EnhancedAnchoring.prototype.getSelectorsFromSelection=function(selection){var c,description,j,k,len,len1,ref,selector,selectors;selectors=[];ref=this.selectorCreators;for(j=0,len=ref.length;j<len;j++){c=ref[j];description=c.describe(selection);for(k=0,len1=description.length;k<len1;k++){selector=description[k];selectors.push(selector)}}return selectors};return EnhancedAnchoring}(Annotator.Plugin);exports.Anchor=Anchor;exports.EnhancedAnchoring=Annotator.Plugin.EnhancedAnchoring},{annotator:22}],10:[function(require,module,exports){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){for(var key in parent){if(hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child},hasProp={}.hasOwnProperty;Annotator.Plugin.FragmentSelector=function(superClass){extend(FragmentSelector,superClass);function FragmentSelector(){this._getFragmentSelector=bind(this._getFragmentSelector,this);return FragmentSelector.__super__.constructor.apply(this,arguments)}FragmentSelector.prototype.pluginInit=function(){return this.annotator.anchoring.selectorCreators.push({name:"FragmentSelector",describe:this._getFragmentSelector})};FragmentSelector.prototype._getFragmentSelector=function(annotation,target){var fragment;fragment=new URL(this.annotator.getRawHref()).hash;return[{type:"FragmentSelector",value:fragment}]};return FragmentSelector}(Annotator.Plugin)},{}],11:[function(require,module,exports){var Annotator,bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){for(var key in parent){if(hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child},hasProp={}.hasOwnProperty;Annotator=require("annotator");Annotator.Plugin.FuzzyTextAnchors=function(superClass){extend(FuzzyTextAnchors,superClass);function FuzzyTextAnchors(){this.fuzzyMatching=bind(this.fuzzyMatching,this);this.twoPhaseFuzzyMatching=bind(this.twoPhaseFuzzyMatching,this);return FuzzyTextAnchors.__super__.constructor.apply(this,arguments)}FuzzyTextAnchors.prototype.pluginInit=function(){if(!this.annotator.plugins.TextPosition){console.warn("The FuzzyTextAnchors Annotator plugin requires the TextPosition plugin. Skipping.");return}this.anchoring=this.annotator.anchoring;this.textFinder=new DomTextMatcher(function(_this){return function(){return _this.anchoring.document.getCorpus()}}(this));this.anchoring.strategies.push({name:"two-phase fuzzy",code:this.twoPhaseFuzzyMatching});return this.anchoring.strategies.push({name:"one-phase fuzzy",code:this.fuzzyMatching})};FuzzyTextAnchors.prototype.twoPhaseFuzzyMatching=function(annotation,target){var document,expectedEnd,expectedStart,match,options,posSelector,prefix,quote,quoteSelector,result,suffix;document=this.anchoring.document;if(document.getInfoForNode==null){return}quoteSelector=this.anchoring.findSelector(target.selector,"TextQuoteSelector");prefix=quoteSelector!=null?quoteSelector.prefix:void 0;suffix=quoteSelector!=null?quoteSelector.suffix:void 0;quote=quoteSelector!=null?quoteSelector.exact:void 0;if(!(prefix!=null&&suffix!=null)){return null}posSelector=this.anchoring.findSelector(target.selector,"TextPositionSelector");expectedStart=posSelector!=null?posSelector.start:void 0;expectedEnd=posSelector!=null?posSelector.end:void 0;options={contextMatchDistance:document.getCorpus().length*2,contextMatchThreshold:.5,patternMatchThreshold:.5,flexContext:true};result=this.textFinder.searchFuzzyWithContext(prefix,suffix,quote,expectedStart,expectedEnd,false,options);if(!result.matches.length){return null}match=result.matches[0];return new Annotator.TextPositionAnchor(this.anchoring,annotation,target,match.start,match.end,document.getPageIndexForPos(match.start),document.getPageIndexForPos(match.end),match.found,!match.exact?match.comparison.diffHTML:void 0,!match.exact?match.exactExceptCase:void 0)};FuzzyTextAnchors.prototype.fuzzyMatching=function(annotation,target){var document,expectedStart,len,match,options,posSelector,quote,quoteSelector,result;document=this.anchoring.document;if(document.getInfoForNode==null){return}quoteSelector=this.anchoring.findSelector(target.selector,"TextQuoteSelector");quote=quoteSelector!=null?quoteSelector.exact:void 0;if(quote==null){return null}if(!(quote.length>=32)){return}posSelector=this.anchoring.findSelector(target.selector,"TextPositionSelector");expectedStart=posSelector!=null?posSelector.start:void 0;len=document.getCorpus().length;if(expectedStart==null){expectedStart=Math.floor(len/2)}options={matchDistance:len*2,withFuzzyComparison:true};result=this.textFinder.searchFuzzy(quote,expectedStart,false,options);if(!result.matches.length){return null}match=result.matches[0];return new Annotator.TextPositionAnchor(this.anchoring,annotation,target,match.start,match.end,document.getPageIndexForPos(match.start),document.getPageIndexForPos(match.end),match.found,!match.exact?match.comparison.diffHTML:void 0,!match.exact?match.exactExceptCase:void 0)};return FuzzyTextAnchors}(Annotator.Plugin)},{annotator:22}],12:[function(require,module,exports){var $,Annotator,Promise,compareVersions,detectedPDFjsVersion,bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){for(var key in parent){if(hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child},hasProp={}.hasOwnProperty;Promise=require("es6-promise").Promise;Annotator=require("annotator");$=Annotator.$;detectedPDFjsVersion=typeof PDFJS!=="undefined"&&PDFJS!==null?PDFJS.version.split(".").map(parseFloat):void 0;compareVersions=function(v1,v2){var i,j,ref;if(!(Array.isArray(v1)&&Array.isArray(v2))){throw new Error("Expecting arrays, in the form of [1, 0, 123]")}if(v1.length!==v2.length){throw new Error("Can't compare versions in different formats.")}for(i=j=0,ref=v1.length;0<=ref?j<ref:j>ref;i=0<=ref?++j:--j){if(v1[i]<v2[i]){return-1}else if(v1[i]>v2[i]){return 1}}return 0};window.PDFTextMapper=function(superClass){extend(PDFTextMapper,superClass);PDFTextMapper.isPDFDocument=function(){return typeof PDFView!=="undefined"&&PDFView!==null||typeof PDFViewerApplication!=="undefined"&&PDFViewerApplication!==null};PDFTextMapper.applicable=function(){return this.isPDFDocument()};PDFTextMapper.prototype.requiresSmartStringPadding=true;PDFTextMapper.prototype.getPageCount=function(){return this._viewer.pages.length};PDFTextMapper.prototype.getPageIndex=function(){return this._app.page-1};PDFTextMapper.prototype.setPageIndex=function(index){return this._app.page=index+1};PDFTextMapper.prototype._isPageRendered=function(index){var ref,ref1;return(ref=this._viewer.pages[index])!=null?(ref1=ref.textLayer)!=null?ref1.renderingDone:void 0:void 0};PDFTextMapper.prototype.getRootNodeForPage=function(index){return this._viewer.pages[index].textLayer.textLayerDiv};function PDFTextMapper(){this._finishScan=bind(this._finishScan,this);this._parseExtractedText=bind(this._parseExtractedText,this);if(typeof PDFViewerApplication!=="undefined"&&PDFViewerApplication!==null){this._app=PDFViewerApplication;this._viewer=this._app.pdfViewer}else{this._app=this._viewer=PDFView}this.setEvents();if(compareVersions(detectedPDFjsVersion,[1,0,822])>=0){this._viewer.container.className+=" has-transparent-text-layer"}}PDFTextMapper.prototype.setEvents=function(){var viewer;addEventListener("pagerender",function(_this){return function(evt){var index;if(_this.pageInfo==null){return}index=evt.detail.pageNumber-1;return _this._onPageRendered(index)}}(this));addEventListener("DOMNodeRemoved",function(_this){return function(evt){var index,node;node=evt.target;if(node.nodeType===Node.ELEMENT_NODE&&node.nodeName.toLowerCase()==="div"&&node.className==="textLayer"){index=parseInt(node.parentNode.id.substr(13)-1);return _this._unmapPage(_this.pageInfo[index])}}}(this));viewer=document.getElementById("viewer");viewer.addEventListener("domChange",function(_this){return function(event){var data,endPage,node,ref,startPage;node=(ref=event.srcElement)!=null?ref:event.target;data=event.data;if("viewer"===(typeof node.getAttribute==="function"?node.getAttribute("id"):void 0)){console.log("Detected cross-page change event.");if(data.start!=null&&data.end!=null){startPage=_this.getPageForNode(data.start);_this._updateMap(_this.pageInfo[startPage.index]);endPage=_this.getPageForNode(data.end);return _this._updateMap(_this.pageInfo[endPage.index])}}}}(this));return this._viewer.container.addEventListener("scroll",this._onScroll)};PDFTextMapper.prototype._extractionPattern=/[ ]+/g;PDFTextMapper.prototype._parseExtractedText=function(text){return text.replace(this._extractionPattern," ")};PDFTextMapper.prototype.waitForInit=function(){var tryIt;tryIt=function(_this){return function(resolve){if(_this._app.documentFingerprint&&_this._app.documentInfo){return resolve()}else{return setTimeout(function(){return tryIt(resolve)},100)}}}(this);return new Promise(function(_this){return function(resolve,reject){if(PDFTextMapper.applicable()){return tryIt(resolve)}else{return reject("Not a PDF.js document")}}}(this))};PDFTextMapper.prototype.scan=function(){return new Promise(function(_this){return function(resolve,reject){_this._pendingScanResolve=resolve;return _this.waitForInit().then(function(){_this.pageInfo=[];return _this._extractPageText(0)})}}(this))};PDFTextMapper.prototype._extractPageText=function(pageIndex){return this._app.pdfDocument.getPage(pageIndex+1).then(function(_this){return function(page){return page.getTextContent().then(function(data){var content,rawContent,text;rawContent=function(){var j,len,ref,results;ref=data.items;results=[];for(j=0,len=ref.length;j<len;j++){text=ref[j];results.push(text.str)}return results}().join(" ");content=_this._parseExtractedText(rawContent);_this.pageInfo[pageIndex]={index:pageIndex,content:content};if(pageIndex===_this.getPageCount()-1){return _this._finishScan()}else{return _this._extractPageText(pageIndex+1)}})}}(this))};PDFTextMapper.prototype._finishScan=function(){this._onHavePageContents();this._pendingScanResolve();return this._onAfterScan()};PDFTextMapper.prototype.getPageForNode=function(node){var div,index;div=node;while(div.nodeType!==Node.ELEMENT_NODE||div.getAttribute("class")==null||div.getAttribute("class")!=="textLayer"){div=div.parentNode}index=parseInt(div.parentNode.id.substr(13)-1);return this.pageInfo[index]};PDFTextMapper.prototype.getDocumentFingerprint=function(){return this._app.documentFingerprint};PDFTextMapper.prototype.getDocumentInfo=function(){return this._app.documentInfo};return PDFTextMapper}(PageTextMapperCore);Annotator.Plugin.PDF=function(superClass){extend(PDF,superClass);function PDF(){this.beforeAnnotationCreated=bind(this.beforeAnnotationCreated,this);this.getMetaData=bind(this.getMetaData,this);return PDF.__super__.constructor.apply(this,arguments)}PDF.prototype.pluginInit=function(){if(!this.annotator.plugins.DomTextMapper){console.warn("The PDF Annotator plugin requires the DomTextMapper plugin. Skipping.");return}this.anchoring=this.annotator.anchoring;return this.anchoring.documentAccessStrategies.unshift({name:"PDF.js",mapper:PDFTextMapper})};PDF.prototype._isPDF=function(){return PDFTextMapper.applicable()};PDF.prototype._getDocumentURI=function(){var match,matches,uri;uri=window.location.href;matches=uri.match("chrome-extension://[a-z]{32}/(content/web/viewer.html\\?file=)?(.*)");match=matches!=null?matches[matches.length-1]:void 0;if(match){return decodeURIComponent(match)}else{return uri}};PDF.prototype._getFingerPrintURI=function(){var fingerprint;fingerprint=this.anchoring.document.getDocumentFingerprint();return"urn:x-pdf:"+fingerprint};PDF.prototype.uri=function(){if(!this._isPDF()){return null}return this._getFingerPrintURI()};PDF.prototype._getTitle=function(){var ref,title;title=(ref=this.anchoring.document.getDocumentInfo().Title)!=null?ref.trim():void 0;if(title!=null&&title!==""){return title}else{return $("head title").text().trim()}};PDF.prototype._metadata=function(){var documentURI,metadata;metadata={link:[{href:this._getFingerPrintURI()}],title:this._getTitle()};documentURI=this._getDocumentURI();if(documentURI.toLowerCase().indexOf("file://")===0){metadata.filename=new URL(documentURI).pathname.split("/").pop()}else{metadata.link.push({href:documentURI})}return metadata};PDF.prototype.getMetaData=function(){return new Promise(function(_this){return function(resolve,reject){if(_this.anchoring.document.waitForInit!=null){return _this.anchoring.document.waitForInit().then(function(){var error;try{return resolve(_this._metadata())}catch(_error){error=_error;return reject("Internal error")}})}else{return reject("Not a PDF dom mapper.")}}}(this))};PDF.prototype.events={beforeAnnotationCreated:"beforeAnnotationCreated"};PDF.prototype.beforeAnnotationCreated=function(annotation){if(!this._isPDF()){return}return annotation.document=this._metadata()};return PDF}(Annotator.Plugin)},{annotator:22,"es6-promise":31}],13:[function(require,module,exports){var $,Annotator,TextHighlight,highlightRange,indexOf=[].indexOf||function(item){for(var i=0,l=this.length;i<l;i++){if(i in this&&this[i]===item)return i}return-1},extend=function(child,parent){for(var key in parent){if(hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child},hasProp={}.hasOwnProperty;Annotator=require("annotator");$=Annotator.$;require("jquery-scrollintoview");highlightRange=function(normedRange,cssClass){var event,hl,j,len,node,nodes,r,white;if(cssClass==null){cssClass="annotator-hl"}white=/^\s*$/;hl=$("<span class='"+cssClass+"'></span>");nodes=$(normedRange.textNodes()).filter(function(i){return!white.test(this.nodeValue)});r=nodes.wrap(hl).parent().show().toArray();for(j=0,len=nodes.length;j<len;j++){node=nodes[j];event=document.createEvent("UIEvents");event.initUIEvent("domChange",true,false,window,0);event.reason="created hilite";node.dispatchEvent(event)}return r};TextHighlight=function(){TextHighlight.highlightRange=highlightRange;TextHighlight.createFrom=function(segment,anchor,page){if(segment.type!=="magic range"){return null}return new TextHighlight(anchor,page,segment.data);
};TextHighlight._inited=[];TextHighlight.getAnnotations=function(event){return $(event.target).parents(".annotator-hl").andSelf().map(function(){return $(this).data("annotation")}).toArray()};TextHighlight._init=function(annotator){if(indexOf.call(this._inited,annotator)>=0){return}annotator.element.delegate(".annotator-hl","mouseover",this,function(event){return annotator.onAnchorMouseover(event)});annotator.element.delegate(".annotator-hl","mouseout",this,function(event){return annotator.onAnchorMouseout(event)});annotator.element.delegate(".annotator-hl","mousedown",this,function(event){return annotator.onAnchorMousedown(event)});annotator.element.delegate(".annotator-hl","click",this,function(event){return annotator.onAnchorClick(event)});return this._inited.push(annotator)};function TextHighlight(anchor1,pageIndex,normedRange){this.anchor=anchor1;this.pageIndex=pageIndex;this.annotation=this.anchor.annotation;this.anchoring=this.anchor.anchoring;this.annotator=this.anchoring.annotator;TextHighlight._init(this.annotator);this._highlights=TextHighlight.highlightRange(normedRange);$(this._highlights).data("annotation",this.annotation)}TextHighlight.prototype.setFocused=function(value){if(value){return $(this._highlights).addClass("annotator-hl-focused")}else{return $(this._highlights).removeClass("annotator-hl-focused")}};TextHighlight.prototype.removeFromDocument=function(){var child,event,hl,j,len,ref,results;ref=this._highlights;results=[];for(j=0,len=ref.length;j<len;j++){hl=ref[j];if(hl.parentNode!=null&&this.anchoring.document.isPageMapped(this.pageIndex)){child=hl.childNodes[0];$(hl).replaceWith(hl.childNodes);event=document.createEvent("UIEvents");event.initUIEvent("domChange",true,false,window,0);event.reason="removed hilite (annotation deleted)";results.push(child.parentNode.dispatchEvent(event))}else{results.push(void 0)}}return results};TextHighlight.prototype.getTop=function(){return $(this._highlights).offset().top};TextHighlight.prototype.getHeight=function(){return $(this._highlights).outerHeight(true)};TextHighlight.prototype.getBoundingClientRect=function(){var rects;rects=$(this._highlights).map(function(){return this.getBoundingClientRect()}).get();return rects.reduce(function(acc,r){return{top:Math.min(acc.top,r.top),left:Math.min(acc.left,r.left),bottom:Math.max(acc.bottom,r.bottom),right:Math.max(acc.right,r.right)}})};TextHighlight.prototype.scrollToView=function(){$(this._highlights).scrollintoview();return null};return TextHighlight}();Annotator.Plugin.TextHighlights=function(superClass){extend(TextHighlights,superClass);function TextHighlights(){return TextHighlights.__super__.constructor.apply(this,arguments)}TextHighlights.prototype.pluginInit=function(){return Annotator.TextHighlight=TextHighlight};return TextHighlights}(Annotator.Plugin);exports.TextHighlight=TextHighlight},{annotator:22,"jquery-scrollintoview":27}],14:[function(require,module,exports){var Annotator,TextPositionAnchor,extend=function(child,parent){for(var key in parent){if(hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child},hasProp={}.hasOwnProperty,bind=function(fn,me){return function(){return fn.apply(me,arguments)}};Annotator=require("annotator");TextPositionAnchor=function(superClass){extend(TextPositionAnchor,superClass);function TextPositionAnchor(anchoring,annotation,target,start,end,startPage,endPage,quote,diffHTML,diffCaseOnly){this.start=start;this.end=end;TextPositionAnchor.__super__.constructor.call(this,anchoring,annotation,target,startPage,endPage,quote,diffHTML,diffCaseOnly);if(this.start==null){throw new Error("start is required!")}if(this.end==null){throw new Error("end is required!")}}TextPositionAnchor.prototype._getSegment=function(page){var browserRange,mappings,normedRange,realRange;mappings=this.anchoring.document.getMappingsForCharRange(this.start,this.end,[page]);realRange=mappings.sections[page].realRange;browserRange=new Annotator.Range.BrowserRange(realRange);normedRange=browserRange.normalize(this.anchoring.annotator.wrapper[0]);return{type:"magic range",data:normedRange}};return TextPositionAnchor}(Annotator.Anchor);Annotator.Plugin.TextPosition=function(superClass){extend(TextPosition,superClass);function TextPosition(){this.createFromPositionSelector=bind(this.createFromPositionSelector,this);this._getTextPositionSelector=bind(this._getTextPositionSelector,this);return TextPosition.__super__.constructor.apply(this,arguments)}TextPosition.prototype.pluginInit=function(){this.anchoring=this.annotator.anchoring;this.anchoring.selectorCreators.push({name:"TextPositionSelector",describe:this._getTextPositionSelector});this.anchoring.strategies.push({name:"position",code:this.createFromPositionSelector});return Annotator.TextPositionAnchor=TextPositionAnchor};TextPosition.prototype._getTextPositionSelector=function(selection){var document,endOffset,startOffset;if(selection.type!=="text range"){return[]}document=this.anchoring.document;if(document.getStartPosForNode==null){return[]}startOffset=document.getStartPosForNode(selection.range.start);endOffset=document.getEndPosForNode(selection.range.end);if(startOffset!=null&&endOffset!=null){return[{type:"TextPositionSelector",start:startOffset,end:endOffset}]}else{if(startOffset==null){console.log("Warning: can't generate TextPosition selector, because",selection.range.start,"does not have a valid start position.")}if(endOffset==null){console.log("Warning: can't generate TextPosition selector, because",selection.range.end,"does not have a valid end position.")}return[]}};TextPosition.prototype.createFromPositionSelector=function(annotation,target){var base,content,corpus,currentQuote,document,savedQuote,selector;selector=this.anchoring.findSelector(target.selector,"TextPositionSelector");if(selector==null){return}if(selector.start==null){console.log("Warning: 'start' field is missing from TextPositionSelector. Skipping.");return null}if(selector.end==null){console.log("Warning: 'end' field is missing from TextPositionSelector. Skipping.");return null}document=this.anchoring.document;corpus=typeof document.getCorpus==="function"?document.getCorpus():void 0;if(!corpus){return null}content=corpus.slice(selector.start,selector.end).trim();currentQuote=this.anchoring.normalizeString(content);savedQuote=typeof(base=this.anchoring).getQuoteForTarget==="function"?base.getQuoteForTarget(target):void 0;if(savedQuote!=null&&currentQuote!==savedQuote){return null}return new TextPositionAnchor(this.anchoring,annotation,target,selector.start,selector.end,document.getPageIndexForPos(selector.start),document.getPageIndexForPos(selector.end),currentQuote)};return TextPosition}(Annotator.Plugin)},{annotator:22}],15:[function(require,module,exports){var Annotator,bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){for(var key in parent){if(hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child},hasProp={}.hasOwnProperty;Annotator=require("annotator");Annotator.Plugin.TextQuote=function(superClass){extend(TextQuote,superClass);function TextQuote(){this._getTextQuoteSelector=bind(this._getTextQuoteSelector,this);return TextQuote.__super__.constructor.apply(this,arguments)}TextQuote.prototype.pluginInit=function(){this.anchoring=this.annotator.anchoring;this.anchoring.selectorCreators.push({name:"TextQuoteSelector",describe:this._getTextQuoteSelector});return this.anchoring.getQuoteForTarget=function(_this){return function(target){var selector;selector=_this.anchoring.findSelector(target.selector,"TextQuoteSelector");if(selector!=null){return _this.anchoring.normalizeString(selector.exact)}else{return null}}}(this)};TextQuote.prototype._getTextQuoteSelector=function(selection){var document,endOffset,prefix,quote,rangeEnd,rangeStart,ref,startOffset,suffix;if(selection.type!=="text range"){return[]}document=this.anchoring.document;if(selection.range==null){throw new Error("Called getTextQuoteSelector() with null range!")}rangeStart=selection.range.start;if(rangeStart==null){throw new Error("Called getTextQuoteSelector() on a range with no valid start.")}rangeEnd=selection.range.end;if(rangeEnd==null){throw new Error("Called getTextQuoteSelector() on a range with no valid end.")}if(document.getStartPosForNode!=null){startOffset=document.getStartPosForNode(rangeStart);endOffset=document.getEndPosForNode(rangeEnd);if(startOffset!=null&&endOffset!=null){quote=document.getCorpus().slice(startOffset,+(endOffset-1)+1||9e9).trim();ref=document.getContextForCharRange(startOffset,endOffset),prefix=ref[0],suffix=ref[1];return[{type:"TextQuoteSelector",exact:quote,prefix:prefix,suffix:suffix}]}else{console.log("Warning: can't generate TextQuote selector.",startOffset,endOffset);return[]}}else{return[{type:"TextQuoteSelector",exact:selection.range.text().trim()}]}};return TextQuote}(Annotator.Plugin)},{annotator:22}],16:[function(require,module,exports){var Annotator,TextRangeAnchor,extend=function(child,parent){for(var key in parent){if(hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child},hasProp={}.hasOwnProperty,bind=function(fn,me){return function(){return fn.apply(me,arguments)}};Annotator=require("annotator");TextRangeAnchor=function(superClass){extend(TextRangeAnchor,superClass);function TextRangeAnchor(annotator,annotation,target,range1,quote){this.range=range1;TextRangeAnchor.__super__.constructor.call(this,annotator,annotation,target,0,0,quote);if(this.range==null){throw new Error("range is required!")}}TextRangeAnchor.prototype._getSegment=function(){return{type:"magic range",data:this.range}};return TextRangeAnchor}(Annotator.Anchor);Annotator.Plugin.TextRange=function(superClass){extend(TextRange,superClass);function TextRange(){this.createFromRangeSelector=bind(this.createFromRangeSelector,this);this._getRangeSelector=bind(this._getRangeSelector,this);return TextRange.__super__.constructor.apply(this,arguments)}TextRange.prototype.pluginInit=function(){this.anchoring=this.annotator.anchoring;this.anchoring.selectorCreators.push({name:"RangeSelector",describe:this._getRangeSelector});this.anchoring.strategies.push({name:"range",code:this.createFromRangeSelector});return this.annotator.TextRangeAnchor=TextRangeAnchor};TextRange.prototype._getRangeSelector=function(selection){var sr;if(selection.type!=="text range"){return[]}sr=selection.range.serialize(this.annotator.wrapper[0],".annotator-hl");return[{type:"RangeSelector",startContainer:sr.start,startOffset:sr.startOffset,endContainer:sr.end,endOffset:sr.endOffset}]};TextRange.prototype.createFromRangeSelector=function(annotation,target){var base,currentQuote,document,endInfo,endOffset,error,normedRange,range,rawQuote,ref,ref1,savedQuote,selector,serializedRange,startInfo,startOffset;document=this.anchoring.document;selector=this.anchoring.findSelector(target.selector,"RangeSelector");if(selector==null){return null}serializedRange={start:selector.startContainer,startOffset:selector.startOffset,end:selector.endContainer,endOffset:selector.endOffset};try{range=Annotator.Range.sniff(serializedRange);normedRange=range.normalize(this.annotator.wrapper[0])}catch(_error){error=_error;return null}if(document.getInfoForNode!=null){startInfo=document.getInfoForNode(normedRange.start);if(!startInfo){return null}startOffset=startInfo.start;endInfo=document.getInfoForNode(normedRange.end);if(!endInfo){return null}endOffset=endInfo.end;rawQuote=document.getCorpus().slice(startOffset,+(endOffset-1)+1||9e9).trim()}else{rawQuote=normedRange.text().trim()}currentQuote=this.anchoring.normalizeString(rawQuote);savedQuote=typeof(base=this.anchoring).getQuoteForTarget==="function"?base.getQuoteForTarget(target):void 0;if(savedQuote!=null&&currentQuote!==savedQuote){return null}if((startInfo!=null?startInfo.start:void 0)!=null&&(endInfo!=null?endInfo.end:void 0)!=null){return new Annotator.TextPositionAnchor(this.anchoring,annotation,target,startInfo.start,endInfo.end,(ref=startInfo.pageIndex)!=null?ref:0,(ref1=endInfo.pageIndex)!=null?ref1:0,currentQuote)}else{return new TextRangeAnchor(this.anchoring,annotation,target,normedRange,currentQuote)}};return TextRange}(Annotator.Plugin)},{annotator:22}],17:[function(require,module,exports){var $,Annotator,bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){for(var key in parent){if(hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child},hasProp={}.hasOwnProperty;Annotator=require("annotator");$=Annotator.$;Annotator.Plugin.TextSelection=function(superClass){extend(TextSelection,superClass);function TextSelection(){this.checkForEndSelection=bind(this.checkForEndSelection,this);return TextSelection.__super__.constructor.apply(this,arguments)}TextSelection.prototype.pluginInit=function(){$(document).bind({touchend:this.checkForEndSelection,mouseup:this.checkForEndSelection});return null};TextSelection.prototype.destroy=function(){$(document).unbind({touchend:this.checkForEndSelection,mouseup:this.checkForEndSelection});return TextSelection.__super__.destroy.apply(this,arguments)};TextSelection.prototype._getSelectedRanges=function(){var browserRange,i,j,len,normedRange,r,ranges,rangesToIgnore,selection;selection=Annotator.Util.getGlobal().getSelection();ranges=[];rangesToIgnore=[];if(!selection.isCollapsed){ranges=function(){var j,ref,results;results=[];for(i=j=0,ref=selection.rangeCount;0<=ref?j<ref:j>ref;i=0<=ref?++j:--j){r=selection.getRangeAt(i);browserRange=new Annotator.Range.BrowserRange(r);normedRange=browserRange.normalize().limit(this.annotator.wrapper[0]);if(normedRange===null){rangesToIgnore.push(r)}results.push(normedRange)}return results}.call(this);selection.removeAllRanges()}for(j=0,len=rangesToIgnore.length;j<len;j++){r=rangesToIgnore[j];selection.addRange(r)}return $.grep(ranges,function(range){if(range){selection.addRange(range.toRange())}return range})};TextSelection.prototype.checkForEndSelection=function(event){var container,j,k,len,len1,r,range,selectedRanges;if(event==null){event={}}selectedRanges=this._getSelectedRanges();for(j=0,len=selectedRanges.length;j<len;j++){range=selectedRanges[j];container=range.commonAncestor;if(this.annotator.isAnnotator(container)){return}}if(selectedRanges.length){event.segments=[];for(k=0,len1=selectedRanges.length;k<len1;k++){r=selectedRanges[k];event.segments.push({type:"text range",range:r})}return this.annotator.onSuccessfulSelection(event)}else{return this.annotator.onFailedSelection(event)}};return TextSelection}(Annotator.Plugin)},{annotator:22}],18:[function(require,module,exports){var $,makeButton,extend=function(child,parent){for(var key in parent){if(hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child},hasProp={}.hasOwnProperty;$=Annotator.$;makeButton=function(item){var anchor,button;anchor=$("<button></button>").attr("href","").attr("title",item.title).attr("name",item.name).on(item.on).addClass(item["class"]);button=$("<li></li>").append(anchor);return button[0]};Annotator.Plugin.Toolbar=function(superClass){var HIDE_CLASS;extend(Toolbar,superClass);function Toolbar(){return Toolbar.__super__.constructor.apply(this,arguments)}HIDE_CLASS="annotator-hide";Toolbar.prototype.events={setVisibleHighlights:"onSetVisibleHighlights"};Toolbar.prototype.html='<div class="annotator-toolbar"></div>';Toolbar.prototype.pluginInit=function(){var item,items,list;this.annotator.toolbar=this.toolbar=$(this.html);if(this.options.container!=null){$(this.options.container).append(this.toolbar)}else{$(this.element).append(this.toolbar)}items=[{title:"Toggle Sidebar","class":"h-icon-chevron-left",name:"sidebar-toggle",on:{click:function(_this){return function(event){var collapsed;event.preventDefault();event.stopPropagation();collapsed=_this.annotator.frame.hasClass("annotator-collapsed");if(collapsed){return _this.annotator.triggerShowFrame()}else{return _this.annotator.triggerHideFrame()}}}(this)}},{title:"Hide Highlights","class":"h-icon-visibility",name:"highlight-visibility",on:{click:function(_this){return function(event){var state;event.preventDefault();event.stopPropagation();state=!_this.annotator.visibleHighlights;return _this.annotator.setVisibleHighlights(state)}}(this)}},{title:"New Note","class":"h-icon-insert-comment",name:"insert-comment",on:{click:function(_this){return function(event){event.preventDefault();event.stopPropagation();return _this.annotator.onAdderClick({target:{dataset:{action:"comment"}}})}}(this)}}];this.buttons=$(function(){var i,len,results;results=[];for(i=0,len=items.length;i<len;i++){item=items[i];results.push(makeButton(item))}return results}());list=$("<ul></ul>");this.buttons.appendTo(list);this.toolbar.append(list);return this.toolbar.on("mouseup","a",function(event){return $(event.target).blur()})};Toolbar.prototype.onSetVisibleHighlights=function(state){if(state){return $("[name=highlight-visibility]").removeClass("h-icon-visibility-off").addClass("h-icon-visibility").prop("title","Hide Highlights")}else{return $("[name=highlight-visibility]").removeClass("h-icon-visibility").addClass("h-icon-visibility-off").prop("title","Show Highlights")}};return Toolbar}(Annotator.Plugin)},{}],19:[function(require,module,exports){var $,Bridge,Channel,hasProp={}.hasOwnProperty,slice=[].slice;$=require("jquery");Channel=require("jschannel");module.exports=Bridge=function(){Bridge.prototype.links=null;Bridge.prototype.channelListeners=null;Bridge.prototype.onConnectListeners=null;function Bridge(){this.links=[];this.channelListeners={};this.onConnectListeners=[]}Bridge.prototype.createChannel=function(source,origin,scope){var callback,channel,channelOptions,method,ref;channelOptions={window:source,origin:origin,scope:scope,onReady:function(_this){return function(channel){var callback,i,len,ref,results1;ref=_this.onConnectListeners;results1=[];for(i=0,len=ref.length;i<len;i++){callback=ref[i];results1.push(callback.call(_this,channel,source))}return results1}}(this)};channel=this._buildChannel(channelOptions);ref=this.channelListeners;for(method in ref){if(!hasProp.call(ref,method))continue;callback=ref[method];channel.bind(method,callback)}this.links.push({channel:channel,window:source});return channel};Bridge.prototype.call=function(options){var _makeDestroyFn,deferreds;_makeDestroyFn=function(_this){return function(c){return function(error,reason){var l;c.destroy();return _this.links=function(){var i,len,ref,results1;ref=this.links;results1=[];for(i=0,len=ref.length;i<len;i++){l=ref[i];if(l.channel!==c){results1.push(l)}}return results1}.call(_this)}}}(this);deferreds=this.links.map(function(l){var callOptions,d;d=$.Deferred().fail(_makeDestroyFn(l.channel));callOptions={method:options.method,params:options.params,success:function(result){return d.resolve(result)},error:function(error,reason){if(error!=="timeout_error"){return d.reject(error,reason)}else{return d.resolve(null)}},timeout:1e3};l.channel.call(callOptions);return d.promise()});return $.when.apply($,deferreds).then(function(_this){return function(){var results;results=1<=arguments.length?slice.call(arguments,0):[];return typeof options.callback==="function"?options.callback(null,results):void 0}}(this)).fail(function(_this){return function(failure){return typeof options.callback==="function"?options.callback(failure):void 0}}(this))};Bridge.prototype.notify=function(options){var i,l,len,ref;ref=this.links;for(i=0,len=ref.length;i<len;i++){l=ref[i];l.channel.notify(options)}};Bridge.prototype.on=function(method,callback){var i,l,len,ref;if(this.channelListeners[method]){throw new Error("Listener '"+method+"' already bound in Bridge")}this.channelListeners[method]=callback;ref=this.links;for(i=0,len=ref.length;i<len;i++){l=ref[i];l.channel.bind(method,callback)}return this};Bridge.prototype.off=function(method){var i,l,len,ref;ref=this.links;for(i=0,len=ref.length;i<len;i++){l=ref[i];l.channel.unbind(method)}delete this.channelListeners[method];return this};Bridge.prototype.onConnect=function(callback){this.onConnectListeners.push(callback);return this};Bridge.prototype._buildChannel=function(options){var channel;if(options.origin.match(/^chrome-extension:\/\//)||options.origin.match(/^resource:\/\//)){options=$.extend({},options,{origin:"*"})}return channel=Channel.build(options)};return Bridge}()},{jquery:26,jschannel:28}],20:[function(require,module,exports){var Discovery,bind=function(fn,me){return function(){return fn.apply(me,arguments)}};module.exports=Discovery=function(){Discovery.prototype.server=false;Discovery.prototype.origin="*";Discovery.prototype.onDiscovery=null;Discovery.prototype.requestInProgress=false;function Discovery(target,options){this.target=target;if(options==null){options={}}this._onMessage=bind(this._onMessage,this);this.stopDiscovery=bind(this.stopDiscovery,this);if(options.server){this.server=options.server}if(options.origin){this.origin=options.origin}}Discovery.prototype.startDiscovery=function(onDiscovery){if(this.onDiscovery){throw new Error("Discovery is already in progress, call .stopDiscovery() first")}this.onDiscovery=onDiscovery;this.target.addEventListener("message",this._onMessage,false);this._beacon()};Discovery.prototype.stopDiscovery=function(){this.onDiscovery=null;this.target.removeEventListener("message",this._onMessage)};Discovery.prototype._beacon=function(){var beaconMessage,child,i,len,parent,queue,ref;beaconMessage=this.server?"__cross_frame_dhcp_offer":"__cross_frame_dhcp_discovery";queue=[this.target.top];while(queue.length){parent=queue.shift();if(parent!==this.target){parent.postMessage(beaconMessage,this.origin)}ref=parent.frames;for(i=0,len=ref.length;i<len;i++){child=ref[i];queue.push(child)}}};Discovery.prototype._onMessage=function(event){var data,discovered,match,messageType,origin,ref,reply,source,token;source=event.source,origin=event.origin,data=event.data;match=typeof data.match==="function"?data.match(/^__cross_frame_dhcp_(discovery|offer|request|ack)(?::(\d+))?$/):void 0;if(!match){return}messageType=match[1];token=match[2];ref=this._processMessage(messageType,token,origin),reply=ref.reply,discovered=ref.discovered,token=ref.token;if(reply){source.postMessage("__cross_frame_dhcp_"+reply,origin)}if(discovered){this.onDiscovery.call(null,source,origin,token)}};Discovery.prototype._processMessage=function(messageType,token,origin){var discovered,reply;reply=null;discovered=false;if(this.server){if(messageType==="discovery"){reply="offer"}else if(messageType==="request"){token=this._generateToken();reply="ack"+":"+token;discovered=true}else if(messageType==="offer"||messageType==="ack"){throw new Error("A second Discovery server has been detected at "+origin+".\nThis is unsupported and will cause unexpected behaviour.")}}else{if(messageType==="offer"){if(!this.requestInProgress){this.requestInProgress=true;reply="request"}}else if(messageType==="ack"){this.requestInProgress=false;discovered=true}}return{reply:reply,discovered:discovered,token:token}};Discovery.prototype._generateToken=function(){return(""+Math.random()).replace(/\D/g,"")};return Discovery}()},{}],21:[function(require,module,exports){(function(){var _ref,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child};Annotator.Plugin.Document=function(_super){var $;__extends(Document,_super);function Document(){this._getFavicon=__bind(this._getFavicon,this);this._getLinks=__bind(this._getLinks,this);this._getTitle=__bind(this._getTitle,this);this._getMetaTags=__bind(this._getMetaTags,this);this._getEprints=__bind(this._getEprints,this);this._getPrism=__bind(this._getPrism,this);this._getDublinCore=__bind(this._getDublinCore,this);this._getTwitter=__bind(this._getTwitter,this);this._getFacebook=__bind(this._getFacebook,this);this._getHighwire=__bind(this._getHighwire,this);this.getDocumentMetadata=__bind(this.getDocumentMetadata,this);this.beforeAnnotationCreated=__bind(this.beforeAnnotationCreated,this);this.uris=__bind(this.uris,this);this.uri=__bind(this.uri,this);_ref=Document.__super__.constructor.apply(this,arguments);return _ref}$=Annotator.$;Document.prototype.events={beforeAnnotationCreated:"beforeAnnotationCreated"};Document.prototype.pluginInit=function(){return this.getDocumentMetadata()};Document.prototype.uri=function(){var link,uri,_i,_len,_ref1;uri=decodeURIComponent(document.location.href);_ref1=this.metadata.link;for(_i=0,_len=_ref1.length;_i<_len;_i++){link=_ref1[_i];if(link.rel==="canonical"){uri=link.href}}return uri};Document.prototype.uris=function(){var href,link,uniqueUrls,_i,_len,_ref1;uniqueUrls={};_ref1=this.metadata.link;for(_i=0,_len=_ref1.length;_i<_len;_i++){link=_ref1[_i];if(link.href){uniqueUrls[link.href]=true}}return function(){var _results;_results=[];for(href in uniqueUrls){_results.push(href)}return _results}()};Document.prototype.beforeAnnotationCreated=function(annotation){return annotation.document=this.metadata};Document.prototype.getDocumentMetadata=function(){this.metadata={};this._getHighwire();this._getDublinCore();this._getFacebook();this._getEprints();this._getPrism();this._getTwitter();this._getFavicon();this._getTitle();this._getLinks();return this.metadata};Document.prototype._getHighwire=function(){return this.metadata.highwire=this._getMetaTags("citation","name","_")};Document.prototype._getFacebook=function(){return this.metadata.facebook=this._getMetaTags("og","property",":")};Document.prototype._getTwitter=function(){return this.metadata.twitter=this._getMetaTags("twitter","name",":")};Document.prototype._getDublinCore=function(){return this.metadata.dc=this._getMetaTags("dc","name",".")};Document.prototype._getPrism=function(){return this.metadata.prism=this._getMetaTags("prism","name",".")};Document.prototype._getEprints=function(){return this.metadata.eprints=this._getMetaTags("eprints","name",".")};Document.prototype._getMetaTags=function(prefix,attribute,delimiter){var content,match,meta,n,name,tags,_i,_len,_ref1;tags={};_ref1=$("meta");for(_i=0,_len=_ref1.length;_i<_len;_i++){meta=_ref1[_i];name=$(meta).attr(attribute);content=$(meta).prop("content");if(name){match=name.match(RegExp("^"+prefix+delimiter+"(.+)$","i"));if(match){n=match[1];if(tags[n]){tags[n].push(content)}else{tags[n]=[content]}}}}return tags};Document.prototype._getTitle=function(){if(this.metadata.highwire.title){return this.metadata.title=this.metadata.highwire.title[0]}else if(this.metadata.eprints.title){return this.metadata.title=this.metadata.eprints.title[0]}else if(this.metadata.prism.title){return this.metadata.title=this.metadata.prism.title[0]}else if(this.metadata.facebook.title){return this.metadata.title=this.metadata.facebook.title[0]}else if(this.metadata.twitter.title){return this.metadata.title=this.metadata.twitter.title[0]}else if(this.metadata.dc.title){return this.metadata.title=this.metadata.dc.title[0]}else{return this.metadata.title=$("head title").text()}};Document.prototype._getLinks=function(){var doi,href,id,l,lang,link,name,rel,type,url,values,_i,_j,_k,_len,_len1,_len2,_ref1,_ref2,_ref3,_results;this.metadata.link=[{href:document.location.href}];_ref1=$("link");for(_i=0,_len=_ref1.length;_i<_len;_i++){link=_ref1[_i];l=$(link);href=this._absoluteUrl(l.prop("href"));rel=l.prop("rel");type=l.prop("type");lang=l.prop("hreflang");if(rel!=="alternate"&&rel!=="canonical"&&rel!=="bookmark"&&rel!=="shortlink"){continue}if(rel==="alternate"){if(type&&type.match(/^application\/(rss|atom)\+xml/)){continue}if(lang){continue}}this.metadata.link.push({href:href,rel:rel,type:type})}_ref2=this.metadata.highwire;for(name in _ref2){values=_ref2[name];if(name==="pdf_url"){for(_j=0,_len1=values.length;_j<_len1;_j++){url=values[_j];this.metadata.link.push({href:this._absoluteUrl(url),type:"application/pdf"})}}if(name==="doi"){for(_k=0,_len2=values.length;_k<_len2;_k++){doi=values[_k];if(doi.slice(0,4)!=="doi:"){doi="doi:"+doi}this.metadata.link.push({href:doi})}}}_ref3=this.metadata.dc;_results=[];for(name in _ref3){values=_ref3[name];if(name==="identifier"){_results.push(function(){var _l,_len3,_results1;_results1=[];for(_l=0,_len3=values.length;_l<_len3;_l++){id=values[_l];if(id.slice(0,4)==="doi:"){_results1.push(this.metadata.link.push({href:id}))}else{_results1.push(void 0)}}return _results1}.call(this))}else{_results.push(void 0)}}return _results};Document.prototype._getFavicon=function(){var link,_i,_len,_ref1,_ref2,_results;_ref1=$("link");_results=[];for(_i=0,_len=_ref1.length;_i<_len;_i++){link=_ref1[_i];if((_ref2=$(link).prop("rel"))==="shortcut icon"||_ref2==="icon"){_results.push(this.metadata["favicon"]=this._absoluteUrl(link.href))}else{_results.push(void 0)}}return _results};Document.prototype._absoluteUrl=function(url){var d;d=document.createElement("a");d.href=url;return d.href};return Document}(Annotator.Plugin)}).call(this)},{}],22:[function(require,module,exports){(function(global){require("/Users/nileshgarg/apurva/h/h/static/scripts/vendor/jquery.js");var __browserify_shim_require__=require;(function browserifyShim(module,exports,require,define,browserify_shim__define__module__export__){(function(){var $,Annotator,Delegator,LinkParser,Range,Util,findChild,fn,functions,g,getNodeName,getNodePosition,gettext,simpleXPathJQuery,simpleXPathPure,_Annotator,_gettext,_i,_j,_len,_len1,_ref,_ref1,_t,__slice=[].slice,__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child},__bind=function(fn,me){return function(){return fn.apply(me,arguments)}};simpleXPathJQuery=function(relativeRoot){var jq;jq=this.map(function(){var elem,idx,path,tagName;path="";elem=this;while((elem!=null?elem.nodeType:void 0)===Node.ELEMENT_NODE&&elem!==relativeRoot){tagName=elem.tagName.replace(":","\\:");idx=$(elem.parentNode).children(tagName).index(elem)+1;idx="["+idx+"]";path="/"+elem.tagName.toLowerCase()+idx+path;elem=elem.parentNode}return path});return jq.get()};simpleXPathPure=function(relativeRoot){var getPathSegment,getPathTo,jq,rootNode;getPathSegment=function(node){var name,pos;name=getNodeName(node);pos=getNodePosition(node);return""+name+"["+pos+"]"};rootNode=relativeRoot;getPathTo=function(node){var xpath;xpath="";while(node!==rootNode){if(node==null){throw new Error("Called getPathTo on a node which was not a descendant of @rootNode. "+rootNode)}xpath=getPathSegment(node)+"/"+xpath;node=node.parentNode}xpath="/"+xpath;xpath=xpath.replace(/\/$/,"");return xpath};jq=this.map(function(){var path;path=getPathTo(this);return path});return jq.get()};findChild=function(node,type,index){var child,children,found,name,_i,_len;if(!node.hasChildNodes()){throw new Error("XPath error: node has no children!")}children=node.childNodes;found=0;for(_i=0,_len=children.length;_i<_len;_i++){child=children[_i];name=getNodeName(child);if(name===type){found+=1;if(found===index){return child}}}throw new Error("XPath error: wanted child not found.")};getNodeName=function(node){var nodeName;nodeName=node.nodeName.toLowerCase();
switch(nodeName){case"#text":return"text()";case"#comment":return"comment()";case"#cdata-section":return"cdata-section()";default:return nodeName}};getNodePosition=function(node){var pos,tmp;pos=0;tmp=node;while(tmp){if(tmp.nodeName===node.nodeName){pos++}tmp=tmp.previousSibling}return pos};gettext=null;if(typeof Gettext!=="undefined"&&Gettext!==null){_gettext=new Gettext({domain:"annotator"});gettext=function(msgid){return _gettext.gettext(msgid)}}else{gettext=function(msgid){return msgid}}_t=function(msgid){return gettext(msgid)};if(!(typeof jQuery!=="undefined"&&jQuery!==null?(_ref=jQuery.fn)!=null?_ref.jquery:void 0:void 0)){console.error(_t("Annotator requires jQuery: have you included lib/vendor/jquery.js?"))}if(!(JSON&&JSON.parse&&JSON.stringify)){console.error(_t("Annotator requires a JSON implementation: have you included lib/vendor/json2.js?"))}$=jQuery;Util={};Util.flatten=function(array){var flatten;flatten=function(ary){var el,flat,_i,_len;flat=[];for(_i=0,_len=ary.length;_i<_len;_i++){el=ary[_i];flat=flat.concat(el&&$.isArray(el)?flatten(el):el)}return flat};return flatten(array)};Util.contains=function(parent,child){var node;node=child;while(node!=null){if(node===parent){return true}node=node.parentNode}return false};Util.getTextNodes=function(jq){var getTextNodes;getTextNodes=function(node){var nodes;if(node&&node.nodeType!==Node.TEXT_NODE){nodes=[];if(node.nodeType!==Node.COMMENT_NODE){node=node.lastChild;while(node){nodes.push(getTextNodes(node));node=node.previousSibling}}return nodes.reverse()}else{return node}};return jq.map(function(){return Util.flatten(getTextNodes(this))})};Util.getLastTextNodeUpTo=function(n){var result;switch(n.nodeType){case Node.TEXT_NODE:return n;case Node.ELEMENT_NODE:if(n.lastChild!=null){result=Util.getLastTextNodeUpTo(n.lastChild);if(result!=null){return result}}break}n=n.previousSibling;if(n!=null){return Util.getLastTextNodeUpTo(n)}else{return null}};Util.getFirstTextNodeNotBefore=function(n){var result;switch(n.nodeType){case Node.TEXT_NODE:return n;case Node.ELEMENT_NODE:if(n.firstChild!=null){result=Util.getFirstTextNodeNotBefore(n.firstChild);if(result!=null){return result}}break}n=n.nextSibling;if(n!=null){return Util.getFirstTextNodeNotBefore(n)}else{return null}};Util.readRangeViaSelection=function(range){var sel;sel=Util.getGlobal().getSelection();sel.removeAllRanges();sel.addRange(range.toRange());return sel.toString()};Util.xpathFromNode=function(el,relativeRoot){var exception,result;try{result=simpleXPathJQuery.call(el,relativeRoot)}catch(_error){exception=_error;console.log("jQuery-based XPath construction failed! Falling back to manual.");result=simpleXPathPure.call(el,relativeRoot)}return result};Util.nodeFromXPath=function(xp,root){var idx,name,node,step,steps,_i,_len,_ref1;steps=xp.substring(1).split("/");node=root;for(_i=0,_len=steps.length;_i<_len;_i++){step=steps[_i];_ref1=step.split("["),name=_ref1[0],idx=_ref1[1];idx=idx!=null?parseInt((idx!=null?idx.split("]"):void 0)[0]):1;node=findChild(node,name.toLowerCase(),idx)}return node};Util.escape=function(html){return html.replace(/&(?!\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")};Util.uuid=function(){var counter;counter=0;return function(){return counter++}}();Util.getGlobal=function(){return function(){return this}()};Util.maxZIndex=function($elements){var all,el;all=function(){var _i,_len,_results;_results=[];for(_i=0,_len=$elements.length;_i<_len;_i++){el=$elements[_i];if($(el).css("position")==="static"){_results.push(-1)}else{_results.push(parseFloat($(el).css("z-index"))||-1)}}return _results}();return Math.max.apply(Math,all)};Util.mousePosition=function(e,offsetEl){var offset,_ref1;if((_ref1=$(offsetEl).css("position"))!=="absolute"&&_ref1!=="fixed"&&_ref1!=="relative"){offsetEl=$(offsetEl).offsetParent()[0]}offset=$(offsetEl).offset();return{top:e.pageY-offset.top,left:e.pageX-offset.left}};Util.preventEventDefault=function(event){return event!=null?typeof event.preventDefault==="function"?event.preventDefault():void 0:void 0};functions=["log","debug","info","warn","exception","assert","dir","dirxml","trace","group","groupEnd","groupCollapsed","time","timeEnd","profile","profileEnd","count","clear","table","error","notifyFirebug","firebug","userObjects"];if(typeof console!=="undefined"&&console!==null){if(console.group==null){console.group=function(name){return console.log("GROUP: ",name)}}if(console.groupCollapsed==null){console.groupCollapsed=console.group}for(_i=0,_len=functions.length;_i<_len;_i++){fn=functions[_i];if(console[fn]==null){console[fn]=function(){return console.log(_t("Not implemented:")+(" console."+name))}}}}else{this.console={};for(_j=0,_len1=functions.length;_j<_len1;_j++){fn=functions[_j];this.console[fn]=function(){}}this.console["error"]=function(){var args;args=1<=arguments.length?__slice.call(arguments,0):[];return alert("ERROR: "+args.join(", "))};this.console["warn"]=function(){var args;args=1<=arguments.length?__slice.call(arguments,0):[];return alert("WARNING: "+args.join(", "))}}Delegator=function(){Delegator.prototype.events={};Delegator.prototype.options={};Delegator.prototype.element=null;function Delegator(element,options){this.options=$.extend(true,{},this.options,options);this.element=$(element);this._closures={};this.on=this.subscribe;this.addEvents()}Delegator.prototype.destroy=function(){return this.removeEvents()};Delegator.prototype.addEvents=function(){var event,_k,_len2,_ref1,_results;_ref1=Delegator._parseEvents(this.events);_results=[];for(_k=0,_len2=_ref1.length;_k<_len2;_k++){event=_ref1[_k];_results.push(this._addEvent(event.selector,event.event,event.functionName))}return _results};Delegator.prototype.removeEvents=function(){var event,_k,_len2,_ref1,_results;_ref1=Delegator._parseEvents(this.events);_results=[];for(_k=0,_len2=_ref1.length;_k<_len2;_k++){event=_ref1[_k];_results.push(this._removeEvent(event.selector,event.event,event.functionName))}return _results};Delegator.prototype._addEvent=function(selector,event,functionName){var closure,_this=this;closure=function(){return _this[functionName].apply(_this,arguments)};if(selector===""&&Delegator._isCustomEvent(event)){this.subscribe(event,closure)}else{this.element.delegate(selector,event,closure)}this._closures[""+selector+"/"+event+"/"+functionName]=closure;return this};Delegator.prototype._removeEvent=function(selector,event,functionName){var closure;closure=this._closures[""+selector+"/"+event+"/"+functionName];if(selector===""&&Delegator._isCustomEvent(event)){this.unsubscribe(event,closure)}else{this.element.undelegate(selector,event,closure)}delete this._closures[""+selector+"/"+event+"/"+functionName];return this};Delegator.prototype.publish=function(){this.element.triggerHandler.apply(this.element,arguments);return this};Delegator.prototype.subscribe=function(event,callback){var closure;closure=function(){return callback.apply(this,[].slice.call(arguments,1))};closure.guid=callback.guid=$.guid+=1;this.element.bind(event,closure);return this};Delegator.prototype.unsubscribe=function(){this.element.unbind.apply(this.element,arguments);return this};return Delegator}();Delegator._parseEvents=function(eventsObj){var event,events,functionName,sel,selector,_k,_ref1;events=[];for(sel in eventsObj){functionName=eventsObj[sel];_ref1=sel.split(" "),selector=2<=_ref1.length?__slice.call(_ref1,0,_k=_ref1.length-1):(_k=0,[]),event=_ref1[_k++];events.push({selector:selector.join(" "),event:event,functionName:functionName})}return events};Delegator.natives=function(){var key,specials,val;specials=function(){var _ref1,_results;_ref1=jQuery.event.special;_results=[];for(key in _ref1){if(!__hasProp.call(_ref1,key))continue;val=_ref1[key];_results.push(key)}return _results}();return"blur focus focusin focusout load resize scroll unload click dblclick\nmousedown mouseup mousemove mouseover mouseout mouseenter mouseleave\nchange select submit keydown keypress keyup error".split(/[^a-z]+/).concat(specials)}();Delegator._isCustomEvent=function(event){event=event.split(".")[0];return $.inArray(event,Delegator.natives)===-1};Range={};Range.sniff=function(r){if(r.commonAncestorContainer!=null){return new Range.BrowserRange(r)}else if(typeof r.start==="string"){return new Range.SerializedRange(r)}else if(r.start&&typeof r.start==="object"){return new Range.NormalizedRange(r)}else{console.error(_t("Could not sniff range type"));return false}};Range.nodeFromXPath=function(xpath,root){var customResolver,evaluateXPath,namespace,node,segment;if(root==null){root=document}evaluateXPath=function(xp,nsResolver){var exception;if(nsResolver==null){nsResolver=null}try{return document.evaluate("."+xp,root,nsResolver,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue}catch(_error){exception=_error;console.log("XPath evaluation failed.");console.log("Trying fallback...");return Util.nodeFromXPath(xp,root)}};if(!$.isXMLDoc(document.documentElement)){return evaluateXPath(xpath)}else{customResolver=document.createNSResolver(document.ownerDocument===null?document.documentElement:document.ownerDocument.documentElement);node=evaluateXPath(xpath,customResolver);if(!node){xpath=function(){var _k,_len2,_ref1,_results;_ref1=xpath.split("/");_results=[];for(_k=0,_len2=_ref1.length;_k<_len2;_k++){segment=_ref1[_k];if(segment&&segment.indexOf(":")===-1){_results.push(segment.replace(/^([a-z]+)/,"xhtml:$1"))}else{_results.push(segment)}}return _results}().join("/");namespace=document.lookupNamespaceURI(null);customResolver=function(ns){if(ns==="xhtml"){return namespace}else{return document.documentElement.getAttribute("xmlns:"+ns)}};node=evaluateXPath(xpath,customResolver)}return node}};Range.RangeError=function(_super){__extends(RangeError,_super);function RangeError(type,message,parent){this.type=type;this.message=message;this.parent=parent!=null?parent:null;RangeError.__super__.constructor.call(this,this.message)}return RangeError}(Error);Range.BrowserRange=function(){function BrowserRange(obj){this.commonAncestorContainer=obj.commonAncestorContainer;this.startContainer=obj.startContainer;this.startOffset=obj.startOffset;this.endContainer=obj.endContainer;this.endOffset=obj.endOffset}BrowserRange.prototype.normalize=function(root){var n,node,nr,r;if(this.tainted){console.error(_t("You may only call normalize() once on a BrowserRange!"));return false}else{this.tainted=true}r={};if(this.startContainer.nodeType===Node.ELEMENT_NODE){r.start=Util.getFirstTextNodeNotBefore(this.startContainer.childNodes[this.startOffset]);r.startOffset=0}else{r.start=this.startContainer;r.startOffset=this.startOffset}if(this.endContainer.nodeType===Node.ELEMENT_NODE){node=this.endContainer.childNodes[this.endOffset];if(node!=null){n=node;while(n!=null&&n.nodeType!==Node.TEXT_NODE){n=n.firstChild}if(n!=null){r.end=n;r.endOffset=0}}if(r.end==null){node=this.endContainer.childNodes[this.endOffset-1];r.end=Util.getLastTextNodeUpTo(node);r.endOffset=r.end.nodeValue.length}}else{r.end=this.endContainer;r.endOffset=this.endOffset}nr={};if(r.startOffset>0){if(r.start.nodeValue.length>r.startOffset){nr.start=r.start.splitText(r.startOffset)}else{nr.start=r.start.nextSibling}}else{nr.start=r.start}if(r.start===r.end){if(nr.start.nodeValue.length>r.endOffset-r.startOffset){nr.start.splitText(r.endOffset-r.startOffset)}nr.end=nr.start}else{if(r.end.nodeValue.length>r.endOffset){r.end.splitText(r.endOffset)}nr.end=r.end}nr.commonAncestor=this.commonAncestorContainer;while(nr.commonAncestor.nodeType!==Node.ELEMENT_NODE){nr.commonAncestor=nr.commonAncestor.parentNode}return new Range.NormalizedRange(nr)};BrowserRange.prototype.serialize=function(root,ignoreSelector){return this.normalize(root).serialize(root,ignoreSelector)};return BrowserRange}();Range.NormalizedRange=function(){function NormalizedRange(obj){this.commonAncestor=obj.commonAncestor;this.start=obj.start;this.end=obj.end}NormalizedRange.prototype.normalize=function(root){return this};NormalizedRange.prototype.limit=function(bounds){var nodes,parent,startParents,_k,_len2,_ref1;nodes=$.grep(this.textNodes(),function(node){return node.parentNode===bounds||$.contains(bounds,node.parentNode)});if(!nodes.length){return null}this.start=nodes[0];this.end=nodes[nodes.length-1];startParents=$(this.start).parents();_ref1=$(this.end).parents();for(_k=0,_len2=_ref1.length;_k<_len2;_k++){parent=_ref1[_k];if(startParents.index(parent)!==-1){this.commonAncestor=parent;break}}return this};NormalizedRange.prototype.serialize=function(root,ignoreSelector){var end,serialization,start;serialization=function(node,isEnd){var n,nodes,offset,origParent,textNodes,xpath,_k,_len2;if(ignoreSelector){origParent=$(node).parents(":not("+ignoreSelector+")").eq(0)}else{origParent=$(node).parent()}xpath=Util.xpathFromNode(origParent,root)[0];textNodes=Util.getTextNodes(origParent);nodes=textNodes.slice(0,textNodes.index(node));offset=0;for(_k=0,_len2=nodes.length;_k<_len2;_k++){n=nodes[_k];offset+=n.nodeValue.length}if(isEnd){return[xpath,offset+node.nodeValue.length]}else{return[xpath,offset]}};start=serialization(this.start);end=serialization(this.end,true);return new Range.SerializedRange({start:start[0],end:end[0],startOffset:start[1],endOffset:end[1]})};NormalizedRange.prototype.text=function(){var node;return function(){var _k,_len2,_ref1,_results;_ref1=this.textNodes();_results=[];for(_k=0,_len2=_ref1.length;_k<_len2;_k++){node=_ref1[_k];_results.push(node.nodeValue)}return _results}.call(this).join("")};NormalizedRange.prototype.textNodes=function(){var end,start,textNodes,_ref1;textNodes=Util.getTextNodes($(this.commonAncestor));_ref1=[textNodes.index(this.start),textNodes.index(this.end)],start=_ref1[0],end=_ref1[1];return $.makeArray(textNodes.slice(start,+end+1||9e9))};NormalizedRange.prototype.toRange=function(){var range;range=document.createRange();range.setStartBefore(this.start);range.setEndAfter(this.end);return range};return NormalizedRange}();Range.SerializedRange=function(){function SerializedRange(obj){this.start=obj.start;this.startOffset=obj.startOffset;this.end=obj.end;this.endOffset=obj.endOffset}SerializedRange.prototype.normalize=function(root){var contains,e,length,node,p,range,targetOffset,tn,_k,_l,_len2,_len3,_ref1,_ref2;range={};_ref1=["start","end"];for(_k=0,_len2=_ref1.length;_k<_len2;_k++){p=_ref1[_k];try{node=Range.nodeFromXPath(this[p],root)}catch(_error){e=_error;throw new Range.RangeError(p,"Error while finding "+p+" node: "+this[p]+": "+e,e)}if(!node){throw new Range.RangeError(p,"Couldn't find "+p+" node: "+this[p])}length=0;targetOffset=this[p+"Offset"];if(p==="end"){targetOffset--}_ref2=Util.getTextNodes($(node));for(_l=0,_len3=_ref2.length;_l<_len3;_l++){tn=_ref2[_l];if(length+tn.nodeValue.length>targetOffset){range[p+"Container"]=tn;range[p+"Offset"]=this[p+"Offset"]-length;break}else{length+=tn.nodeValue.length}}if(range[p+"Offset"]==null){throw new Range.RangeError(""+p+"offset","Couldn't find offset "+this[p+"Offset"]+" in element "+this[p])}}contains=document.compareDocumentPosition==null?function(a,b){return a.contains(b)}:function(a,b){return a.compareDocumentPosition(b)&16};$(range.startContainer).parents().each(function(){if(contains(this,range.endContainer)){range.commonAncestorContainer=this;return false}});return new Range.BrowserRange(range).normalize(root)};SerializedRange.prototype.serialize=function(root,ignoreSelector){return this.normalize(root).serialize(root,ignoreSelector)};SerializedRange.prototype.toObject=function(){return{start:this.start,startOffset:this.startOffset,end:this.end,endOffset:this.endOffset}};return SerializedRange}();_Annotator=this.Annotator;Annotator=function(_super){__extends(Annotator,_super);Annotator.prototype.events={".annotator-adder button click":"onAdderClick",".annotator-adder button mousedown":"onAdderMousedown",".annotator-hl mouseover":"onHighlightMouseover",".annotator-hl mouseout":"startViewerHideTimer"};Annotator.prototype.html={adder:'<div class="annotator-adder"><button>'+_t("Annotate")+"</button></div>",wrapper:'<div class="annotator-wrapper"></div>'};Annotator.prototype.options={readOnly:false};Annotator.prototype.plugins={};Annotator.prototype.editor=null;Annotator.prototype.viewer=null;Annotator.prototype.selectedRanges=null;Annotator.prototype.mouseIsDown=false;Annotator.prototype.ignoreMouseup=false;Annotator.prototype.viewerHideTimer=null;function Annotator(element,options){this.onDeleteAnnotation=__bind(this.onDeleteAnnotation,this);this.onEditAnnotation=__bind(this.onEditAnnotation,this);this.onAdderClick=__bind(this.onAdderClick,this);this.onAdderMousedown=__bind(this.onAdderMousedown,this);this.onHighlightMouseover=__bind(this.onHighlightMouseover,this);this.checkForEndSelection=__bind(this.checkForEndSelection,this);this.checkForStartSelection=__bind(this.checkForStartSelection,this);this.clearViewerHideTimer=__bind(this.clearViewerHideTimer,this);this.startViewerHideTimer=__bind(this.startViewerHideTimer,this);this.showViewer=__bind(this.showViewer,this);this.onEditorSubmit=__bind(this.onEditorSubmit,this);this.onEditorHide=__bind(this.onEditorHide,this);this.showEditor=__bind(this.showEditor,this);Annotator.__super__.constructor.apply(this,arguments);this.plugins={};if(!Annotator.supported()){return this}if(!this.options.readOnly){this._setupDocumentEvents()}this._setupWrapper()._setupViewer()._setupEditor();this._setupDynamicStyle();this.adder=$(this.html.adder).appendTo(this.wrapper).hide();Annotator._instances.push(this)}Annotator.prototype._setupWrapper=function(){this.wrapper=$(this.html.wrapper);this.element.find("script").remove();this.element.wrapInner(this.wrapper);this.wrapper=this.element.find(".annotator-wrapper");return this};Annotator.prototype._setupViewer=function(){var _this=this;this.viewer=new Annotator.Viewer({readOnly:this.options.readOnly});this.viewer.hide().on("edit",this.onEditAnnotation).on("delete",this.onDeleteAnnotation).addField({load:function(field,annotation){if(annotation.text){$(field).html(Util.escape(annotation.text))}else{$(field).html("<i>"+_t("No Comment")+"</i>")}return _this.publish("annotationViewerTextField",[field,annotation])}}).element.appendTo(this.wrapper).bind({mouseover:this.clearViewerHideTimer,mouseout:this.startViewerHideTimer});return this};Annotator.prototype._setupEditor=function(){this.editor=new Annotator.Editor;this.editor.hide().on("hide",this.onEditorHide).on("save",this.onEditorSubmit).addField({type:"textarea",label:_t("Comments")+"",load:function(field,annotation){return $(field).find("textarea").val(annotation.text||"")},submit:function(field,annotation){return annotation.text=$(field).find("textarea").val()}});this.editor.element.appendTo(this.wrapper);return this};Annotator.prototype._setupDocumentEvents=function(){$(document).bind({mouseup:this.checkForEndSelection,mousedown:this.checkForStartSelection});return this};Annotator.prototype._setupDynamicStyle=function(){var max,sel,style,x;style=$("#annotator-dynamic-style");if(!style.length){style=$('<style id="annotator-dynamic-style"></style>').appendTo(document.head)}sel="*"+function(){var _k,_len2,_ref1,_results;_ref1=["adder","outer","notice","filter"];_results=[];for(_k=0,_len2=_ref1.length;_k<_len2;_k++){x=_ref1[_k];_results.push(":not(.annotator-"+x+")")}return _results}().join("");max=Util.maxZIndex($(document.body).find(sel));max=Math.max(max,1e3);style.text([".annotator-adder, .annotator-outer, .annotator-notice {","  z-index: "+(max+20)+";","}",".annotator-filter {","  z-index: "+(max+10)+";","}"].join("\n"));return this};Annotator.prototype.destroy=function(){var idx,name,plugin,_base,_ref1;Annotator.__super__.destroy.apply(this,arguments);$(document).unbind({mouseup:this.checkForEndSelection,mousedown:this.checkForStartSelection});$("#annotator-dynamic-style").remove();this.adder.remove();this.viewer.destroy();this.editor.destroy();this.wrapper.find(".annotator-hl").each(function(){$(this).contents().insertBefore(this);return $(this).remove()});this.wrapper.contents().insertBefore(this.wrapper);this.wrapper.remove();this.element.data("annotator",null);_ref1=this.plugins;for(name in _ref1){plugin=_ref1[name];if(typeof(_base=this.plugins[name]).destroy==="function"){_base.destroy()}}idx=Annotator._instances.indexOf(this);if(idx!==-1){return Annotator._instances.splice(idx,1)}};Annotator.prototype.getSelectedRanges=function(){var browserRange,i,normedRange,r,ranges,rangesToIgnore,selection,_k,_len2;selection=Util.getGlobal().getSelection();ranges=[];rangesToIgnore=[];if(!selection.isCollapsed){ranges=function(){var _k,_ref1,_results;_results=[];for(i=_k=0,_ref1=selection.rangeCount;0<=_ref1?_k<_ref1:_k>_ref1;i=0<=_ref1?++_k:--_k){r=selection.getRangeAt(i);browserRange=new Range.BrowserRange(r);normedRange=browserRange.normalize().limit(this.wrapper[0]);if(normedRange===null){rangesToIgnore.push(r)}_results.push(normedRange)}return _results}.call(this);selection.removeAllRanges()}for(_k=0,_len2=rangesToIgnore.length;_k<_len2;_k++){r=rangesToIgnore[_k];selection.addRange(r)}return $.grep(ranges,function(range){if(range){selection.addRange(range.toRange())}return range})};Annotator.prototype.createAnnotation=function(){var annotation;annotation={};this.publish("beforeAnnotationCreated",[annotation]);return annotation};Annotator.prototype.setupAnnotation=function(annotation){var e,normed,normedRanges,r,root,_k,_l,_len2,_len3,_ref1;root=this.wrapper[0];annotation.ranges||(annotation.ranges=this.selectedRanges);normedRanges=[];_ref1=annotation.ranges;for(_k=0,_len2=_ref1.length;_k<_len2;_k++){r=_ref1[_k];try{normedRanges.push(Range.sniff(r).normalize(root))}catch(_error){e=_error;if(e instanceof Range.RangeError){this.publish("rangeNormalizeFail",[annotation,r,e])}else{throw e}}}annotation.quote=[];annotation.ranges=[];annotation.highlights=[];for(_l=0,_len3=normedRanges.length;_l<_len3;_l++){normed=normedRanges[_l];annotation.quote.push($.trim(normed.text()));annotation.ranges.push(normed.serialize(this.wrapper[0],".annotator-hl"));$.merge(annotation.highlights,this.highlightRange(normed))}annotation.quote=annotation.quote.join(" / ");$(annotation.highlights).data("annotation",annotation);$(annotation.highlights).attr("data-annotation-id",annotation.id);return annotation};Annotator.prototype.updateAnnotation=function(annotation){this.publish("beforeAnnotationUpdated",[annotation]);$(annotation.highlights).attr("data-annotation-id",annotation.id);this.publish("annotationUpdated",[annotation]);return annotation};Annotator.prototype.deleteAnnotation=function(annotation){var child,h,_k,_len2,_ref1;if(annotation.highlights!=null){_ref1=annotation.highlights;for(_k=0,_len2=_ref1.length;_k<_len2;_k++){h=_ref1[_k];if(!(h.parentNode!=null)){continue}child=h.childNodes[0];$(h).replaceWith(h.childNodes)}}this.publish("annotationDeleted",[annotation]);return annotation};Annotator.prototype.loadAnnotations=function(annotations){var clone,loader,_this=this;if(annotations==null){annotations=[]}loader=function(annList){var n,now,_k,_len2;if(annList==null){annList=[]}now=annList.splice(0,10);for(_k=0,_len2=now.length;_k<_len2;_k++){n=now[_k];_this.setupAnnotation(n)}if(annList.length>0){return setTimeout(function(){return loader(annList)},10)}else{return _this.publish("annotationsLoaded",[clone])}};clone=annotations.slice();loader(annotations);return this};Annotator.prototype.dumpAnnotations=function(){if(this.plugins["Store"]){return this.plugins["Store"].dumpAnnotations()}else{console.warn(_t("Can't dump annotations without Store plugin."));return false}};Annotator.prototype.highlightRange=function(normedRange,cssClass){var hl,node,white,_k,_len2,_ref1,_results;if(cssClass==null){cssClass="annotator-hl"}white=/^\s*$/;hl=$("<span class='"+cssClass+"'></span>");_ref1=normedRange.textNodes();_results=[];for(_k=0,_len2=_ref1.length;_k<_len2;_k++){node=_ref1[_k];if(!white.test(node.nodeValue)){_results.push($(node).wrapAll(hl).parent().show()[0])}}return _results};Annotator.prototype.highlightRanges=function(normedRanges,cssClass){var highlights,r,_k,_len2;if(cssClass==null){cssClass="annotator-hl"}highlights=[];for(_k=0,_len2=normedRanges.length;_k<_len2;_k++){r=normedRanges[_k];$.merge(highlights,this.highlightRange(r,cssClass))}return highlights};Annotator.prototype.addPlugin=function(name,options){var klass,_base;if(this.plugins[name]){console.error(_t("You cannot have more than one instance of any plugin."))}else{klass=Annotator.Plugin[name];if(typeof klass==="function"){this.plugins[name]=new klass(this.element[0],options);this.plugins[name].annotator=this;if(typeof(_base=this.plugins[name]).pluginInit==="function"){_base.pluginInit()}}else{console.error(_t("Could not load ")+name+_t(" plugin. Have you included the appropriate <script> tag?"))}}return this};Annotator.prototype.showEditor=function(annotation,location){this.editor.element.css(location);this.editor.load(annotation);this.publish("annotationEditorShown",[this.editor,annotation]);return this};Annotator.prototype.onEditorHide=function(){this.publish("annotationEditorHidden",[this.editor]);return this.ignoreMouseup=false};Annotator.prototype.onEditorSubmit=function(annotation){return this.publish("annotationEditorSubmit",[this.editor,annotation])};Annotator.prototype.showViewer=function(annotations,location){this.viewer.element.css(location);this.viewer.load(annotations);return this.publish("annotationViewerShown",[this.viewer,annotations])};Annotator.prototype.startViewerHideTimer=function(){if(!this.viewerHideTimer){return this.viewerHideTimer=setTimeout(this.viewer.hide,250)}};Annotator.prototype.clearViewerHideTimer=function(){clearTimeout(this.viewerHideTimer);return this.viewerHideTimer=false};Annotator.prototype.checkForStartSelection=function(event){if(!(event&&this.isAnnotator(event.target))){this.startViewerHideTimer()}return this.mouseIsDown=true};Annotator.prototype.checkForEndSelection=function(event){var container,range,_k,_len2,_ref1;this.mouseIsDown=false;if(this.ignoreMouseup){return}this.selectedRanges=this.getSelectedRanges();_ref1=this.selectedRanges;for(_k=0,_len2=_ref1.length;_k<_len2;_k++){range=_ref1[_k];container=range.commonAncestor;if(this.isAnnotator(container)){return}}if(event&&this.selectedRanges.length){return this.adder.css(Util.mousePosition(event,this.wrapper[0])).show()}else{return this.adder.hide()}};Annotator.prototype.isAnnotator=function(element){return!!$(element).parents().addBack().filter("[class^=annotator-]").not("[class=annotator-hl]").not(this.wrapper).length};Annotator.prototype.onHighlightMouseover=function(event){var annotations;this.clearViewerHideTimer();if(this.mouseIsDown){return false}if(this.viewer.isShown()){this.viewer.hide()}annotations=$(event.target).parents(".annotator-hl").addBack().map(function(){return $(this).data("annotation")}).toArray();return this.showViewer(annotations,Util.mousePosition(event,this.wrapper[0]))};Annotator.prototype.onAdderMousedown=function(event){if(event!=null){event.preventDefault()}return this.ignoreMouseup=true};Annotator.prototype.onAdderClick=function(event){var annotation,cancel,cleanup,position,save,_this=this;if(event!=null){event.preventDefault()}position=this.adder.position();this.adder.hide();annotation=this.setupAnnotation(this.createAnnotation());$(annotation.highlights).addClass("annotator-hl-temporary");save=function(){cleanup();$(annotation.highlights).removeClass("annotator-hl-temporary");return _this.publish("annotationCreated",[annotation])};cancel=function(){cleanup();return _this.deleteAnnotation(annotation)};cleanup=function(){_this.unsubscribe("annotationEditorHidden",cancel);return _this.unsubscribe("annotationEditorSubmit",save)};this.subscribe("annotationEditorHidden",cancel);this.subscribe("annotationEditorSubmit",save);return this.showEditor(annotation,position)};Annotator.prototype.onEditAnnotation=function(annotation){var cleanup,offset,update,_this=this;offset=this.viewer.element.position();update=function(){cleanup();return _this.updateAnnotation(annotation)};cleanup=function(){_this.unsubscribe("annotationEditorHidden",cleanup);return _this.unsubscribe("annotationEditorSubmit",update)};this.subscribe("annotationEditorHidden",cleanup);this.subscribe("annotationEditorSubmit",update);this.viewer.hide();return this.showEditor(annotation,offset)};Annotator.prototype.onDeleteAnnotation=function(annotation){this.viewer.hide();return this.deleteAnnotation(annotation)};return Annotator}(Delegator);Annotator.Plugin=function(_super){__extends(Plugin,_super);function Plugin(element,options){Plugin.__super__.constructor.apply(this,arguments)}Plugin.prototype.pluginInit=function(){};return Plugin}(Delegator);g=Util.getGlobal();if(((_ref1=g.document)!=null?_ref1.evaluate:void 0)==null){$.getScript("http://assets.annotateit.org/vendor/xpath.min.js")}if(g.getSelection==null){$.getScript("http://assets.annotateit.org/vendor/ierange.min.js")}if(g.JSON==null){$.getScript("http://assets.annotateit.org/vendor/json2.min.js")}if(g.Node==null){g.Node={ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12}}Annotator.$=$;Annotator.Delegator=Delegator;Annotator.Range=Range;Annotator.Util=Util;Annotator._instances=[];Annotator._t=_t;Annotator.supported=function(){return function(){return!!this.getSelection}()};Annotator.noConflict=function(){Util.getGlobal().Annotator=_Annotator;return this};$.fn.annotator=function(options){var args;args=Array.prototype.slice.call(arguments,1);return this.each(function(){var instance;instance=$.data(this,"annotator");if(options==="destroy"){$.removeData(this,"annotator");return instance!=null?instance.destroy(args):void 0}else if(instance){return options&&instance[options].apply(instance,args)}else{instance=new Annotator(this,options);return $.data(this,"annotator",instance)}})};this.Annotator=Annotator;Annotator.Widget=function(_super){__extends(Widget,_super);Widget.prototype.classes={hide:"annotator-hide",invert:{x:"annotator-invert-x",y:"annotator-invert-y"}};function Widget(element,options){Widget.__super__.constructor.apply(this,arguments);this.classes=$.extend({},Annotator.Widget.prototype.classes,this.classes)}Widget.prototype.destroy=function(){this.removeEvents();return this.element.remove()};Widget.prototype.checkOrientation=function(){var current,offset,viewport,widget,window;this.resetOrientation();window=$(Annotator.Util.getGlobal());widget=this.element.children(":first");offset=widget.offset();viewport={top:window.scrollTop(),right:window.width()+window.scrollLeft()};current={top:offset.top,right:offset.left+widget.width()};if(current.top-viewport.top<0){this.invertY()}if(current.right-viewport.right>0){this.invertX()}return this};Widget.prototype.resetOrientation=function(){this.element.removeClass(this.classes.invert.x).removeClass(this.classes.invert.y);return this};Widget.prototype.invertX=function(){this.element.addClass(this.classes.invert.x);return this};Widget.prototype.invertY=function(){this.element.addClass(this.classes.invert.y);return this};Widget.prototype.isInvertedY=function(){return this.element.hasClass(this.classes.invert.y)};Widget.prototype.isInvertedX=function(){return this.element.hasClass(this.classes.invert.x)};return Widget}(Delegator);Annotator.Editor=function(_super){__extends(Editor,_super);Editor.prototype.events={"form submit":"submit",".annotator-save click":"submit",".annotator-cancel click":"hide",".annotator-cancel mouseover":"onCancelButtonMouseover","textarea keydown":"processKeypress"};Editor.prototype.classes={hide:"annotator-hide",focus:"annotator-focus"};Editor.prototype.html='<div class="annotator-outer annotator-editor">\n  <form class="annotator-widget">\n    <ul class="annotator-listing"></ul>\n    <div class="annotator-controls">\n      <a href="#cancel" class="annotator-cancel">'+_t("Cancel")+'</a>\n<a href="#save" class="annotator-save annotator-focus">'+_t("Save")+"</a>\n    </div>\n  </form>\n</div>";
Editor.prototype.options={};function Editor(options){this.onCancelButtonMouseover=__bind(this.onCancelButtonMouseover,this);this.processKeypress=__bind(this.processKeypress,this);this.submit=__bind(this.submit,this);this.load=__bind(this.load,this);this.hide=__bind(this.hide,this);this.show=__bind(this.show,this);Editor.__super__.constructor.call(this,$(this.html)[0],options);this.fields=[];this.annotation={}}Editor.prototype.show=function(event){Annotator.Util.preventEventDefault(event);this.element.removeClass(this.classes.hide);this.element.find(".annotator-save").addClass(this.classes.focus);this.checkOrientation();this.element.find(":input:first").focus();this.setupDraggables();return this.publish("show")};Editor.prototype.hide=function(event){Annotator.Util.preventEventDefault(event);this.element.addClass(this.classes.hide);return this.publish("hide")};Editor.prototype.load=function(annotation){var field,_k,_len2,_ref2;this.annotation=annotation;this.publish("load",[this.annotation]);_ref2=this.fields;for(_k=0,_len2=_ref2.length;_k<_len2;_k++){field=_ref2[_k];field.load(field.element,this.annotation)}return this.show()};Editor.prototype.submit=function(event){var field,_k,_len2,_ref2;Annotator.Util.preventEventDefault(event);_ref2=this.fields;for(_k=0,_len2=_ref2.length;_k<_len2;_k++){field=_ref2[_k];field.submit(field.element,this.annotation)}this.publish("save",[this.annotation]);return this.hide()};Editor.prototype.addField=function(options){var element,field,input;field=$.extend({id:"annotator-field-"+Annotator.Util.uuid(),type:"input",label:"",load:function(){},submit:function(){}},options);input=null;element=$('<li class="annotator-item" />');field.element=element[0];switch(field.type){case"textarea":input=$("<textarea />");break;case"input":case"checkbox":input=$("<input />");break;case"select":input=$("<select />")}element.append(input);input.attr({id:field.id,placeholder:field.label});if(field.type==="checkbox"){input[0].type="checkbox";element.addClass("annotator-checkbox");element.append($("<label />",{"for":field.id,html:field.label}))}this.element.find("ul:first").append(element);this.fields.push(field);return field.element};Editor.prototype.checkOrientation=function(){var controls,list;Editor.__super__.checkOrientation.apply(this,arguments);list=this.element.find("ul");controls=this.element.find(".annotator-controls");if(this.element.hasClass(this.classes.invert.y)){controls.insertBefore(list)}else if(controls.is(":first-child")){controls.insertAfter(list)}return this};Editor.prototype.processKeypress=function(event){if(event.keyCode===27){return this.hide()}else if(event.keyCode===13&&!event.shiftKey){return this.submit()}};Editor.prototype.onCancelButtonMouseover=function(){return this.element.find("."+this.classes.focus).removeClass(this.classes.focus)};Editor.prototype.setupDraggables=function(){var classes,controls,cornerItem,editor,mousedown,onMousedown,onMousemove,onMouseup,resize,textarea,throttle,_this=this;this.element.find(".annotator-resize").remove();if(this.element.hasClass(this.classes.invert.y)){cornerItem=this.element.find(".annotator-item:last")}else{cornerItem=this.element.find(".annotator-item:first")}if(cornerItem){$('<span class="annotator-resize"></span>').appendTo(cornerItem)}mousedown=null;classes=this.classes;editor=this.element;textarea=null;resize=editor.find(".annotator-resize");controls=editor.find(".annotator-controls");throttle=false;onMousedown=function(event){if(event.target===this){mousedown={element:this,top:event.pageY,left:event.pageX};textarea=editor.find("textarea:first");$(window).bind({"mouseup.annotator-editor-resize":onMouseup,"mousemove.annotator-editor-resize":onMousemove});return event.preventDefault()}};onMouseup=function(){mousedown=null;return $(window).unbind(".annotator-editor-resize")};onMousemove=function(event){var diff,directionX,directionY,height,width;if(mousedown&&throttle===false){diff={top:event.pageY-mousedown.top,left:event.pageX-mousedown.left};if(mousedown.element===resize[0]){height=textarea.height();width=textarea.width();directionX=editor.hasClass(classes.invert.x)?-1:1;directionY=editor.hasClass(classes.invert.y)?1:-1;textarea.height(height+diff.top*directionY);textarea.width(width+diff.left*directionX);if(textarea.height()!==height){mousedown.top=event.pageY}if(textarea.width()!==width){mousedown.left=event.pageX}}else if(mousedown.element===controls[0]){editor.css({top:parseInt(editor.css("top"),10)+diff.top,left:parseInt(editor.css("left"),10)+diff.left});mousedown.top=event.pageY;mousedown.left=event.pageX}throttle=true;return setTimeout(function(){return throttle=false},1e3/60)}};resize.bind("mousedown",onMousedown);return controls.bind("mousedown",onMousedown)};return Editor}(Annotator.Widget);Annotator.Viewer=function(_super){__extends(Viewer,_super);Viewer.prototype.events={".annotator-edit click":"onEditClick",".annotator-delete click":"onDeleteClick"};Viewer.prototype.classes={hide:"annotator-hide",showControls:"annotator-visible"};Viewer.prototype.html={element:'<div class="annotator-outer annotator-viewer">\n  <ul class="annotator-widget annotator-listing"></ul>\n</div>',item:'<li class="annotator-annotation annotator-item">\n  <span class="annotator-controls">\n    <a href="#" title="View as webpage" class="annotator-link">View as webpage</a>\n    <button title="Edit" class="annotator-edit">Edit</button>\n    <button title="Delete" class="annotator-delete">Delete</button>\n  </span>\n</li>'};Viewer.prototype.options={readOnly:false};function Viewer(options){this.onDeleteClick=__bind(this.onDeleteClick,this);this.onEditClick=__bind(this.onEditClick,this);this.load=__bind(this.load,this);this.hide=__bind(this.hide,this);this.show=__bind(this.show,this);Viewer.__super__.constructor.call(this,$(this.html.element)[0],options);this.item=$(this.html.item)[0];this.fields=[];this.annotations=[]}Viewer.prototype.show=function(event){var controls,_this=this;Annotator.Util.preventEventDefault(event);controls=this.element.find(".annotator-controls").addClass(this.classes.showControls);setTimeout(function(){return controls.removeClass(_this.classes.showControls)},500);this.element.removeClass(this.classes.hide);return this.checkOrientation().publish("show")};Viewer.prototype.isShown=function(){return!this.element.hasClass(this.classes.hide)};Viewer.prototype.hide=function(event){Annotator.Util.preventEventDefault(event);this.element.addClass(this.classes.hide);return this.publish("hide")};Viewer.prototype.load=function(annotations){var annotation,controller,controls,del,edit,element,field,item,link,links,list,_k,_l,_len2,_len3,_ref2,_ref3;this.annotations=annotations||[];list=this.element.find("ul:first").empty();_ref2=this.annotations;for(_k=0,_len2=_ref2.length;_k<_len2;_k++){annotation=_ref2[_k];item=$(this.item).clone().appendTo(list).data("annotation",annotation);controls=item.find(".annotator-controls");link=controls.find(".annotator-link");edit=controls.find(".annotator-edit");del=controls.find(".annotator-delete");links=new LinkParser(annotation.links||[]).get("alternate",{type:"text/html"});if(links.length===0||links[0].href==null){link.remove()}else{link.attr("href",links[0].href)}if(this.options.readOnly){edit.remove();del.remove()}else{controller={showEdit:function(){return edit.removeAttr("disabled")},hideEdit:function(){return edit.attr("disabled","disabled")},showDelete:function(){return del.removeAttr("disabled")},hideDelete:function(){return del.attr("disabled","disabled")}}}_ref3=this.fields;for(_l=0,_len3=_ref3.length;_l<_len3;_l++){field=_ref3[_l];element=$(field.element).clone().appendTo(item)[0];field.load(element,annotation,controller)}}this.publish("load",[this.annotations]);return this.show()};Viewer.prototype.addField=function(options){var field;field=$.extend({load:function(){}},options);field.element=$("<div />")[0];this.fields.push(field);field.element;return this};Viewer.prototype.onEditClick=function(event){return this.onButtonClick(event,"edit")};Viewer.prototype.onDeleteClick=function(event){return this.onButtonClick(event,"delete")};Viewer.prototype.onButtonClick=function(event,type){var item;item=$(event.target).parents(".annotator-annotation");return this.publish(type,[item.data("annotation")])};return Viewer}(Annotator.Widget);LinkParser=function(){function LinkParser(data){this.data=data}LinkParser.prototype.get=function(rel,cond){var d,k,keys,match,v,_k,_len2,_ref2,_results;if(cond==null){cond={}}cond=$.extend({},cond,{rel:rel});keys=function(){var _results;_results=[];for(k in cond){if(!__hasProp.call(cond,k))continue;v=cond[k];_results.push(k)}return _results}();_ref2=this.data;_results=[];for(_k=0,_len2=_ref2.length;_k<_len2;_k++){d=_ref2[_k];match=keys.reduce(function(m,k){return m&&d[k]===cond[k]},true);if(match){_results.push(d)}else{continue}}return _results};return LinkParser}();Annotator=Annotator||{};Annotator.Notification=function(_super){__extends(Notification,_super);Notification.prototype.events={click:"hide"};Notification.prototype.options={html:"<div class='annotator-notice'></div>",classes:{show:"annotator-notice-show",info:"annotator-notice-info",success:"annotator-notice-success",error:"annotator-notice-error"}};function Notification(options){this.hide=__bind(this.hide,this);this.show=__bind(this.show,this);Notification.__super__.constructor.call(this,$(this.options.html).appendTo(document.body)[0],options)}Notification.prototype.show=function(message,status){if(status==null){status=Annotator.Notification.INFO}this.currentStatus=status;$(this.element).addClass(this.options.classes.show).addClass(this.options.classes[this.currentStatus]).html(Util.escape(message||""));setTimeout(this.hide,5e3);return this};Notification.prototype.hide=function(){if(this.currentStatus==null){this.currentStatus=Annotator.Notification.INFO}$(this.element).removeClass(this.options.classes.show).removeClass(this.options.classes[this.currentStatus]);return this};return Notification}(Delegator);Annotator.Notification.INFO="info";Annotator.Notification.SUCCESS="success";Annotator.Notification.ERROR="error";$(function(){var notification;notification=new Annotator.Notification;Annotator.showNotification=notification.show;return Annotator.hideNotification=notification.hide})}).call(this);browserify_shim__define__module__export__(typeof Annotator!="undefined"?Annotator:window.Annotator)}).call(global,undefined,undefined,undefined,undefined,function defineExport(ex){module.exports=ex})}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"/Users/nileshgarg/apurva/h/h/static/scripts/vendor/jquery.js":26}],23:[function(require,module,exports){(function(global){var __browserify_shim_require__=require;(function browserifyShim(module,exports,require,define,browserify_shim__define__module__export__){function diff_match_patch(){this.Diff_Timeout=1;this.Diff_EditCost=4;this.Match_Threshold=.5;this.Match_Distance=1e3;this.Patch_DeleteThreshold=.5;this.Patch_Margin=4;this.Match_MaxBits=32}var DIFF_DELETE=-1;var DIFF_INSERT=1;var DIFF_EQUAL=0;diff_match_patch.Diff;diff_match_patch.prototype.diff_main=function(text1,text2,opt_checklines,opt_deadline){if(typeof opt_deadline=="undefined"){if(this.Diff_Timeout<=0){opt_deadline=Number.MAX_VALUE}else{opt_deadline=(new Date).getTime()+this.Diff_Timeout*1e3}}var deadline=opt_deadline;if(text1==null||text2==null){throw new Error("Null input. (diff_main)")}if(text1==text2){if(text1){return[[DIFF_EQUAL,text1]]}return[]}if(typeof opt_checklines=="undefined"){opt_checklines=true}var checklines=opt_checklines;var commonlength=this.diff_commonPrefix(text1,text2);var commonprefix=text1.substring(0,commonlength);text1=text1.substring(commonlength);text2=text2.substring(commonlength);commonlength=this.diff_commonSuffix(text1,text2);var commonsuffix=text1.substring(text1.length-commonlength);text1=text1.substring(0,text1.length-commonlength);text2=text2.substring(0,text2.length-commonlength);var diffs=this.diff_compute_(text1,text2,checklines,deadline);if(commonprefix){diffs.unshift([DIFF_EQUAL,commonprefix])}if(commonsuffix){diffs.push([DIFF_EQUAL,commonsuffix])}this.diff_cleanupMerge(diffs);return diffs};diff_match_patch.prototype.diff_compute_=function(text1,text2,checklines,deadline){var diffs;if(!text1){return[[DIFF_INSERT,text2]]}if(!text2){return[[DIFF_DELETE,text1]]}var longtext=text1.length>text2.length?text1:text2;var shorttext=text1.length>text2.length?text2:text1;var i=longtext.indexOf(shorttext);if(i!=-1){diffs=[[DIFF_INSERT,longtext.substring(0,i)],[DIFF_EQUAL,shorttext],[DIFF_INSERT,longtext.substring(i+shorttext.length)]];if(text1.length>text2.length){diffs[0][0]=diffs[2][0]=DIFF_DELETE}return diffs}if(shorttext.length==1){return[[DIFF_DELETE,text1],[DIFF_INSERT,text2]]}var hm=this.diff_halfMatch_(text1,text2);if(hm){var text1_a=hm[0];var text1_b=hm[1];var text2_a=hm[2];var text2_b=hm[3];var mid_common=hm[4];var diffs_a=this.diff_main(text1_a,text2_a,checklines,deadline);var diffs_b=this.diff_main(text1_b,text2_b,checklines,deadline);return diffs_a.concat([[DIFF_EQUAL,mid_common]],diffs_b)}if(checklines&&text1.length>100&&text2.length>100){return this.diff_lineMode_(text1,text2,deadline)}return this.diff_bisect_(text1,text2,deadline)};diff_match_patch.prototype.diff_lineMode_=function(text1,text2,deadline){var a=this.diff_linesToChars_(text1,text2);text1=a.chars1;text2=a.chars2;var linearray=a.lineArray;var diffs=this.diff_main(text1,text2,false,deadline);this.diff_charsToLines_(diffs,linearray);this.diff_cleanupSemantic(diffs);diffs.push([DIFF_EQUAL,""]);var pointer=0;var count_delete=0;var count_insert=0;var text_delete="";var text_insert="";while(pointer<diffs.length){switch(diffs[pointer][0]){case DIFF_INSERT:count_insert++;text_insert+=diffs[pointer][1];break;case DIFF_DELETE:count_delete++;text_delete+=diffs[pointer][1];break;case DIFF_EQUAL:if(count_delete>=1&&count_insert>=1){diffs.splice(pointer-count_delete-count_insert,count_delete+count_insert);pointer=pointer-count_delete-count_insert;var a=this.diff_main(text_delete,text_insert,false,deadline);for(var j=a.length-1;j>=0;j--){diffs.splice(pointer,0,a[j])}pointer=pointer+a.length}count_insert=0;count_delete=0;text_delete="";text_insert="";break}pointer++}diffs.pop();return diffs};diff_match_patch.prototype.diff_bisect_=function(text1,text2,deadline){var text1_length=text1.length;var text2_length=text2.length;var max_d=Math.ceil((text1_length+text2_length)/2);var v_offset=max_d;var v_length=2*max_d;var v1=new Array(v_length);var v2=new Array(v_length);for(var x=0;x<v_length;x++){v1[x]=-1;v2[x]=-1}v1[v_offset+1]=0;v2[v_offset+1]=0;var delta=text1_length-text2_length;var front=delta%2!=0;var k1start=0;var k1end=0;var k2start=0;var k2end=0;for(var d=0;d<max_d;d++){if((new Date).getTime()>deadline){break}for(var k1=-d+k1start;k1<=d-k1end;k1+=2){var k1_offset=v_offset+k1;var x1;if(k1==-d||k1!=d&&v1[k1_offset-1]<v1[k1_offset+1]){x1=v1[k1_offset+1]}else{x1=v1[k1_offset-1]+1}var y1=x1-k1;while(x1<text1_length&&y1<text2_length&&text1.charAt(x1)==text2.charAt(y1)){x1++;y1++}v1[k1_offset]=x1;if(x1>text1_length){k1end+=2}else if(y1>text2_length){k1start+=2}else if(front){var k2_offset=v_offset+delta-k1;if(k2_offset>=0&&k2_offset<v_length&&v2[k2_offset]!=-1){var x2=text1_length-v2[k2_offset];if(x1>=x2){return this.diff_bisectSplit_(text1,text2,x1,y1,deadline)}}}}for(var k2=-d+k2start;k2<=d-k2end;k2+=2){var k2_offset=v_offset+k2;var x2;if(k2==-d||k2!=d&&v2[k2_offset-1]<v2[k2_offset+1]){x2=v2[k2_offset+1]}else{x2=v2[k2_offset-1]+1}var y2=x2-k2;while(x2<text1_length&&y2<text2_length&&text1.charAt(text1_length-x2-1)==text2.charAt(text2_length-y2-1)){x2++;y2++}v2[k2_offset]=x2;if(x2>text1_length){k2end+=2}else if(y2>text2_length){k2start+=2}else if(!front){var k1_offset=v_offset+delta-k2;if(k1_offset>=0&&k1_offset<v_length&&v1[k1_offset]!=-1){var x1=v1[k1_offset];var y1=v_offset+x1-k1_offset;x2=text1_length-x2;if(x1>=x2){return this.diff_bisectSplit_(text1,text2,x1,y1,deadline)}}}}}return[[DIFF_DELETE,text1],[DIFF_INSERT,text2]]};diff_match_patch.prototype.diff_bisectSplit_=function(text1,text2,x,y,deadline){var text1a=text1.substring(0,x);var text2a=text2.substring(0,y);var text1b=text1.substring(x);var text2b=text2.substring(y);var diffs=this.diff_main(text1a,text2a,false,deadline);var diffsb=this.diff_main(text1b,text2b,false,deadline);return diffs.concat(diffsb)};diff_match_patch.prototype.diff_linesToChars_=function(text1,text2){var lineArray=[];var lineHash={};lineArray[0]="";function diff_linesToCharsMunge_(text){var chars="";var lineStart=0;var lineEnd=-1;var lineArrayLength=lineArray.length;while(lineEnd<text.length-1){lineEnd=text.indexOf("\n",lineStart);if(lineEnd==-1){lineEnd=text.length-1}var line=text.substring(lineStart,lineEnd+1);lineStart=lineEnd+1;if(lineHash.hasOwnProperty?lineHash.hasOwnProperty(line):lineHash[line]!==undefined){chars+=String.fromCharCode(lineHash[line])}else{chars+=String.fromCharCode(lineArrayLength);lineHash[line]=lineArrayLength;lineArray[lineArrayLength++]=line}}return chars}var chars1=diff_linesToCharsMunge_(text1);var chars2=diff_linesToCharsMunge_(text2);return{chars1:chars1,chars2:chars2,lineArray:lineArray}};diff_match_patch.prototype.diff_charsToLines_=function(diffs,lineArray){for(var x=0;x<diffs.length;x++){var chars=diffs[x][1];var text=[];for(var y=0;y<chars.length;y++){text[y]=lineArray[chars.charCodeAt(y)]}diffs[x][1]=text.join("")}};diff_match_patch.prototype.diff_commonPrefix=function(text1,text2){if(!text1||!text2||text1.charAt(0)!=text2.charAt(0)){return 0}var pointermin=0;var pointermax=Math.min(text1.length,text2.length);var pointermid=pointermax;var pointerstart=0;while(pointermin<pointermid){if(text1.substring(pointerstart,pointermid)==text2.substring(pointerstart,pointermid)){pointermin=pointermid;pointerstart=pointermin}else{pointermax=pointermid}pointermid=Math.floor((pointermax-pointermin)/2+pointermin)}return pointermid};diff_match_patch.prototype.diff_commonSuffix=function(text1,text2){if(!text1||!text2||text1.charAt(text1.length-1)!=text2.charAt(text2.length-1)){return 0}var pointermin=0;var pointermax=Math.min(text1.length,text2.length);var pointermid=pointermax;var pointerend=0;while(pointermin<pointermid){if(text1.substring(text1.length-pointermid,text1.length-pointerend)==text2.substring(text2.length-pointermid,text2.length-pointerend)){pointermin=pointermid;pointerend=pointermin}else{pointermax=pointermid}pointermid=Math.floor((pointermax-pointermin)/2+pointermin)}return pointermid};diff_match_patch.prototype.diff_commonOverlap_=function(text1,text2){var text1_length=text1.length;var text2_length=text2.length;if(text1_length==0||text2_length==0){return 0}if(text1_length>text2_length){text1=text1.substring(text1_length-text2_length)}else if(text1_length<text2_length){text2=text2.substring(0,text1_length)}var text_length=Math.min(text1_length,text2_length);if(text1==text2){return text_length}var best=0;var length=1;while(true){var pattern=text1.substring(text_length-length);var found=text2.indexOf(pattern);if(found==-1){return best}length+=found;if(found==0||text1.substring(text_length-length)==text2.substring(0,length)){best=length;length++}}};diff_match_patch.prototype.diff_halfMatch_=function(text1,text2){if(this.Diff_Timeout<=0){return null}var longtext=text1.length>text2.length?text1:text2;var shorttext=text1.length>text2.length?text2:text1;if(longtext.length<4||shorttext.length*2<longtext.length){return null}var dmp=this;function diff_halfMatchI_(longtext,shorttext,i){var seed=longtext.substring(i,i+Math.floor(longtext.length/4));var j=-1;var best_common="";var best_longtext_a,best_longtext_b,best_shorttext_a,best_shorttext_b;while((j=shorttext.indexOf(seed,j+1))!=-1){var prefixLength=dmp.diff_commonPrefix(longtext.substring(i),shorttext.substring(j));var suffixLength=dmp.diff_commonSuffix(longtext.substring(0,i),shorttext.substring(0,j));if(best_common.length<suffixLength+prefixLength){best_common=shorttext.substring(j-suffixLength,j)+shorttext.substring(j,j+prefixLength);best_longtext_a=longtext.substring(0,i-suffixLength);best_longtext_b=longtext.substring(i+prefixLength);best_shorttext_a=shorttext.substring(0,j-suffixLength);best_shorttext_b=shorttext.substring(j+prefixLength)}}if(best_common.length*2>=longtext.length){return[best_longtext_a,best_longtext_b,best_shorttext_a,best_shorttext_b,best_common]}else{return null}}var hm1=diff_halfMatchI_(longtext,shorttext,Math.ceil(longtext.length/4));var hm2=diff_halfMatchI_(longtext,shorttext,Math.ceil(longtext.length/2));var hm;if(!hm1&&!hm2){return null}else if(!hm2){hm=hm1}else if(!hm1){hm=hm2}else{hm=hm1[4].length>hm2[4].length?hm1:hm2}var text1_a,text1_b,text2_a,text2_b;if(text1.length>text2.length){text1_a=hm[0];text1_b=hm[1];text2_a=hm[2];text2_b=hm[3]}else{text2_a=hm[0];text2_b=hm[1];text1_a=hm[2];text1_b=hm[3]}var mid_common=hm[4];return[text1_a,text1_b,text2_a,text2_b,mid_common]};diff_match_patch.prototype.diff_cleanupSemantic=function(diffs){var changes=false;var equalities=[];var equalitiesLength=0;var lastequality=null;var pointer=0;var length_insertions1=0;var length_deletions1=0;var length_insertions2=0;var length_deletions2=0;while(pointer<diffs.length){if(diffs[pointer][0]==DIFF_EQUAL){equalities[equalitiesLength++]=pointer;length_insertions1=length_insertions2;length_deletions1=length_deletions2;length_insertions2=0;length_deletions2=0;lastequality=diffs[pointer][1]}else{if(diffs[pointer][0]==DIFF_INSERT){length_insertions2+=diffs[pointer][1].length}else{length_deletions2+=diffs[pointer][1].length}if(lastequality&&lastequality.length<=Math.max(length_insertions1,length_deletions1)&&lastequality.length<=Math.max(length_insertions2,length_deletions2)){diffs.splice(equalities[equalitiesLength-1],0,[DIFF_DELETE,lastequality]);diffs[equalities[equalitiesLength-1]+1][0]=DIFF_INSERT;equalitiesLength--;equalitiesLength--;pointer=equalitiesLength>0?equalities[equalitiesLength-1]:-1;length_insertions1=0;length_deletions1=0;length_insertions2=0;length_deletions2=0;lastequality=null;changes=true}}pointer++}if(changes){this.diff_cleanupMerge(diffs)}this.diff_cleanupSemanticLossless(diffs);pointer=1;while(pointer<diffs.length){if(diffs[pointer-1][0]==DIFF_DELETE&&diffs[pointer][0]==DIFF_INSERT){var deletion=diffs[pointer-1][1];var insertion=diffs[pointer][1];var overlap_length1=this.diff_commonOverlap_(deletion,insertion);var overlap_length2=this.diff_commonOverlap_(insertion,deletion);if(overlap_length1>=overlap_length2){if(overlap_length1>=deletion.length/2||overlap_length1>=insertion.length/2){diffs.splice(pointer,0,[DIFF_EQUAL,insertion.substring(0,overlap_length1)]);diffs[pointer-1][1]=deletion.substring(0,deletion.length-overlap_length1);diffs[pointer+1][1]=insertion.substring(overlap_length1);pointer++}}else{if(overlap_length2>=deletion.length/2||overlap_length2>=insertion.length/2){diffs.splice(pointer,0,[DIFF_EQUAL,deletion.substring(0,overlap_length2)]);diffs[pointer-1][0]=DIFF_INSERT;diffs[pointer-1][1]=insertion.substring(0,insertion.length-overlap_length2);diffs[pointer+1][0]=DIFF_DELETE;diffs[pointer+1][1]=deletion.substring(overlap_length2);pointer++}}pointer++}pointer++}};diff_match_patch.prototype.diff_cleanupSemanticLossless=function(diffs){function diff_cleanupSemanticScore_(one,two){if(!one||!two){return 6}var char1=one.charAt(one.length-1);var char2=two.charAt(0);var nonAlphaNumeric1=char1.match(diff_match_patch.nonAlphaNumericRegex_);var nonAlphaNumeric2=char2.match(diff_match_patch.nonAlphaNumericRegex_);var whitespace1=nonAlphaNumeric1&&char1.match(diff_match_patch.whitespaceRegex_);var whitespace2=nonAlphaNumeric2&&char2.match(diff_match_patch.whitespaceRegex_);var lineBreak1=whitespace1&&char1.match(diff_match_patch.linebreakRegex_);var lineBreak2=whitespace2&&char2.match(diff_match_patch.linebreakRegex_);var blankLine1=lineBreak1&&one.match(diff_match_patch.blanklineEndRegex_);var blankLine2=lineBreak2&&two.match(diff_match_patch.blanklineStartRegex_);if(blankLine1||blankLine2){return 5}else if(lineBreak1||lineBreak2){return 4}else if(nonAlphaNumeric1&&!whitespace1&&whitespace2){return 3}else if(whitespace1||whitespace2){return 2}else if(nonAlphaNumeric1||nonAlphaNumeric2){return 1}return 0}var pointer=1;while(pointer<diffs.length-1){if(diffs[pointer-1][0]==DIFF_EQUAL&&diffs[pointer+1][0]==DIFF_EQUAL){var equality1=diffs[pointer-1][1];var edit=diffs[pointer][1];var equality2=diffs[pointer+1][1];var commonOffset=this.diff_commonSuffix(equality1,edit);if(commonOffset){var commonString=edit.substring(edit.length-commonOffset);equality1=equality1.substring(0,equality1.length-commonOffset);edit=commonString+edit.substring(0,edit.length-commonOffset);equality2=commonString+equality2}var bestEquality1=equality1;var bestEdit=edit;var bestEquality2=equality2;var bestScore=diff_cleanupSemanticScore_(equality1,edit)+diff_cleanupSemanticScore_(edit,equality2);while(edit.charAt(0)===equality2.charAt(0)){equality1+=edit.charAt(0);edit=edit.substring(1)+equality2.charAt(0);equality2=equality2.substring(1);var score=diff_cleanupSemanticScore_(equality1,edit)+diff_cleanupSemanticScore_(edit,equality2);if(score>=bestScore){bestScore=score;bestEquality1=equality1;bestEdit=edit;bestEquality2=equality2}}if(diffs[pointer-1][1]!=bestEquality1){if(bestEquality1){diffs[pointer-1][1]=bestEquality1}else{diffs.splice(pointer-1,1);pointer--}diffs[pointer][1]=bestEdit;if(bestEquality2){diffs[pointer+1][1]=bestEquality2}else{diffs.splice(pointer+1,1);pointer--}}}pointer++}};diff_match_patch.nonAlphaNumericRegex_=/[^a-zA-Z0-9]/;diff_match_patch.whitespaceRegex_=/\s/;diff_match_patch.linebreakRegex_=/[\r\n]/;diff_match_patch.blanklineEndRegex_=/\n\r?\n$/;diff_match_patch.blanklineStartRegex_=/^\r?\n\r?\n/;diff_match_patch.prototype.diff_cleanupEfficiency=function(diffs){var changes=false;var equalities=[];var equalitiesLength=0;var lastequality=null;var pointer=0;var pre_ins=false;var pre_del=false;var post_ins=false;var post_del=false;while(pointer<diffs.length){if(diffs[pointer][0]==DIFF_EQUAL){if(diffs[pointer][1].length<this.Diff_EditCost&&(post_ins||post_del)){equalities[equalitiesLength++]=pointer;pre_ins=post_ins;pre_del=post_del;lastequality=diffs[pointer][1]}else{equalitiesLength=0;lastequality=null}post_ins=post_del=false}else{if(diffs[pointer][0]==DIFF_DELETE){post_del=true}else{post_ins=true}if(lastequality&&(pre_ins&&pre_del&&post_ins&&post_del||lastequality.length<this.Diff_EditCost/2&&pre_ins+pre_del+post_ins+post_del==3)){diffs.splice(equalities[equalitiesLength-1],0,[DIFF_DELETE,lastequality]);diffs[equalities[equalitiesLength-1]+1][0]=DIFF_INSERT;equalitiesLength--;lastequality=null;if(pre_ins&&pre_del){post_ins=post_del=true;equalitiesLength=0}else{equalitiesLength--;pointer=equalitiesLength>0?equalities[equalitiesLength-1]:-1;post_ins=post_del=false}changes=true}}pointer++}if(changes){this.diff_cleanupMerge(diffs)}};diff_match_patch.prototype.diff_cleanupMerge=function(diffs){diffs.push([DIFF_EQUAL,""]);var pointer=0;var count_delete=0;var count_insert=0;var text_delete="";var text_insert="";var commonlength;while(pointer<diffs.length){switch(diffs[pointer][0]){case DIFF_INSERT:count_insert++;text_insert+=diffs[pointer][1];pointer++;break;case DIFF_DELETE:count_delete++;text_delete+=diffs[pointer][1];pointer++;break;case DIFF_EQUAL:if(count_delete+count_insert>1){if(count_delete!==0&&count_insert!==0){commonlength=this.diff_commonPrefix(text_insert,text_delete);if(commonlength!==0){if(pointer-count_delete-count_insert>0&&diffs[pointer-count_delete-count_insert-1][0]==DIFF_EQUAL){diffs[pointer-count_delete-count_insert-1][1]+=text_insert.substring(0,commonlength)}else{diffs.splice(0,0,[DIFF_EQUAL,text_insert.substring(0,commonlength)]);pointer++}text_insert=text_insert.substring(commonlength);text_delete=text_delete.substring(commonlength)}commonlength=this.diff_commonSuffix(text_insert,text_delete);if(commonlength!==0){diffs[pointer][1]=text_insert.substring(text_insert.length-commonlength)+diffs[pointer][1];text_insert=text_insert.substring(0,text_insert.length-commonlength);text_delete=text_delete.substring(0,text_delete.length-commonlength)}}if(count_delete===0){diffs.splice(pointer-count_insert,count_delete+count_insert,[DIFF_INSERT,text_insert])}else if(count_insert===0){diffs.splice(pointer-count_delete,count_delete+count_insert,[DIFF_DELETE,text_delete])}else{diffs.splice(pointer-count_delete-count_insert,count_delete+count_insert,[DIFF_DELETE,text_delete],[DIFF_INSERT,text_insert])}pointer=pointer-count_delete-count_insert+(count_delete?1:0)+(count_insert?1:0)+1}else if(pointer!==0&&diffs[pointer-1][0]==DIFF_EQUAL){diffs[pointer-1][1]+=diffs[pointer][1];diffs.splice(pointer,1)}else{pointer++}count_insert=0;count_delete=0;text_delete="";text_insert="";break}}if(diffs[diffs.length-1][1]===""){diffs.pop()}var changes=false;pointer=1;while(pointer<diffs.length-1){if(diffs[pointer-1][0]==DIFF_EQUAL&&diffs[pointer+1][0]==DIFF_EQUAL){if(diffs[pointer][1].substring(diffs[pointer][1].length-diffs[pointer-1][1].length)==diffs[pointer-1][1]){diffs[pointer][1]=diffs[pointer-1][1]+diffs[pointer][1].substring(0,diffs[pointer][1].length-diffs[pointer-1][1].length);diffs[pointer+1][1]=diffs[pointer-1][1]+diffs[pointer+1][1];diffs.splice(pointer-1,1);changes=true}else if(diffs[pointer][1].substring(0,diffs[pointer+1][1].length)==diffs[pointer+1][1]){diffs[pointer-1][1]+=diffs[pointer+1][1];diffs[pointer][1]=diffs[pointer][1].substring(diffs[pointer+1][1].length)+diffs[pointer+1][1];diffs.splice(pointer+1,1);changes=true}}pointer++}if(changes){this.diff_cleanupMerge(diffs)}};diff_match_patch.prototype.diff_xIndex=function(diffs,loc){var chars1=0;var chars2=0;var last_chars1=0;var last_chars2=0;var x;for(x=0;x<diffs.length;x++){if(diffs[x][0]!==DIFF_INSERT){chars1+=diffs[x][1].length}if(diffs[x][0]!==DIFF_DELETE){chars2+=diffs[x][1].length}if(chars1>loc){break}last_chars1=chars1;last_chars2=chars2}if(diffs.length!=x&&diffs[x][0]===DIFF_DELETE){return last_chars2}return last_chars2+(loc-last_chars1)};diff_match_patch.prototype.diff_prettyHtml=function(diffs){var html=[];var pattern_amp=/&/g;var pattern_lt=/</g;var pattern_gt=/>/g;var pattern_para=/\n/g;for(var x=0;x<diffs.length;x++){var op=diffs[x][0];var data=diffs[x][1];var text=data.replace(pattern_amp,"&amp;").replace(pattern_lt,"&lt;").replace(pattern_gt,"&gt;").replace(pattern_para,"&para;<br>");switch(op){case DIFF_INSERT:html[x]='<ins style="background:#e6ffe6;">'+text+"</ins>";break;case DIFF_DELETE:html[x]='<del style="background:#ffe6e6;">'+text+"</del>";break;case DIFF_EQUAL:html[x]="<span>"+text+"</span>";break}}return html.join("")};diff_match_patch.prototype.diff_text1=function(diffs){var text=[];for(var x=0;x<diffs.length;x++){if(diffs[x][0]!==DIFF_INSERT){text[x]=diffs[x][1]}}return text.join("")};diff_match_patch.prototype.diff_text2=function(diffs){var text=[];for(var x=0;x<diffs.length;x++){if(diffs[x][0]!==DIFF_DELETE){text[x]=diffs[x][1]}}return text.join("")};diff_match_patch.prototype.diff_levenshtein=function(diffs){var levenshtein=0;var insertions=0;var deletions=0;for(var x=0;x<diffs.length;x++){var op=diffs[x][0];var data=diffs[x][1];switch(op){case DIFF_INSERT:insertions+=data.length;break;case DIFF_DELETE:deletions+=data.length;break;case DIFF_EQUAL:levenshtein+=Math.max(insertions,deletions);insertions=0;deletions=0;break}}levenshtein+=Math.max(insertions,deletions);return levenshtein};diff_match_patch.prototype.diff_toDelta=function(diffs){var text=[];for(var x=0;x<diffs.length;x++){switch(diffs[x][0]){case DIFF_INSERT:text[x]="+"+encodeURI(diffs[x][1]);break;case DIFF_DELETE:text[x]="-"+diffs[x][1].length;break;case DIFF_EQUAL:text[x]="="+diffs[x][1].length;break}}return text.join("	").replace(/%20/g," ")};diff_match_patch.prototype.diff_fromDelta=function(text1,delta){var diffs=[];var diffsLength=0;var pointer=0;var tokens=delta.split(/\t/g);for(var x=0;x<tokens.length;x++){var param=tokens[x].substring(1);switch(tokens[x].charAt(0)){
case"+":try{diffs[diffsLength++]=[DIFF_INSERT,decodeURI(param)]}catch(ex){throw new Error("Illegal escape in diff_fromDelta: "+param)}break;case"-":case"=":var n=parseInt(param,10);if(isNaN(n)||n<0){throw new Error("Invalid number in diff_fromDelta: "+param)}var text=text1.substring(pointer,pointer+=n);if(tokens[x].charAt(0)=="="){diffs[diffsLength++]=[DIFF_EQUAL,text]}else{diffs[diffsLength++]=[DIFF_DELETE,text]}break;default:if(tokens[x]){throw new Error("Invalid diff operation in diff_fromDelta: "+tokens[x])}}}if(pointer!=text1.length){throw new Error("Delta length ("+pointer+") does not equal source text length ("+text1.length+").")}return diffs};diff_match_patch.prototype.match_main=function(text,pattern,loc){if(text==null||pattern==null||loc==null){throw new Error("Null input. (match_main)")}loc=Math.max(0,Math.min(loc,text.length));if(text==pattern){return{index:0,error:0}}else if(!text.length){return{index:-1}}else if(text.substring(loc,loc+pattern.length)==pattern){return{index:loc,error:0}}else{return this.match_bitap_(text,pattern,loc)}};diff_match_patch.prototype.match_bitap_=function(text,pattern,loc){if(pattern.length>this.Match_MaxBits){throw new Error("Pattern too long for this browser.")}var s=this.match_alphabet_(pattern);var dmp=this;function match_bitapScore_(e,x){var accuracy=e/pattern.length;var proximity=Math.abs(loc-x);if(!dmp.Match_Distance){return proximity?1:accuracy}return accuracy+proximity/dmp.Match_Distance}var score_threshold=this.Match_Threshold;var best_loc=text.indexOf(pattern,loc);if(best_loc!=-1){score_threshold=Math.min(match_bitapScore_(0,best_loc),score_threshold);best_loc=text.lastIndexOf(pattern,loc+pattern.length);if(best_loc!=-1){score_threshold=Math.min(match_bitapScore_(0,best_loc),score_threshold)}}var matchmask=1<<pattern.length-1;best_loc=-1;var bin_min,bin_mid;var bin_max=pattern.length+text.length;var last_rd;for(var d=0;d<pattern.length;d++){bin_min=0;bin_mid=bin_max;while(bin_min<bin_mid){if(match_bitapScore_(d,loc+bin_mid)<=score_threshold){bin_min=bin_mid}else{bin_max=bin_mid}bin_mid=Math.floor((bin_max-bin_min)/2+bin_min)}bin_max=bin_mid;var start=Math.max(1,loc-bin_mid+1);var finish=Math.min(loc+bin_mid,text.length)+pattern.length;try{var rd=Array(finish+2)}catch(ex){window.alert("Please update to Chrome 30 or better.");throw new Error("Failed to create array for "+(finish+2)+" elements!")}rd[finish+1]=(1<<d)-1;for(var j=finish;j>=start;j--){var charMatch=s[text.charAt(j-1)];if(d===0){rd[j]=(rd[j+1]<<1|1)&charMatch}else{rd[j]=(rd[j+1]<<1|1)&charMatch|((last_rd[j+1]|last_rd[j])<<1|1)|last_rd[j+1]}if(rd[j]&matchmask){var score=match_bitapScore_(d,j-1);if(score<=score_threshold){score_threshold=score;best_loc=j-1;if(best_loc>loc){start=Math.max(1,2*loc-best_loc)}else{break}}}}if(match_bitapScore_(d+1,loc)>score_threshold){break}last_rd=rd}return{index:best_loc,error:score_threshold}};diff_match_patch.prototype.match_alphabet_=function(pattern){var s={};for(var i=0;i<pattern.length;i++){s[pattern.charAt(i)]=0}for(var i=0;i<pattern.length;i++){s[pattern.charAt(i)]|=1<<pattern.length-i-1}return s};diff_match_patch.prototype.patch_addContext_=function(patch,text){if(text.length==0){return}var pattern=text.substring(patch.start2,patch.start2+patch.length1);var padding=0;while(text.indexOf(pattern)!=text.lastIndexOf(pattern)&&pattern.length<this.Match_MaxBits-this.Patch_Margin-this.Patch_Margin){padding+=this.Patch_Margin;pattern=text.substring(patch.start2-padding,patch.start2+patch.length1+padding)}padding+=this.Patch_Margin;var prefix=text.substring(patch.start2-padding,patch.start2);if(prefix){patch.diffs.unshift([DIFF_EQUAL,prefix])}var suffix=text.substring(patch.start2+patch.length1,patch.start2+patch.length1+padding);if(suffix){patch.diffs.push([DIFF_EQUAL,suffix])}patch.start1-=prefix.length;patch.start2-=prefix.length;patch.length1+=prefix.length+suffix.length;patch.length2+=prefix.length+suffix.length};diff_match_patch.prototype.patch_make=function(a,opt_b,opt_c){var text1,diffs;if(typeof a=="string"&&typeof opt_b=="string"&&typeof opt_c=="undefined"){text1=a;diffs=this.diff_main(text1,opt_b,true);if(diffs.length>2){this.diff_cleanupSemantic(diffs);this.diff_cleanupEfficiency(diffs)}}else if(a&&typeof a=="object"&&typeof opt_b=="undefined"&&typeof opt_c=="undefined"){diffs=a;text1=this.diff_text1(diffs)}else if(typeof a=="string"&&opt_b&&typeof opt_b=="object"&&typeof opt_c=="undefined"){text1=a;diffs=opt_b}else if(typeof a=="string"&&typeof opt_b=="string"&&opt_c&&typeof opt_c=="object"){text1=a;diffs=opt_c}else{throw new Error("Unknown call format to patch_make.")}if(diffs.length===0){return[]}var patches=[];var patch=new diff_match_patch.patch_obj;var patchDiffLength=0;var char_count1=0;var char_count2=0;var prepatch_text=text1;var postpatch_text=text1;for(var x=0;x<diffs.length;x++){var diff_type=diffs[x][0];var diff_text=diffs[x][1];if(!patchDiffLength&&diff_type!==DIFF_EQUAL){patch.start1=char_count1;patch.start2=char_count2}switch(diff_type){case DIFF_INSERT:patch.diffs[patchDiffLength++]=diffs[x];patch.length2+=diff_text.length;postpatch_text=postpatch_text.substring(0,char_count2)+diff_text+postpatch_text.substring(char_count2);break;case DIFF_DELETE:patch.length1+=diff_text.length;patch.diffs[patchDiffLength++]=diffs[x];postpatch_text=postpatch_text.substring(0,char_count2)+postpatch_text.substring(char_count2+diff_text.length);break;case DIFF_EQUAL:if(diff_text.length<=2*this.Patch_Margin&&patchDiffLength&&diffs.length!=x+1){patch.diffs[patchDiffLength++]=diffs[x];patch.length1+=diff_text.length;patch.length2+=diff_text.length}else if(diff_text.length>=2*this.Patch_Margin){if(patchDiffLength){this.patch_addContext_(patch,prepatch_text);patches.push(patch);patch=new diff_match_patch.patch_obj;patchDiffLength=0;prepatch_text=postpatch_text;char_count1=char_count2}}break}if(diff_type!==DIFF_INSERT){char_count1+=diff_text.length}if(diff_type!==DIFF_DELETE){char_count2+=diff_text.length}}if(patchDiffLength){this.patch_addContext_(patch,prepatch_text);patches.push(patch)}return patches};diff_match_patch.prototype.patch_deepCopy=function(patches){var patchesCopy=[];for(var x=0;x<patches.length;x++){var patch=patches[x];var patchCopy=new diff_match_patch.patch_obj;patchCopy.diffs=[];for(var y=0;y<patch.diffs.length;y++){patchCopy.diffs[y]=patch.diffs[y].slice()}patchCopy.start1=patch.start1;patchCopy.start2=patch.start2;patchCopy.length1=patch.length1;patchCopy.length2=patch.length2;patchesCopy[x]=patchCopy}return patchesCopy};diff_match_patch.prototype.patch_apply=function(patches,text){if(patches.length==0){return[text,[]]}patches=this.patch_deepCopy(patches);var nullPadding=this.patch_addPadding(patches);text=nullPadding+text+nullPadding;this.patch_splitMax(patches);var delta=0;var results=[];for(var x=0;x<patches.length;x++){var expected_loc=patches[x].start2+delta;var text1=this.diff_text1(patches[x].diffs);var start_loc;var end_loc=-1;if(text1.length>this.Match_MaxBits){start_loc=this.match_main(text,text1.substring(0,this.Match_MaxBits),expected_loc);if(start_loc!=-1){end_loc=this.match_main(text,text1.substring(text1.length-this.Match_MaxBits),expected_loc+text1.length-this.Match_MaxBits);if(end_loc==-1||start_loc>=end_loc){start_loc=-1}}}else{start_loc=this.match_main(text,text1,expected_loc)}if(start_loc==-1){results[x]=false;delta-=patches[x].length2-patches[x].length1}else{results[x]=true;delta=start_loc-expected_loc;var text2;if(end_loc==-1){text2=text.substring(start_loc,start_loc+text1.length)}else{text2=text.substring(start_loc,end_loc+this.Match_MaxBits)}if(text1==text2){text=text.substring(0,start_loc)+this.diff_text2(patches[x].diffs)+text.substring(start_loc+text1.length)}else{var diffs=this.diff_main(text1,text2,false);if(text1.length>this.Match_MaxBits&&this.diff_levenshtein(diffs)/text1.length>this.Patch_DeleteThreshold){results[x]=false}else{this.diff_cleanupSemanticLossless(diffs);var index1=0;var index2;for(var y=0;y<patches[x].diffs.length;y++){var mod=patches[x].diffs[y];if(mod[0]!==DIFF_EQUAL){index2=this.diff_xIndex(diffs,index1)}if(mod[0]===DIFF_INSERT){text=text.substring(0,start_loc+index2)+mod[1]+text.substring(start_loc+index2)}else if(mod[0]===DIFF_DELETE){text=text.substring(0,start_loc+index2)+text.substring(start_loc+this.diff_xIndex(diffs,index1+mod[1].length))}if(mod[0]!==DIFF_DELETE){index1+=mod[1].length}}}}}}text=text.substring(nullPadding.length,text.length-nullPadding.length);return[text,results]};diff_match_patch.prototype.patch_addPadding=function(patches){var paddingLength=this.Patch_Margin;var nullPadding="";for(var x=1;x<=paddingLength;x++){nullPadding+=String.fromCharCode(x)}for(var x=0;x<patches.length;x++){patches[x].start1+=paddingLength;patches[x].start2+=paddingLength}var patch=patches[0];var diffs=patch.diffs;if(diffs.length==0||diffs[0][0]!=DIFF_EQUAL){diffs.unshift([DIFF_EQUAL,nullPadding]);patch.start1-=paddingLength;patch.start2-=paddingLength;patch.length1+=paddingLength;patch.length2+=paddingLength}else if(paddingLength>diffs[0][1].length){var extraLength=paddingLength-diffs[0][1].length;diffs[0][1]=nullPadding.substring(diffs[0][1].length)+diffs[0][1];patch.start1-=extraLength;patch.start2-=extraLength;patch.length1+=extraLength;patch.length2+=extraLength}patch=patches[patches.length-1];diffs=patch.diffs;if(diffs.length==0||diffs[diffs.length-1][0]!=DIFF_EQUAL){diffs.push([DIFF_EQUAL,nullPadding]);patch.length1+=paddingLength;patch.length2+=paddingLength}else if(paddingLength>diffs[diffs.length-1][1].length){var extraLength=paddingLength-diffs[diffs.length-1][1].length;diffs[diffs.length-1][1]+=nullPadding.substring(0,extraLength);patch.length1+=extraLength;patch.length2+=extraLength}return nullPadding};diff_match_patch.prototype.patch_splitMax=function(patches){var patch_size=this.Match_MaxBits;for(var x=0;x<patches.length;x++){if(patches[x].length1<=patch_size){continue}var bigpatch=patches[x];patches.splice(x--,1);var start1=bigpatch.start1;var start2=bigpatch.start2;var precontext="";while(bigpatch.diffs.length!==0){var patch=new diff_match_patch.patch_obj;var empty=true;patch.start1=start1-precontext.length;patch.start2=start2-precontext.length;if(precontext!==""){patch.length1=patch.length2=precontext.length;patch.diffs.push([DIFF_EQUAL,precontext])}while(bigpatch.diffs.length!==0&&patch.length1<patch_size-this.Patch_Margin){var diff_type=bigpatch.diffs[0][0];var diff_text=bigpatch.diffs[0][1];if(diff_type===DIFF_INSERT){patch.length2+=diff_text.length;start2+=diff_text.length;patch.diffs.push(bigpatch.diffs.shift());empty=false}else if(diff_type===DIFF_DELETE&&patch.diffs.length==1&&patch.diffs[0][0]==DIFF_EQUAL&&diff_text.length>2*patch_size){patch.length1+=diff_text.length;start1+=diff_text.length;empty=false;patch.diffs.push([diff_type,diff_text]);bigpatch.diffs.shift()}else{diff_text=diff_text.substring(0,patch_size-patch.length1-this.Patch_Margin);patch.length1+=diff_text.length;start1+=diff_text.length;if(diff_type===DIFF_EQUAL){patch.length2+=diff_text.length;start2+=diff_text.length}else{empty=false}patch.diffs.push([diff_type,diff_text]);if(diff_text==bigpatch.diffs[0][1]){bigpatch.diffs.shift()}else{bigpatch.diffs[0][1]=bigpatch.diffs[0][1].substring(diff_text.length)}}}precontext=this.diff_text2(patch.diffs);precontext=precontext.substring(precontext.length-this.Patch_Margin);var postcontext=this.diff_text1(bigpatch.diffs).substring(0,this.Patch_Margin);if(postcontext!==""){patch.length1+=postcontext.length;patch.length2+=postcontext.length;if(patch.diffs.length!==0&&patch.diffs[patch.diffs.length-1][0]===DIFF_EQUAL){patch.diffs[patch.diffs.length-1][1]+=postcontext}else{patch.diffs.push([DIFF_EQUAL,postcontext])}}if(!empty){patches.splice(++x,0,patch)}}}};diff_match_patch.prototype.patch_toText=function(patches){var text=[];for(var x=0;x<patches.length;x++){text[x]=patches[x]}return text.join("")};diff_match_patch.prototype.patch_fromText=function(textline){var patches=[];if(!textline){return patches}var text=textline.split("\n");var textPointer=0;var patchHeader=/^@@ -(\d+),?(\d*) \+(\d+),?(\d*) @@$/;while(textPointer<text.length){var m=text[textPointer].match(patchHeader);if(!m){throw new Error("Invalid patch string: "+text[textPointer])}var patch=new diff_match_patch.patch_obj;patches.push(patch);patch.start1=parseInt(m[1],10);if(m[2]===""){patch.start1--;patch.length1=1}else if(m[2]=="0"){patch.length1=0}else{patch.start1--;patch.length1=parseInt(m[2],10)}patch.start2=parseInt(m[3],10);if(m[4]===""){patch.start2--;patch.length2=1}else if(m[4]=="0"){patch.length2=0}else{patch.start2--;patch.length2=parseInt(m[4],10)}textPointer++;while(textPointer<text.length){var sign=text[textPointer].charAt(0);try{var line=decodeURI(text[textPointer].substring(1))}catch(ex){throw new Error("Illegal escape in patch_fromText: "+line)}if(sign=="-"){patch.diffs.push([DIFF_DELETE,line])}else if(sign=="+"){patch.diffs.push([DIFF_INSERT,line])}else if(sign==" "){patch.diffs.push([DIFF_EQUAL,line])}else if(sign=="@"){break}else if(sign===""){}else{throw new Error('Invalid patch mode "'+sign+'" in: '+line)}textPointer++}}return patches};diff_match_patch.patch_obj=function(){this.diffs=[];this.start1=null;this.start2=null;this.length1=0;this.length2=0};diff_match_patch.patch_obj.prototype.toString=function(){var coords1,coords2;if(this.length1===0){coords1=this.start1+",0"}else if(this.length1==1){coords1=this.start1+1}else{coords1=this.start1+1+","+this.length1}if(this.length2===0){coords2=this.start2+",0"}else if(this.length2==1){coords2=this.start2+1}else{coords2=this.start2+1+","+this.length2}var text=["@@ -"+coords1+" +"+coords2+" @@\n"];var op;for(var x=0;x<this.diffs.length;x++){switch(this.diffs[x][0]){case DIFF_INSERT:op="+";break;case DIFF_DELETE:op="-";break;case DIFF_EQUAL:op=" ";break}text[x+1]=op+encodeURI(this.diffs[x][1])+"\n"}return text.join("").replace(/%20/g," ")};this["diff_match_patch"]=diff_match_patch;this["DIFF_DELETE"]=DIFF_DELETE;this["DIFF_INSERT"]=DIFF_INSERT;this["DIFF_EQUAL"]=DIFF_EQUAL;browserify_shim__define__module__export__(typeof diff_match_patch!="undefined"?diff_match_patch:window.diff_match_patch)}).call(global,undefined,undefined,undefined,undefined,function defineExport(ex){module.exports=ex})}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],24:[function(require,module,exports){(function(global){var __browserify_shim_require__=require;(function browserifyShim(module,exports,require,define,browserify_shim__define__module__export__){(function(){var __bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__slice=[].slice,__indexOf=[].indexOf||function(item){for(var i=0,l=this.length;i<l;i++){if(i in this&&this[i]===item)return i}return-1};window.DomTextMapper=function(){var CONTEXT_LEN,SELECT_CHILDREN_INSTEAD,USE_EMPTY_TEXT_WORKAROUND,USE_TABLE_TEXT_WORKAROUND,WHITESPACE,WHITESPACE_REGEX;DomTextMapper.applicable=function(){return true};USE_TABLE_TEXT_WORKAROUND=true;USE_EMPTY_TEXT_WORKAROUND=true;SELECT_CHILDREN_INSTEAD=["thead","tbody","tfoot","ol","a","caption","p","span","div","h1","h2","h3","h4","h5","h6","ul","li","form"];CONTEXT_LEN=32;WHITESPACE_REGEX=/\s+/g;DomTextMapper.instances=0;function DomTextMapper(id){this.id=id;this.destroy=__bind(this.destroy,this);this._onChange=__bind(this._onChange,this);this.setRealRoot();DomTextMapper.instances+=1;if(this.id==null){this.id="d-t-m #"+DomTextMapper.instances}}DomTextMapper.prototype.log=function(){var msg;msg=1<=arguments.length?__slice.call(arguments,0):[]};DomTextMapper.prototype._onChange=function(event){this.documentChanged();this.performUpdateOnNode(event.target,false,event.data);return this.lastScanned=this.timestamp()};DomTextMapper.prototype._changeRootNode=function(node){var _ref;if((_ref=this.rootNode)!=null){_ref.removeEventListener("domChange",this._onChange)}this.rootNode=node;this.rootNode.addEventListener("domChange",this._onChange);return node};DomTextMapper.prototype.setRootNode=function(rootNode){this.rootWin=window;return this.pathStartNode=this._changeRootNode(rootNode)};DomTextMapper.prototype.setRootId=function(rootId){return this.setRootNode(document.getElementById(rootId))};DomTextMapper.prototype.setRootIframe=function(iframeId){var iframe;iframe=window.document.getElementById(iframeId);if(iframe==null){throw new Error("Can't find iframe with specified ID!")}this.rootWin=iframe.contentWindow;if(this.rootWin==null){throw new Error("Can't access contents of the specified iframe!")}this._changeRootNode(this.rootWin.document);return this.pathStartNode=this.getBody()};DomTextMapper.prototype.getDefaultPath=function(){return this.getPathTo(this.pathStartNode)};DomTextMapper.prototype.setRealRoot=function(){this.rootWin=window;this._changeRootNode(document);return this.pathStartNode=this.getBody()};DomTextMapper.prototype.documentChanged=function(){return this.lastDOMChange=this.timestamp()};DomTextMapper.prototype.setExpectedContent=function(content){return this.expectedContent=content};DomTextMapper.prototype.scan=function(){var node,path,startTime,t1,t2;if(this.domStableSince(this.lastScanned)){return}else{}if(!this.pathStartNode.ownerDocument.body.contains(this.pathStartNode)){return}this.documentChanged();startTime=this.timestamp();this.saveSelection();this.path={};this.traverseSubTree(this.pathStartNode,this.getDefaultPath());t1=this.timestamp();path=this.getPathTo(this.pathStartNode);node=this.path[path].node;this.collectPositions(node,path,null,0,0);this.restoreSelection();this.lastScanned=this.timestamp();this._corpus=this.path[path].content;t2=this.timestamp();return null};DomTextMapper.prototype.selectPath=function(path,scroll){var info,node;if(scroll==null){scroll=false}info=this.path[path];if(info==null){throw new Error("I have no info about a node at "+path)}node=info!=null?info.node:void 0;node||(node=this.lookUpNode(info.path));return this.selectNode(node,scroll)};DomTextMapper.prototype.performUpdateOnNode=function(node,escalating){var data,oldIndex,p,parentNode,parentPath,parentPathInfo,path,pathInfo,pathsToDrop,prefix,startTime,_i,_len,_ref;if(escalating==null){escalating=false}if(node==null){throw new Error("Called performUpdate with a null node!")}if(this.path==null){return}startTime=this.timestamp();if(!escalating){this.saveSelection()}path=this.getPathTo(node);pathInfo=this.path[path];if(pathInfo==null){this.performUpdateOnNode(node.parentNode,true);if(!escalating){this.restoreSelection()}return}if(pathInfo.node===node&&pathInfo.content===this.getNodeContent(node,false)){prefix=path+"/";pathsToDrop=p;pathsToDrop=[];_ref=this.path;for(p in _ref){data=_ref[p];if(this.stringStartsWith(p,prefix)){pathsToDrop.push(p)}}for(_i=0,_len=pathsToDrop.length;_i<_len;_i++){p=pathsToDrop[_i];delete this.path[p]}this.traverseSubTree(node,path);if(pathInfo.node===this.pathStartNode){this.collectPositions(node,path,null,0,0)}else{parentPath=this.parentPath(path);parentPathInfo=this.path[parentPath];if(parentPathInfo==null){throw new Error("While performing update on node "+path+", no path info found for parent path: "+parentPath)}oldIndex=node===node.parentNode.firstChild?0:this.path[this.getPathTo(node.previousSibling)].end-parentPathInfo.start;this.collectPositions(node,path,parentPathInfo.content,parentPathInfo.start,oldIndex)}}else{if(pathInfo.node!==this.pathStartNode){parentNode=node.parentNode!=null?node.parentNode:(parentPath=this.parentPath(path),this.lookUpNode(parentPath));this.performUpdateOnNode(parentNode,true)}else{throw new Error("Can not keep up with the changes, since even the node configured as path start node was replaced.")}}if(!escalating){return this.restoreSelection()}};DomTextMapper.prototype.getInfoForPath=function(path){var result;if(this.path==null){throw new Error("Can't get info before running a scan() !")}result=this.path[path];if(result==null){throw new Error("Found no info for path '"+path+"'!")}return result};DomTextMapper.prototype.getStartPosForPath=function(path){var info,_ref;info=this.getInfoForPath(path);return(_ref=info.start)!=null?_ref:this.getFirstPosAfter(info.node)};DomTextMapper.prototype.getFirstPosAfter=function(node){var info,path,_ref;if(node.nextSibling!=null){node=node.nextSibling;path=this.getPathTo(node);info=this.path[path];return(_ref=info.start)!=null?_ref:this.getFirstPosAfter(node)}else{return this.getFirstPosAfter(node.parentNode)}};DomTextMapper.prototype.getEndPosForPath=function(path){var info,_ref;info=this.getInfoForPath(path);return(_ref=info.end)!=null?_ref:this.getFirstPosBefore(info.node)};DomTextMapper.prototype.getFirstPosBefore=function(node){var info,path,_ref;if(node.previousSibling!=null){node=node.previousSibling;path=this.getPathTo(node);info=this.path[path];return(_ref=info.end)!=null?_ref:this.getFirstPosBefore(node)}else{return this.getFirstPosBefore(node.parentNode)}};DomTextMapper.prototype.getInfoForNode=function(node){if(node==null){throw new Error("Called getInfoForNode(node) with null node!")}return this.getInfoForPath(this.getPathTo(node))};DomTextMapper.prototype.getStartPosForNode=function(node){if(node==null){throw new Error("Called getStartInfoForNode(node) with null node!")}return this.getStartPosForPath(this.getPathTo(node))};DomTextMapper.prototype.getEndPosForNode=function(node){if(node==null){throw new Error("Called getInfoForNode(node) with null node!")}return this.getEndPosForPath(this.getPathTo(node))};DomTextMapper.prototype.getMappingsForCharRanges=function(charRanges){var charRange,_i,_len,_results;_results=[];for(_i=0,_len=charRanges.length;_i<_len;_i++){charRange=charRanges[_i];_results.push(this.getMappingsForCharRange(charRange.start,charRange.end))}return _results};DomTextMapper.prototype.getContentForPath=function(path){if(path==null){path=null}if(path==null){path=this.getDefaultPath()}return this.path[path].content};DomTextMapper.prototype.getLengthForPath=function(path){if(path==null){path=null}if(path==null){path=this.getDefaultPath()}return this.path[path].length};DomTextMapper.prototype.getDocLength=function(){return this._corpus.length};DomTextMapper.prototype.getCorpus=function(){return this._corpus};DomTextMapper.prototype.getContextForCharRange=function(start,end){var prefix,prefixStart,suffix;if(start<0){throw Error("Negative range start is invalid!")}if(end>this._corpus.length){throw Error("Range end is after the end of corpus!")}prefixStart=Math.max(0,start-CONTEXT_LEN);prefix=this._corpus.slice(prefixStart,start);suffix=this._corpus.slice(end,end+CONTEXT_LEN);return[prefix.trim(),suffix.trim()]};DomTextMapper.prototype.getMappingsForCharRange=function(start,end){var endInfo,endMapping,endNode,endOffset,endPath,info,mappings,p,r,result,startInfo,startMapping,startNode,startOffset,startPath,_ref;if(!(start!=null&&end!=null)){throw new Error("start and end is required!")}this.scan();mappings=[];_ref=this.path;for(p in _ref){info=_ref[p];if(info.atomic&&this.regions_overlap(info.start,info.end,start,end)){(function(_this){return function(info){var full,mapping;mapping={element:info};full=start<=info.start&&info.end<=end;if(full){mapping.full=true;mapping.wanted=info.content;mapping.yields=info.content;mapping.startCorrected=0;mapping.endCorrected=0}else{if(info.node.nodeType===Node.TEXT_NODE){if(start<=info.start){mapping.end=end-info.start;mapping.wanted=info.content.substr(0,mapping.end)}else if(info.end<=end){mapping.start=start-info.start;mapping.wanted=info.content.substr(mapping.start)}else{mapping.start=start-info.start;mapping.end=end-info.start;mapping.wanted=info.content.substr(mapping.start,mapping.end-mapping.start)}_this.computeSourcePositions(mapping);mapping.yields=info.node.data.substr(mapping.startCorrected,mapping.endCorrected-mapping.startCorrected)}else if(info.node.nodeType===Node.ELEMENT_NODE&&info.node.tagName.toLowerCase()==="img"){_this.log("Can not select a sub-string from the title of an image. Selecting all.");mapping.full=true;mapping.wanted=info.content}else{_this.log("Warning: no idea how to handle partial mappings for node type "+info.node.nodeType);if(info.node.tagName!=null){_this.log("Tag: "+info.node.tagName)}_this.log("Selecting all.");mapping.full=true;mapping.wanted=info.content}}return mappings.push(mapping)}})(this)(info)}}if(mappings.length===0){this.log("Collecting nodes for ["+start+":"+end+"]");this.log("Should be: '"+this._corpus.slice(start,end)+"'.");throw new Error("No mappings found for ["+start+":"+end+"]!")}mappings=mappings.sort(function(a,b){return a.element.start-b.element.start});r=this.rootWin.document.createRange();startMapping=mappings[0];startNode=startMapping.element.node;startPath=startMapping.element.path;startOffset=startMapping.startCorrected;if(startMapping.full){r.setStartBefore(startNode);startInfo=startPath}else{r.setStart(startNode,startOffset);startInfo=startPath+":"+startOffset}endMapping=mappings[mappings.length-1];endNode=endMapping.element.node;endPath=endMapping.element.path;endOffset=endMapping.endCorrected;if(endMapping.full){r.setEndAfter(endNode);endInfo=endPath}else{r.setEnd(endNode,endOffset);endInfo=endPath+":"+endOffset}result={mappings:mappings,realRange:r,rangeInfo:{startPath:startPath,startOffset:startOffset,startInfo:startInfo,endPath:endPath,endOffset:endOffset,endInfo:endInfo},safeParent:r.commonAncestorContainer};return{sections:[result]}};DomTextMapper.prototype.timestamp=function(){return(new Date).getTime()};DomTextMapper.prototype.stringStartsWith=function(string,prefix){if(!prefix){throw Error("Requires a non-empty prefix!")}return string.slice(0,prefix.length)===prefix};DomTextMapper.prototype.stringEndsWith=function(string,suffix){if(!suffix){throw Error("Requires a non-empty suffix!")}return string.slice(string.length-suffix.length,string.length)===suffix};DomTextMapper.prototype.parentPath=function(path){return path.substr(0,path.lastIndexOf("/"))};DomTextMapper.prototype.domChangedSince=function(timestamp){if(this.lastDOMChange!=null&&timestamp!=null){return this.lastDOMChange>timestamp}else{return true}};DomTextMapper.prototype.domStableSince=function(timestamp){return!this.domChangedSince(timestamp)};DomTextMapper.prototype.getProperNodeName=function(node){var nodeName;nodeName=node.nodeName;switch(nodeName){case"#text":return"text()";case"#comment":return"comment()";case"#cdata-section":return"cdata-section()";default:return nodeName}};DomTextMapper.prototype.getNodePosition=function(node){var pos,tmp;pos=0;tmp=node;while(tmp){if(tmp.nodeName===node.nodeName){pos++}tmp=tmp.previousSibling}return pos};DomTextMapper.prototype.getPathSegment=function(node){var name,pos;name=this.getProperNodeName(node);pos=this.getNodePosition(node);return name+(pos>1?"["+pos+"]":"")};DomTextMapper.prototype.getPathTo=function(node){var xpath;xpath="";while(node!==this.rootNode){if(node==null){throw new Error("Called getPathTo on a node which was not a descendant of @rootNode. "+this.rootNode)}xpath=this.getPathSegment(node)+"/"+xpath;node=node.parentNode}xpath=(this.rootNode.ownerDocument!=null?"./":"/")+xpath;xpath=xpath.replace(/\/$/,"");return xpath};DomTextMapper.prototype.traverseSubTree=function(node,path,invisible,verbose){var child,cont,subpath,_i,_len,_ref;if(invisible==null){invisible=false}if(verbose==null){verbose=false}this.underTraverse=path;cont=this.getNodeContent(node,false);this.path[path]={path:path,content:cont,length:cont.length,node:node};if(cont.length){if(verbose){this.log("Collected info about path "+path)}if(invisible){throw new Error("Failed to scan document: got inconsistent data from selection API.")}}else{if(verbose){this.log("Found no content at path "+path)}invisible=true}if(node.hasChildNodes()){_ref=node.childNodes;for(_i=0,_len=_ref.length;_i<_len;_i++){child=_ref[_i];subpath=path+"/"+this.getPathSegment(child);this.traverseSubTree(child,subpath,invisible,verbose)}}return null};DomTextMapper.prototype.getBody=function(){return this.rootWin.document.getElementsByTagName("body")[0]};DomTextMapper.prototype.regions_overlap=function(start1,end1,start2,end2){return start1<end2&&start2<end1};DomTextMapper.prototype.lookUpNode=function(path){var doc,node,results,_ref;doc=(_ref=this.rootNode.ownerDocument)!=null?_ref:this.rootNode;results=doc.evaluate(path,this.rootNode,null,0,null);return node=results.iterateNext()};DomTextMapper.prototype.saveSelection=function(){var i,sel;if(this.savedSelection!=null){this.log("Selection saved at:");this.log(this.selectionSaved);throw new Error("Selection already saved!")}sel=this.rootWin.getSelection();this.savedSelection=function(){var _i,_ref,_results;_results=[];for(i=_i=0,_ref=sel.rangeCount;0<=_ref?_i<_ref:_i>_ref;i=0<=_ref?++_i:--_i){_results.push(sel.getRangeAt(i))}return _results}();return this.selectionSaved=new Error("selection was saved here").stack};DomTextMapper.prototype.restoreSelection=function(){var range,sel,_i,_len,_ref;if(this.savedSelection==null){throw new Error("No selection to restore.")}sel=this.rootWin.getSelection();sel.removeAllRanges();_ref=this.savedSelection;for(_i=0,_len=_ref.length;_i<_len;_i++){range=_ref[_i];sel.addRange(range)}return delete this.savedSelection};DomTextMapper.prototype.selectNode=function(node,scroll){var children,exception,realRange,sel,sn,_ref;if(scroll==null){scroll=false}if(node==null){throw new Error("Called selectNode with null node!")}sel=this.rootWin.getSelection();sel.removeAllRanges();realRange=this.rootWin.document.createRange();if(node.nodeType===Node.ELEMENT_NODE&&node.hasChildNodes()&&(_ref=node.tagName.toLowerCase(),__indexOf.call(SELECT_CHILDREN_INSTEAD,_ref)>=0)){children=node.childNodes;realRange.setStartBefore(children[0]);realRange.setEndAfter(children[children.length-1]);sel.addRange(realRange)}else{if(USE_TABLE_TEXT_WORKAROUND&&node.nodeType===Node.TEXT_NODE&&node.parentNode.tagName.toLowerCase()==="table"){}else{try{realRange.setStartBefore(node);realRange.setEndAfter(node);sel.addRange(realRange)}catch(_error){exception=_error;if(!(USE_EMPTY_TEXT_WORKAROUND&&this.isWhitespace(node))){this.log("Warning: failed to scan element @ "+this.underTraverse);this.log("Content is: "+node.innerHTML);this.log("We won't be able to properly anchor to any text inside this element.")}}}}if(scroll){sn=node;while(sn!=null&&sn.scrollIntoViewIfNeeded==null){sn=sn.parentNode}if(sn!=null){sn.scrollIntoViewIfNeeded()}else{this.log("Failed to scroll to element. (Browser does not support scrollIntoViewIfNeeded?)")}}return sel};DomTextMapper.prototype.readSelectionText=function(sel){sel||(sel=this.rootWin.getSelection());return sel.toString().trim().replace(WHITESPACE_REGEX," ")};DomTextMapper.prototype.getNodeSelectionText=function(node,shouldRestoreSelection){var sel,text;if(shouldRestoreSelection==null){shouldRestoreSelection=true}if(shouldRestoreSelection){this.saveSelection()}sel=this.selectNode(node);text=this.readSelectionText(sel);if(shouldRestoreSelection){this.restoreSelection()}return text};DomTextMapper.prototype.computeSourcePositions=function(match){var dc,displayEnd,displayIndex,displayStart,displayText,sc,sourceEnd,sourceIndex,sourceStart,sourceText;sourceText=match.element.node.data.replace(WHITESPACE_REGEX," ");displayText=match.element.content.replace(WHITESPACE_REGEX," ");displayStart=match.start!=null?match.start:0;displayEnd=match.end!=null?match.end:displayText.length;if(displayEnd===0){match.startCorrected=0;match.endCorrected=0;return}sourceIndex=0;displayIndex=0;while(!(sourceStart!=null&&sourceEnd!=null)){sc=sourceText[sourceIndex];dc=displayText[displayIndex];if(sc===dc){if(displayIndex===displayStart){sourceStart=sourceIndex}displayIndex++;if(displayIndex===displayEnd){sourceEnd=sourceIndex+1}}else if(sc==null||dc==null){throw new Error("display and source text mismatch: '"+sourceText+"' vs. '"+displayText+"'")}sourceIndex++}match.startCorrected=sourceStart;match.endCorrected=sourceEnd;return null};DomTextMapper.prototype.getNodeContent=function(node,shouldRestoreSelection){if(shouldRestoreSelection==null){shouldRestoreSelection=true;
}if(node===this.pathStartNode&&this.expectedContent!=null){return this.expectedContent}else{return this.getNodeSelectionText(node,shouldRestoreSelection)}};DomTextMapper.prototype.collectPositions=function(node,path,parentContent,parentIndex,index){var atomic,child,childPath,children,content,endIndex,i,newCount,nodeName,oldCount,pathInfo,pos,startIndex,typeCount;if(parentContent==null){parentContent=null}if(parentIndex==null){parentIndex=0}if(index==null){index=0}pathInfo=this.path[path];content=pathInfo!=null?pathInfo.content:void 0;if(!content){pathInfo.start=parentIndex+index;pathInfo.end=parentIndex+index;pathInfo.atomic=false;return index}startIndex=parentContent!=null?parentContent.indexOf(content,index):index;if(startIndex===-1){this.log("Content of this not is not present in content of parent, at path "+path);this.log("(Content: '"+content+"'.)");return index}endIndex=startIndex+content.length;atomic=!node.hasChildNodes();pathInfo.start=parentIndex+startIndex;pathInfo.end=parentIndex+endIndex;pathInfo.atomic=atomic;if(!atomic){children=node.childNodes;i=0;pos=0;typeCount=Object();while(i<children.length){child=children[i];nodeName=this.getProperNodeName(child);oldCount=typeCount[nodeName];newCount=oldCount!=null?oldCount+1:1;typeCount[nodeName]=newCount;childPath=path+"/"+nodeName+(newCount>1?"["+newCount+"]":"");pos=this.collectPositions(child,childPath,content,parentIndex+startIndex,pos);i++}}return endIndex};WHITESPACE=/^\s*$/;DomTextMapper.prototype.isWhitespace=function(node){var child,mightBeEmpty,result;result=function(){var _i,_len,_ref;switch(node.nodeType){case Node.TEXT_NODE:return WHITESPACE.test(node.data);case Node.ELEMENT_NODE:mightBeEmpty=true;_ref=node.childNodes;for(_i=0,_len=_ref.length;_i<_len;_i++){child=_ref[_i];mightBeEmpty=mightBeEmpty&&this.isWhitespace(child)}return mightBeEmpty;default:return false}}.call(this);return result};DomTextMapper.prototype._testMap=function(){var expected,i,ok,p,_ref,_ref1;this.log("Verifying map info: was it all properly traversed?");_ref=this.path;for(i in _ref){p=_ref[i];if(p.atomic==null){this.log(i+" is missing data.")}}this.log("Verifying map info: do atomic elements match?");_ref1=this.path;for(i in _ref1){p=_ref1[i];if(!p.atomic){continue}expected=this._corpus.slice(p.start,p.end);ok=p.content===expected;if(!ok){this.log("Mismatch on "+i+": content is '"+p.content+"', range in corpus is '"+expected+"'.")}ok}return null};DomTextMapper.prototype.destroy=function(){var sel;if(this.savedSelection){this.restoreSelection()}else{sel=this.rootWin.getSelection();sel.removeAllRanges()}return delete this.path};DomTextMapper.prototype.getPageIndex=function(){return 0};DomTextMapper.prototype.getPageCount=function(){return 1};DomTextMapper.prototype.getPageIndexForPos=function(){return 0};DomTextMapper.prototype.isPageMapped=function(){return true};return DomTextMapper}()}).call(this);browserify_shim__define__module__export__(typeof DomTextMapper!="undefined"?DomTextMapper:window.DomTextMapper)}).call(global,undefined,undefined,undefined,undefined,function defineExport(ex){module.exports=ex})}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],25:[function(require,module,exports){(function(global){var __browserify_shim_require__=require;(function browserifyShim(module,exports,require,define,browserify_shim__define__module__export__){(function(){window.DomTextMatcher=function(){function DomTextMatcher(corpus){this.corpus=corpus}DomTextMatcher.prototype.searchExact=function(pattern,distinct,caseSensitive){if(distinct==null){distinct=true}if(caseSensitive==null){caseSensitive=false}if(!this.pm){this.pm=new window.DTM_ExactMatcher}this.pm.setDistinct(distinct);this.pm.setCaseSensitive(caseSensitive);return this._search(this.pm,pattern)};DomTextMatcher.prototype.searchRegex=function(pattern,caseSensitive){if(caseSensitive==null){caseSensitive=false}if(!this.rm){this.rm=new window.DTM_RegexMatcher}this.rm.setCaseSensitive(caseSensitive);return this._search(this.rm,pattern)};DomTextMatcher.prototype.searchFuzzy=function(pattern,pos,caseSensitive,options){var _ref,_ref1;if(caseSensitive==null){caseSensitive=false}if(options==null){options={}}this.ensureDMP();this.dmp.setMatchDistance((_ref=options.matchDistance)!=null?_ref:1e3);this.dmp.setMatchThreshold((_ref1=options.matchThreshold)!=null?_ref1:.5);this.dmp.setCaseSensitive(caseSensitive);return this._search(this.dmp,pattern,pos,options)};DomTextMatcher.prototype.searchFuzzyWithContext=function(prefix,suffix,pattern,expectedStart,expectedEnd,caseSensitive,options){var a1,a2,analysis,bestError,candidate,charRange,expectedPrefixStart,expectedSuffixStart,flexMatch,flexMatches,flexRange,i,k,len,match,matchThreshold,obj,patternLength,prefixEnd,prefixError,prefixRange,prefixResult,prefixStart,remainingText,suffixEnd,suffixError,suffixRange,suffixResult,suffixStart,totalError,v,_i,_j,_len,_len1,_ref,_ref1,_ref2,_ref3;if(expectedStart==null){expectedStart=null}if(expectedEnd==null){expectedEnd=null}if(caseSensitive==null){caseSensitive=false}if(options==null){options={}}this.ensureDMP();if(!(prefix!=null&&suffix!=null)){throw new Error("Can not do a context-based fuzzy search with missing context!")}len=this.corpus().length;expectedPrefixStart=expectedStart!=null?(i=expectedStart-prefix.length,i<0?0:i):Math.floor(len/2);this.dmp.setMatchDistance((_ref=options.contextMatchDistance)!=null?_ref:len*2);this.dmp.setMatchThreshold((_ref1=options.contextMatchThreshold)!=null?_ref1:.5);prefixResult=this.dmp.search(this.corpus(),prefix,expectedPrefixStart);if(!prefixResult.length){return{matches:[]}}prefixStart=prefixResult[0].start;prefixEnd=prefixResult[0].end;patternLength=pattern!=null?pattern.length:expectedStart!=null&&expectedEnd!=null?expectedEnd-expectedStart:64;remainingText=this.corpus().substr(prefixEnd);expectedSuffixStart=patternLength;suffixResult=this.dmp.search(remainingText,suffix,expectedSuffixStart);if(!suffixResult.length){return{matches:[]}}suffixStart=prefixEnd+suffixResult[0].start;suffixEnd=prefixEnd+suffixResult[0].end;charRange={start:prefixEnd,end:suffixStart};matchThreshold=(_ref2=options.patternMatchThreshold)!=null?_ref2:.5;analysis=this._analyzeMatch(pattern,charRange,true);if(pattern!=null&&options.flexContext&&!analysis.exact){if(!this.pm){this.pm=new window.DTM_ExactMatcher}this.pm.setDistinct(false);this.pm.setCaseSensitive(false);flexMatches=this.pm.search(this.corpus().slice(prefixStart,+suffixEnd+1||9e9),pattern);delete candidate;bestError=2;for(_i=0,_len=flexMatches.length;_i<_len;_i++){flexMatch=flexMatches[_i];flexRange={start:prefixStart+flexMatch.start,end:prefixStart+flexMatch.end};prefixRange={start:prefixStart,end:flexRange.start};a1=this._analyzeMatch(prefix,prefixRange,true);prefixError=a1.exact?0:a1.comparison.errorLevel;suffixRange={start:flexRange.end,end:suffixEnd};a2=this._analyzeMatch(suffix,suffixRange,true);suffixError=a2.exact?0:a2.comparison.errorLevel;if(a1.exact||a2.exact){totalError=prefixError+suffixError;if(totalError<bestError){candidate=flexRange;bestError=totalError}}}if(candidate!=null){console.log("flexContext adjustment: we found a better candidate!");charRange=candidate;analysis=this._analyzeMatch(pattern,charRange,true)}}if(pattern==null||analysis.exact||analysis.comparison.errorLevel<=matchThreshold){match={};_ref3=[charRange,analysis];for(_j=0,_len1=_ref3.length;_j<_len1;_j++){obj=_ref3[_j];for(k in obj){v=obj[k];match[k]=v}}return{matches:[match]}}return{matches:[]}};DomTextMatcher.prototype._normalizeString=function(string){return string.replace(/\s{2,}/g," ").trim()};DomTextMatcher.prototype._search=function(matcher,pattern,pos,options){var fuzzyComparison,matches,result,t1,t2,t3,textMatch,textMatches,_fn,_i,_len,_ref;if(options==null){options={}}if(pattern==null){throw new Error("Can't search for null pattern!")}pattern=pattern.trim();if(pattern==null){throw new Error("Can't search an for empty pattern!")}fuzzyComparison=(_ref=options.withFuzzyComparison)!=null?_ref:false;t1=this.timestamp();textMatches=matcher.search(this.corpus(),pattern,pos,options);t2=this.timestamp();matches=[];_fn=function(_this){return function(textMatch){var analysis,k,match,obj,v,_j,_len1,_ref1;analysis=_this._analyzeMatch(pattern,textMatch,fuzzyComparison);match={};_ref1=[textMatch,analysis];for(_j=0,_len1=_ref1.length;_j<_len1;_j++){obj=_ref1[_j];for(k in obj){v=obj[k];match[k]=v}}matches.push(match);return null}}(this);for(_i=0,_len=textMatches.length;_i<_len;_i++){textMatch=textMatches[_i];_fn(textMatch)}t3=this.timestamp();result={matches:matches,time:{phase1_textMatching:t2-t1,phase2_matchMapping:t3-t2,total:t3-t1}};return result};DomTextMatcher.prototype.timestamp=function(){return(new Date).getTime()};DomTextMatcher.prototype._analyzeMatch=function(pattern,charRange,useFuzzy){var expected,found,result;if(useFuzzy==null){useFuzzy=false}expected=this._normalizeString(pattern);found=this._normalizeString(this.corpus().slice(charRange.start,+(charRange.end-1)+1||9e9));result={found:found,exact:found===expected};if(!result.exact){result.exactExceptCase=expected.toLowerCase()===found.toLowerCase()}if(!result.exact&&useFuzzy){this.ensureDMP();result.comparison=this.dmp.compare(expected,found)}return result};DomTextMatcher.prototype.ensureDMP=function(){if(this.dmp==null){if(window.DTM_DMPMatcher==null){throw new Error("DTM_DMPMatcher is not available. Have you loaded the text match engines?")}return this.dmp=new window.DTM_DMPMatcher}};return DomTextMatcher}()}).call(this);browserify_shim__define__module__export__(typeof DomTextMatcher!="undefined"?DomTextMatcher:window.DomTextMatcher)}).call(global,undefined,undefined,undefined,undefined,function defineExport(ex){module.exports=ex})}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],26:[function(require,module,exports){(function(global){var __browserify_shim_require__=require;(function browserifyShim(module,exports,require,define,browserify_shim__define__module__export__){(function(global,factory){if(typeof module==="object"&&typeof module.exports==="object"){module.exports=global.document?factory(global,true):function(w){if(!w.document){throw new Error("jQuery requires a window with a document")}return factory(w)}}else{factory(global)}})(typeof window!=="undefined"?window:this,function(window,noGlobal){var deletedIds=[];var slice=deletedIds.slice;var concat=deletedIds.concat;var push=deletedIds.push;var indexOf=deletedIds.indexOf;var class2type={};var toString=class2type.toString;var hasOwn=class2type.hasOwnProperty;var support={};var version="1.11.1",jQuery=function(selector,context){return new jQuery.fn.init(selector,context)},rtrim=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,rmsPrefix=/^-ms-/,rdashAlpha=/-([\da-z])/gi,fcamelCase=function(all,letter){return letter.toUpperCase()};jQuery.fn=jQuery.prototype={jquery:version,constructor:jQuery,selector:"",length:0,toArray:function(){return slice.call(this)},get:function(num){return num!=null?num<0?this[num+this.length]:this[num]:slice.call(this)},pushStack:function(elems){var ret=jQuery.merge(this.constructor(),elems);ret.prevObject=this;ret.context=this.context;return ret},each:function(callback,args){return jQuery.each(this,callback,args)},map:function(callback){return this.pushStack(jQuery.map(this,function(elem,i){return callback.call(elem,i,elem)}))},slice:function(){return this.pushStack(slice.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(i){var len=this.length,j=+i+(i<0?len:0);return this.pushStack(j>=0&&j<len?[this[j]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:push,sort:deletedIds.sort,splice:deletedIds.splice};jQuery.extend=jQuery.fn.extend=function(){var src,copyIsArray,copy,name,options,clone,target=arguments[0]||{},i=1,length=arguments.length,deep=false;if(typeof target==="boolean"){deep=target;target=arguments[i]||{};i++}if(typeof target!=="object"&&!jQuery.isFunction(target)){target={}}if(i===length){target=this;i--}for(;i<length;i++){if((options=arguments[i])!=null){for(name in options){src=target[name];copy=options[name];if(target===copy){continue}if(deep&&copy&&(jQuery.isPlainObject(copy)||(copyIsArray=jQuery.isArray(copy)))){if(copyIsArray){copyIsArray=false;clone=src&&jQuery.isArray(src)?src:[]}else{clone=src&&jQuery.isPlainObject(src)?src:{}}target[name]=jQuery.extend(deep,clone,copy)}else if(copy!==undefined){target[name]=copy}}}}return target};jQuery.extend({expando:"jQuery"+(version+Math.random()).replace(/\D/g,""),isReady:true,error:function(msg){throw new Error(msg)},noop:function(){},isFunction:function(obj){return jQuery.type(obj)==="function"},isArray:Array.isArray||function(obj){return jQuery.type(obj)==="array"},isWindow:function(obj){return obj!=null&&obj==obj.window},isNumeric:function(obj){return!jQuery.isArray(obj)&&obj-parseFloat(obj)>=0},isEmptyObject:function(obj){var name;for(name in obj){return false}return true},isPlainObject:function(obj){var key;if(!obj||jQuery.type(obj)!=="object"||obj.nodeType||jQuery.isWindow(obj)){return false}try{if(obj.constructor&&!hasOwn.call(obj,"constructor")&&!hasOwn.call(obj.constructor.prototype,"isPrototypeOf")){return false}}catch(e){return false}if(support.ownLast){for(key in obj){return hasOwn.call(obj,key)}}for(key in obj){}return key===undefined||hasOwn.call(obj,key)},type:function(obj){if(obj==null){return obj+""}return typeof obj==="object"||typeof obj==="function"?class2type[toString.call(obj)]||"object":typeof obj},globalEval:function(data){if(data&&jQuery.trim(data)){(window.execScript||function(data){window["eval"].call(window,data)})(data)}},camelCase:function(string){return string.replace(rmsPrefix,"ms-").replace(rdashAlpha,fcamelCase)},nodeName:function(elem,name){return elem.nodeName&&elem.nodeName.toLowerCase()===name.toLowerCase()},each:function(obj,callback,args){var value,i=0,length=obj.length,isArray=isArraylike(obj);if(args){if(isArray){for(;i<length;i++){value=callback.apply(obj[i],args);if(value===false){break}}}else{for(i in obj){value=callback.apply(obj[i],args);if(value===false){break}}}}else{if(isArray){for(;i<length;i++){value=callback.call(obj[i],i,obj[i]);if(value===false){break}}}else{for(i in obj){value=callback.call(obj[i],i,obj[i]);if(value===false){break}}}}return obj},trim:function(text){return text==null?"":(text+"").replace(rtrim,"")},makeArray:function(arr,results){var ret=results||[];if(arr!=null){if(isArraylike(Object(arr))){jQuery.merge(ret,typeof arr==="string"?[arr]:arr)}else{push.call(ret,arr)}}return ret},inArray:function(elem,arr,i){var len;if(arr){if(indexOf){return indexOf.call(arr,elem,i)}len=arr.length;i=i?i<0?Math.max(0,len+i):i:0;for(;i<len;i++){if(i in arr&&arr[i]===elem){return i}}}return-1},merge:function(first,second){var len=+second.length,j=0,i=first.length;while(j<len){first[i++]=second[j++]}if(len!==len){while(second[j]!==undefined){first[i++]=second[j++]}}first.length=i;return first},grep:function(elems,callback,invert){var callbackInverse,matches=[],i=0,length=elems.length,callbackExpect=!invert;for(;i<length;i++){callbackInverse=!callback(elems[i],i);if(callbackInverse!==callbackExpect){matches.push(elems[i])}}return matches},map:function(elems,callback,arg){var value,i=0,length=elems.length,isArray=isArraylike(elems),ret=[];if(isArray){for(;i<length;i++){value=callback(elems[i],i,arg);if(value!=null){ret.push(value)}}}else{for(i in elems){value=callback(elems[i],i,arg);if(value!=null){ret.push(value)}}}return concat.apply([],ret)},guid:1,proxy:function(fn,context){var args,proxy,tmp;if(typeof context==="string"){tmp=fn[context];context=fn;fn=tmp}if(!jQuery.isFunction(fn)){return undefined}args=slice.call(arguments,2);proxy=function(){return fn.apply(context||this,args.concat(slice.call(arguments)))};proxy.guid=fn.guid=fn.guid||jQuery.guid++;return proxy},now:function(){return+new Date},support:support});jQuery.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(i,name){class2type["[object "+name+"]"]=name.toLowerCase()});function isArraylike(obj){var length=obj.length,type=jQuery.type(obj);if(type==="function"||jQuery.isWindow(obj)){return false}if(obj.nodeType===1&&length){return true}return type==="array"||length===0||typeof length==="number"&&length>0&&length-1 in obj}var Sizzle=function(window){var i,support,Expr,getText,isXML,tokenize,compile,select,outermostContext,sortInput,hasDuplicate,setDocument,document,docElem,documentIsHTML,rbuggyQSA,rbuggyMatches,matches,contains,expando="sizzle"+-new Date,preferredDoc=window.document,dirruns=0,done=0,classCache=createCache(),tokenCache=createCache(),compilerCache=createCache(),sortOrder=function(a,b){if(a===b){hasDuplicate=true}return 0},strundefined=typeof undefined,MAX_NEGATIVE=1<<31,hasOwn={}.hasOwnProperty,arr=[],pop=arr.pop,push_native=arr.push,push=arr.push,slice=arr.slice,indexOf=arr.indexOf||function(elem){var i=0,len=this.length;for(;i<len;i++){if(this[i]===elem){return i}}return-1},booleans="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",whitespace="[\\x20\\t\\r\\n\\f]",characterEncoding="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",identifier=characterEncoding.replace("w","w#"),attributes="\\["+whitespace+"*("+characterEncoding+")(?:"+whitespace+"*([*^$|!~]?=)"+whitespace+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+identifier+"))|)"+whitespace+"*\\]",pseudos=":("+characterEncoding+")(?:\\(("+"('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|"+"((?:\\\\.|[^\\\\()[\\]]|"+attributes+")*)|"+".*"+")\\)|)",rtrim=new RegExp("^"+whitespace+"+|((?:^|[^\\\\])(?:\\\\.)*)"+whitespace+"+$","g"),rcomma=new RegExp("^"+whitespace+"*,"+whitespace+"*"),rcombinators=new RegExp("^"+whitespace+"*([>+~]|"+whitespace+")"+whitespace+"*"),rattributeQuotes=new RegExp("="+whitespace+"*([^\\]'\"]*?)"+whitespace+"*\\]","g"),rpseudo=new RegExp(pseudos),ridentifier=new RegExp("^"+identifier+"$"),matchExpr={ID:new RegExp("^#("+characterEncoding+")"),CLASS:new RegExp("^\\.("+characterEncoding+")"),TAG:new RegExp("^("+characterEncoding.replace("w","w*")+")"),ATTR:new RegExp("^"+attributes),PSEUDO:new RegExp("^"+pseudos),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+whitespace+"*(even|odd|(([+-]|)(\\d*)n|)"+whitespace+"*(?:([+-]|)"+whitespace+"*(\\d+)|))"+whitespace+"*\\)|)","i"),bool:new RegExp("^(?:"+booleans+")$","i"),needsContext:new RegExp("^"+whitespace+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+whitespace+"*((?:-\\d)?\\d*)"+whitespace+"*\\)|)(?=[^-]|$)","i")},rinputs=/^(?:input|select|textarea|button)$/i,rheader=/^h\d$/i,rnative=/^[^{]+\{\s*\[native \w/,rquickExpr=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,rsibling=/[+~]/,rescape=/'|\\/g,runescape=new RegExp("\\\\([\\da-f]{1,6}"+whitespace+"?|("+whitespace+")|.)","ig"),funescape=function(_,escaped,escapedWhitespace){var high="0x"+escaped-65536;return high!==high||escapedWhitespace?escaped:high<0?String.fromCharCode(high+65536):String.fromCharCode(high>>10|55296,high&1023|56320)};try{push.apply(arr=slice.call(preferredDoc.childNodes),preferredDoc.childNodes);arr[preferredDoc.childNodes.length].nodeType}catch(e){push={apply:arr.length?function(target,els){push_native.apply(target,slice.call(els))}:function(target,els){var j=target.length,i=0;while(target[j++]=els[i++]){}target.length=j-1}}}function Sizzle(selector,context,results,seed){var match,elem,m,nodeType,i,groups,old,nid,newContext,newSelector;if((context?context.ownerDocument||context:preferredDoc)!==document){setDocument(context)}context=context||document;results=results||[];if(!selector||typeof selector!=="string"){return results}if((nodeType=context.nodeType)!==1&&nodeType!==9){return[]}if(documentIsHTML&&!seed){if(match=rquickExpr.exec(selector)){if(m=match[1]){if(nodeType===9){elem=context.getElementById(m);if(elem&&elem.parentNode){if(elem.id===m){results.push(elem);return results}}else{return results}}else{if(context.ownerDocument&&(elem=context.ownerDocument.getElementById(m))&&contains(context,elem)&&elem.id===m){results.push(elem);return results}}}else if(match[2]){push.apply(results,context.getElementsByTagName(selector));return results}else if((m=match[3])&&support.getElementsByClassName&&context.getElementsByClassName){push.apply(results,context.getElementsByClassName(m));return results}}if(support.qsa&&(!rbuggyQSA||!rbuggyQSA.test(selector))){nid=old=expando;newContext=context;newSelector=nodeType===9&&selector;if(nodeType===1&&context.nodeName.toLowerCase()!=="object"){groups=tokenize(selector);if(old=context.getAttribute("id")){nid=old.replace(rescape,"\\$&")}else{context.setAttribute("id",nid)}nid="[id='"+nid+"'] ";i=groups.length;while(i--){groups[i]=nid+toSelector(groups[i])}newContext=rsibling.test(selector)&&testContext(context.parentNode)||context;newSelector=groups.join(",")}if(newSelector){try{push.apply(results,newContext.querySelectorAll(newSelector));return results}catch(qsaError){}finally{if(!old){context.removeAttribute("id")}}}}}return select(selector.replace(rtrim,"$1"),context,results,seed)}function createCache(){var keys=[];function cache(key,value){if(keys.push(key+" ")>Expr.cacheLength){delete cache[keys.shift()]}return cache[key+" "]=value}return cache}function markFunction(fn){fn[expando]=true;return fn}function assert(fn){var div=document.createElement("div");try{return!!fn(div)}catch(e){return false}finally{if(div.parentNode){div.parentNode.removeChild(div)}div=null}}function addHandle(attrs,handler){var arr=attrs.split("|"),i=attrs.length;while(i--){Expr.attrHandle[arr[i]]=handler}}function siblingCheck(a,b){var cur=b&&a,diff=cur&&a.nodeType===1&&b.nodeType===1&&(~b.sourceIndex||MAX_NEGATIVE)-(~a.sourceIndex||MAX_NEGATIVE);if(diff){return diff}if(cur){while(cur=cur.nextSibling){if(cur===b){return-1}}}return a?1:-1}function createInputPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return name==="input"&&elem.type===type}}function createButtonPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return(name==="input"||name==="button")&&elem.type===type}}function createPositionalPseudo(fn){return markFunction(function(argument){argument=+argument;return markFunction(function(seed,matches){var j,matchIndexes=fn([],seed.length,argument),i=matchIndexes.length;while(i--){if(seed[j=matchIndexes[i]]){seed[j]=!(matches[j]=seed[j])}}})})}function testContext(context){return context&&typeof context.getElementsByTagName!==strundefined&&context}support=Sizzle.support={};isXML=Sizzle.isXML=function(elem){var documentElement=elem&&(elem.ownerDocument||elem).documentElement;return documentElement?documentElement.nodeName!=="HTML":false};setDocument=Sizzle.setDocument=function(node){var hasCompare,doc=node?node.ownerDocument||node:preferredDoc,parent=doc.defaultView;if(doc===document||doc.nodeType!==9||!doc.documentElement){return document}document=doc;docElem=doc.documentElement;documentIsHTML=!isXML(doc);if(parent&&parent!==parent.top){if(parent.addEventListener){parent.addEventListener("unload",function(){setDocument()},false)}else if(parent.attachEvent){parent.attachEvent("onunload",function(){setDocument()})}}support.attributes=assert(function(div){div.className="i";return!div.getAttribute("className")});support.getElementsByTagName=assert(function(div){div.appendChild(doc.createComment(""));return!div.getElementsByTagName("*").length});support.getElementsByClassName=rnative.test(doc.getElementsByClassName)&&assert(function(div){div.innerHTML="<div class='a'></div><div class='a i'></div>";div.firstChild.className="i";return div.getElementsByClassName("i").length===2});support.getById=assert(function(div){docElem.appendChild(div).id=expando;return!doc.getElementsByName||!doc.getElementsByName(expando).length});if(support.getById){Expr.find["ID"]=function(id,context){if(typeof context.getElementById!==strundefined&&documentIsHTML){var m=context.getElementById(id);return m&&m.parentNode?[m]:[]}};Expr.filter["ID"]=function(id){var attrId=id.replace(runescape,funescape);return function(elem){return elem.getAttribute("id")===attrId}}}else{delete Expr.find["ID"];Expr.filter["ID"]=function(id){var attrId=id.replace(runescape,funescape);return function(elem){var node=typeof elem.getAttributeNode!==strundefined&&elem.getAttributeNode("id");return node&&node.value===attrId}}}Expr.find["TAG"]=support.getElementsByTagName?function(tag,context){if(typeof context.getElementsByTagName!==strundefined){return context.getElementsByTagName(tag)}}:function(tag,context){var elem,tmp=[],i=0,results=context.getElementsByTagName(tag);if(tag==="*"){while(elem=results[i++]){if(elem.nodeType===1){tmp.push(elem)}}return tmp}return results};Expr.find["CLASS"]=support.getElementsByClassName&&function(className,context){if(typeof context.getElementsByClassName!==strundefined&&documentIsHTML){return context.getElementsByClassName(className)}};rbuggyMatches=[];rbuggyQSA=[];if(support.qsa=rnative.test(doc.querySelectorAll)){assert(function(div){div.innerHTML="<select msallowclip=''><option selected=''></option></select>";if(div.querySelectorAll("[msallowclip^='']").length){rbuggyQSA.push("[*^$]="+whitespace+"*(?:''|\"\")")}if(!div.querySelectorAll("[selected]").length){rbuggyQSA.push("\\["+whitespace+"*(?:value|"+booleans+")")}if(!div.querySelectorAll(":checked").length){rbuggyQSA.push(":checked")}});assert(function(div){var input=doc.createElement("input");input.setAttribute("type","hidden");div.appendChild(input).setAttribute("name","D");if(div.querySelectorAll("[name=d]").length){rbuggyQSA.push("name"+whitespace+"*[*^$|!~]?=")}if(!div.querySelectorAll(":enabled").length){rbuggyQSA.push(":enabled",":disabled")}div.querySelectorAll("*,:x");rbuggyQSA.push(",.*:")})}if(support.matchesSelector=rnative.test(matches=docElem.matches||docElem.webkitMatchesSelector||docElem.mozMatchesSelector||docElem.oMatchesSelector||docElem.msMatchesSelector)){assert(function(div){support.disconnectedMatch=matches.call(div,"div");matches.call(div,"[s!='']:x");rbuggyMatches.push("!=",pseudos)})}rbuggyQSA=rbuggyQSA.length&&new RegExp(rbuggyQSA.join("|"));rbuggyMatches=rbuggyMatches.length&&new RegExp(rbuggyMatches.join("|"));hasCompare=rnative.test(docElem.compareDocumentPosition);contains=hasCompare||rnative.test(docElem.contains)?function(a,b){var adown=a.nodeType===9?a.documentElement:a,bup=b&&b.parentNode;return a===bup||!!(bup&&bup.nodeType===1&&(adown.contains?adown.contains(bup):a.compareDocumentPosition&&a.compareDocumentPosition(bup)&16))}:function(a,b){if(b){while(b=b.parentNode){if(b===a){return true}}}return false};sortOrder=hasCompare?function(a,b){if(a===b){hasDuplicate=true;return 0}var compare=!a.compareDocumentPosition-!b.compareDocumentPosition;if(compare){return compare}compare=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1;if(compare&1||!support.sortDetached&&b.compareDocumentPosition(a)===compare){if(a===doc||a.ownerDocument===preferredDoc&&contains(preferredDoc,a)){return-1}if(b===doc||b.ownerDocument===preferredDoc&&contains(preferredDoc,b)){return 1}return sortInput?indexOf.call(sortInput,a)-indexOf.call(sortInput,b):0}return compare&4?-1:1}:function(a,b){if(a===b){hasDuplicate=true;return 0}var cur,i=0,aup=a.parentNode,bup=b.parentNode,ap=[a],bp=[b];if(!aup||!bup){return a===doc?-1:b===doc?1:aup?-1:bup?1:sortInput?indexOf.call(sortInput,a)-indexOf.call(sortInput,b):0}else if(aup===bup){return siblingCheck(a,b)}cur=a;while(cur=cur.parentNode){ap.unshift(cur)}cur=b;while(cur=cur.parentNode){bp.unshift(cur)}while(ap[i]===bp[i]){i++}return i?siblingCheck(ap[i],bp[i]):ap[i]===preferredDoc?-1:bp[i]===preferredDoc?1:0};return doc};Sizzle.matches=function(expr,elements){return Sizzle(expr,null,null,elements)};Sizzle.matchesSelector=function(elem,expr){if((elem.ownerDocument||elem)!==document){setDocument(elem)}expr=expr.replace(rattributeQuotes,"='$1']");if(support.matchesSelector&&documentIsHTML&&(!rbuggyMatches||!rbuggyMatches.test(expr))&&(!rbuggyQSA||!rbuggyQSA.test(expr))){try{var ret=matches.call(elem,expr);if(ret||support.disconnectedMatch||elem.document&&elem.document.nodeType!==11){return ret}}catch(e){}}return Sizzle(expr,document,null,[elem]).length>0};Sizzle.contains=function(context,elem){if((context.ownerDocument||context)!==document){setDocument(context)}return contains(context,elem)};Sizzle.attr=function(elem,name){if((elem.ownerDocument||elem)!==document){setDocument(elem)}var fn=Expr.attrHandle[name.toLowerCase()],val=fn&&hasOwn.call(Expr.attrHandle,name.toLowerCase())?fn(elem,name,!documentIsHTML):undefined;return val!==undefined?val:support.attributes||!documentIsHTML?elem.getAttribute(name):(val=elem.getAttributeNode(name))&&val.specified?val.value:null};Sizzle.error=function(msg){throw new Error("Syntax error, unrecognized expression: "+msg)};Sizzle.uniqueSort=function(results){var elem,duplicates=[],j=0,i=0;hasDuplicate=!support.detectDuplicates;sortInput=!support.sortStable&&results.slice(0);results.sort(sortOrder);if(hasDuplicate){while(elem=results[i++]){if(elem===results[i]){j=duplicates.push(i)}}while(j--){results.splice(duplicates[j],1)}}sortInput=null;return results};getText=Sizzle.getText=function(elem){var node,ret="",i=0,nodeType=elem.nodeType;if(!nodeType){while(node=elem[i++]){ret+=getText(node)}}else if(nodeType===1||nodeType===9||nodeType===11){if(typeof elem.textContent==="string"){return elem.textContent}else{for(elem=elem.firstChild;elem;elem=elem.nextSibling){ret+=getText(elem)}}}else if(nodeType===3||nodeType===4){return elem.nodeValue}return ret};Expr=Sizzle.selectors={cacheLength:50,createPseudo:markFunction,match:matchExpr,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:true}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:true},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(match){match[1]=match[1].replace(runescape,funescape);match[3]=(match[3]||match[4]||match[5]||"").replace(runescape,funescape);if(match[2]==="~="){match[3]=" "+match[3]+" "}return match.slice(0,4)},CHILD:function(match){match[1]=match[1].toLowerCase();if(match[1].slice(0,3)==="nth"){if(!match[3]){Sizzle.error(match[0])}match[4]=+(match[4]?match[5]+(match[6]||1):2*(match[3]==="even"||match[3]==="odd"));match[5]=+(match[7]+match[8]||match[3]==="odd")}else if(match[3]){Sizzle.error(match[0])}return match},PSEUDO:function(match){var excess,unquoted=!match[6]&&match[2];if(matchExpr["CHILD"].test(match[0])){return null}if(match[3]){match[2]=match[4]||match[5]||""}else if(unquoted&&rpseudo.test(unquoted)&&(excess=tokenize(unquoted,true))&&(excess=unquoted.indexOf(")",unquoted.length-excess)-unquoted.length)){match[0]=match[0].slice(0,excess);match[2]=unquoted.slice(0,excess)}return match.slice(0,3)}},filter:{TAG:function(nodeNameSelector){var nodeName=nodeNameSelector.replace(runescape,funescape).toLowerCase();return nodeNameSelector==="*"?function(){return true}:function(elem){return elem.nodeName&&elem.nodeName.toLowerCase()===nodeName}},CLASS:function(className){var pattern=classCache[className+" "];return pattern||(pattern=new RegExp("(^|"+whitespace+")"+className+"("+whitespace+"|$)"))&&classCache(className,function(elem){return pattern.test(typeof elem.className==="string"&&elem.className||typeof elem.getAttribute!==strundefined&&elem.getAttribute("class")||"")})},ATTR:function(name,operator,check){return function(elem){var result=Sizzle.attr(elem,name);if(result==null){return operator==="!="}if(!operator){return true}result+="";return operator==="="?result===check:operator==="!="?result!==check:operator==="^="?check&&result.indexOf(check)===0:operator==="*="?check&&result.indexOf(check)>-1:operator==="$="?check&&result.slice(-check.length)===check:operator==="~="?(" "+result+" ").indexOf(check)>-1:operator==="|="?result===check||result.slice(0,check.length+1)===check+"-":false}},CHILD:function(type,what,argument,first,last){
var simple=type.slice(0,3)!=="nth",forward=type.slice(-4)!=="last",ofType=what==="of-type";return first===1&&last===0?function(elem){return!!elem.parentNode}:function(elem,context,xml){var cache,outerCache,node,diff,nodeIndex,start,dir=simple!==forward?"nextSibling":"previousSibling",parent=elem.parentNode,name=ofType&&elem.nodeName.toLowerCase(),useCache=!xml&&!ofType;if(parent){if(simple){while(dir){node=elem;while(node=node[dir]){if(ofType?node.nodeName.toLowerCase()===name:node.nodeType===1){return false}}start=dir=type==="only"&&!start&&"nextSibling"}return true}start=[forward?parent.firstChild:parent.lastChild];if(forward&&useCache){outerCache=parent[expando]||(parent[expando]={});cache=outerCache[type]||[];nodeIndex=cache[0]===dirruns&&cache[1];diff=cache[0]===dirruns&&cache[2];node=nodeIndex&&parent.childNodes[nodeIndex];while(node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop()){if(node.nodeType===1&&++diff&&node===elem){outerCache[type]=[dirruns,nodeIndex,diff];break}}}else if(useCache&&(cache=(elem[expando]||(elem[expando]={}))[type])&&cache[0]===dirruns){diff=cache[1]}else{while(node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop()){if((ofType?node.nodeName.toLowerCase()===name:node.nodeType===1)&&++diff){if(useCache){(node[expando]||(node[expando]={}))[type]=[dirruns,diff]}if(node===elem){break}}}}diff-=last;return diff===first||diff%first===0&&diff/first>=0}}},PSEUDO:function(pseudo,argument){var args,fn=Expr.pseudos[pseudo]||Expr.setFilters[pseudo.toLowerCase()]||Sizzle.error("unsupported pseudo: "+pseudo);if(fn[expando]){return fn(argument)}if(fn.length>1){args=[pseudo,pseudo,"",argument];return Expr.setFilters.hasOwnProperty(pseudo.toLowerCase())?markFunction(function(seed,matches){var idx,matched=fn(seed,argument),i=matched.length;while(i--){idx=indexOf.call(seed,matched[i]);seed[idx]=!(matches[idx]=matched[i])}}):function(elem){return fn(elem,0,args)}}return fn}},pseudos:{not:markFunction(function(selector){var input=[],results=[],matcher=compile(selector.replace(rtrim,"$1"));return matcher[expando]?markFunction(function(seed,matches,context,xml){var elem,unmatched=matcher(seed,null,xml,[]),i=seed.length;while(i--){if(elem=unmatched[i]){seed[i]=!(matches[i]=elem)}}}):function(elem,context,xml){input[0]=elem;matcher(input,null,xml,results);return!results.pop()}}),has:markFunction(function(selector){return function(elem){return Sizzle(selector,elem).length>0}}),contains:markFunction(function(text){return function(elem){return(elem.textContent||elem.innerText||getText(elem)).indexOf(text)>-1}}),lang:markFunction(function(lang){if(!ridentifier.test(lang||"")){Sizzle.error("unsupported lang: "+lang)}lang=lang.replace(runescape,funescape).toLowerCase();return function(elem){var elemLang;do{if(elemLang=documentIsHTML?elem.lang:elem.getAttribute("xml:lang")||elem.getAttribute("lang")){elemLang=elemLang.toLowerCase();return elemLang===lang||elemLang.indexOf(lang+"-")===0}}while((elem=elem.parentNode)&&elem.nodeType===1);return false}}),target:function(elem){var hash=window.location&&window.location.hash;return hash&&hash.slice(1)===elem.id},root:function(elem){return elem===docElem},focus:function(elem){return elem===document.activeElement&&(!document.hasFocus||document.hasFocus())&&!!(elem.type||elem.href||~elem.tabIndex)},enabled:function(elem){return elem.disabled===false},disabled:function(elem){return elem.disabled===true},checked:function(elem){var nodeName=elem.nodeName.toLowerCase();return nodeName==="input"&&!!elem.checked||nodeName==="option"&&!!elem.selected},selected:function(elem){if(elem.parentNode){elem.parentNode.selectedIndex}return elem.selected===true},empty:function(elem){for(elem=elem.firstChild;elem;elem=elem.nextSibling){if(elem.nodeType<6){return false}}return true},parent:function(elem){return!Expr.pseudos["empty"](elem)},header:function(elem){return rheader.test(elem.nodeName)},input:function(elem){return rinputs.test(elem.nodeName)},button:function(elem){var name=elem.nodeName.toLowerCase();return name==="input"&&elem.type==="button"||name==="button"},text:function(elem){var attr;return elem.nodeName.toLowerCase()==="input"&&elem.type==="text"&&((attr=elem.getAttribute("type"))==null||attr.toLowerCase()==="text")},first:createPositionalPseudo(function(){return[0]}),last:createPositionalPseudo(function(matchIndexes,length){return[length-1]}),eq:createPositionalPseudo(function(matchIndexes,length,argument){return[argument<0?argument+length:argument]}),even:createPositionalPseudo(function(matchIndexes,length){var i=0;for(;i<length;i+=2){matchIndexes.push(i)}return matchIndexes}),odd:createPositionalPseudo(function(matchIndexes,length){var i=1;for(;i<length;i+=2){matchIndexes.push(i)}return matchIndexes}),lt:createPositionalPseudo(function(matchIndexes,length,argument){var i=argument<0?argument+length:argument;for(;--i>=0;){matchIndexes.push(i)}return matchIndexes}),gt:createPositionalPseudo(function(matchIndexes,length,argument){var i=argument<0?argument+length:argument;for(;++i<length;){matchIndexes.push(i)}return matchIndexes})}};Expr.pseudos["nth"]=Expr.pseudos["eq"];for(i in{radio:true,checkbox:true,file:true,password:true,image:true}){Expr.pseudos[i]=createInputPseudo(i)}for(i in{submit:true,reset:true}){Expr.pseudos[i]=createButtonPseudo(i)}function setFilters(){}setFilters.prototype=Expr.filters=Expr.pseudos;Expr.setFilters=new setFilters;tokenize=Sizzle.tokenize=function(selector,parseOnly){var matched,match,tokens,type,soFar,groups,preFilters,cached=tokenCache[selector+" "];if(cached){return parseOnly?0:cached.slice(0)}soFar=selector;groups=[];preFilters=Expr.preFilter;while(soFar){if(!matched||(match=rcomma.exec(soFar))){if(match){soFar=soFar.slice(match[0].length)||soFar}groups.push(tokens=[])}matched=false;if(match=rcombinators.exec(soFar)){matched=match.shift();tokens.push({value:matched,type:match[0].replace(rtrim," ")});soFar=soFar.slice(matched.length)}for(type in Expr.filter){if((match=matchExpr[type].exec(soFar))&&(!preFilters[type]||(match=preFilters[type](match)))){matched=match.shift();tokens.push({value:matched,type:type,matches:match});soFar=soFar.slice(matched.length)}}if(!matched){break}}return parseOnly?soFar.length:soFar?Sizzle.error(selector):tokenCache(selector,groups).slice(0)};function toSelector(tokens){var i=0,len=tokens.length,selector="";for(;i<len;i++){selector+=tokens[i].value}return selector}function addCombinator(matcher,combinator,base){var dir=combinator.dir,checkNonElements=base&&dir==="parentNode",doneName=done++;return combinator.first?function(elem,context,xml){while(elem=elem[dir]){if(elem.nodeType===1||checkNonElements){return matcher(elem,context,xml)}}}:function(elem,context,xml){var oldCache,outerCache,newCache=[dirruns,doneName];if(xml){while(elem=elem[dir]){if(elem.nodeType===1||checkNonElements){if(matcher(elem,context,xml)){return true}}}}else{while(elem=elem[dir]){if(elem.nodeType===1||checkNonElements){outerCache=elem[expando]||(elem[expando]={});if((oldCache=outerCache[dir])&&oldCache[0]===dirruns&&oldCache[1]===doneName){return newCache[2]=oldCache[2]}else{outerCache[dir]=newCache;if(newCache[2]=matcher(elem,context,xml)){return true}}}}}}}function elementMatcher(matchers){return matchers.length>1?function(elem,context,xml){var i=matchers.length;while(i--){if(!matchers[i](elem,context,xml)){return false}}return true}:matchers[0]}function multipleContexts(selector,contexts,results){var i=0,len=contexts.length;for(;i<len;i++){Sizzle(selector,contexts[i],results)}return results}function condense(unmatched,map,filter,context,xml){var elem,newUnmatched=[],i=0,len=unmatched.length,mapped=map!=null;for(;i<len;i++){if(elem=unmatched[i]){if(!filter||filter(elem,context,xml)){newUnmatched.push(elem);if(mapped){map.push(i)}}}}return newUnmatched}function setMatcher(preFilter,selector,matcher,postFilter,postFinder,postSelector){if(postFilter&&!postFilter[expando]){postFilter=setMatcher(postFilter)}if(postFinder&&!postFinder[expando]){postFinder=setMatcher(postFinder,postSelector)}return markFunction(function(seed,results,context,xml){var temp,i,elem,preMap=[],postMap=[],preexisting=results.length,elems=seed||multipleContexts(selector||"*",context.nodeType?[context]:context,[]),matcherIn=preFilter&&(seed||!selector)?condense(elems,preMap,preFilter,context,xml):elems,matcherOut=matcher?postFinder||(seed?preFilter:preexisting||postFilter)?[]:results:matcherIn;if(matcher){matcher(matcherIn,matcherOut,context,xml)}if(postFilter){temp=condense(matcherOut,postMap);postFilter(temp,[],context,xml);i=temp.length;while(i--){if(elem=temp[i]){matcherOut[postMap[i]]=!(matcherIn[postMap[i]]=elem)}}}if(seed){if(postFinder||preFilter){if(postFinder){temp=[];i=matcherOut.length;while(i--){if(elem=matcherOut[i]){temp.push(matcherIn[i]=elem)}}postFinder(null,matcherOut=[],temp,xml)}i=matcherOut.length;while(i--){if((elem=matcherOut[i])&&(temp=postFinder?indexOf.call(seed,elem):preMap[i])>-1){seed[temp]=!(results[temp]=elem)}}}}else{matcherOut=condense(matcherOut===results?matcherOut.splice(preexisting,matcherOut.length):matcherOut);if(postFinder){postFinder(null,results,matcherOut,xml)}else{push.apply(results,matcherOut)}}})}function matcherFromTokens(tokens){var checkContext,matcher,j,len=tokens.length,leadingRelative=Expr.relative[tokens[0].type],implicitRelative=leadingRelative||Expr.relative[" "],i=leadingRelative?1:0,matchContext=addCombinator(function(elem){return elem===checkContext},implicitRelative,true),matchAnyContext=addCombinator(function(elem){return indexOf.call(checkContext,elem)>-1},implicitRelative,true),matchers=[function(elem,context,xml){return!leadingRelative&&(xml||context!==outermostContext)||((checkContext=context).nodeType?matchContext(elem,context,xml):matchAnyContext(elem,context,xml))}];for(;i<len;i++){if(matcher=Expr.relative[tokens[i].type]){matchers=[addCombinator(elementMatcher(matchers),matcher)]}else{matcher=Expr.filter[tokens[i].type].apply(null,tokens[i].matches);if(matcher[expando]){j=++i;for(;j<len;j++){if(Expr.relative[tokens[j].type]){break}}return setMatcher(i>1&&elementMatcher(matchers),i>1&&toSelector(tokens.slice(0,i-1).concat({value:tokens[i-2].type===" "?"*":""})).replace(rtrim,"$1"),matcher,i<j&&matcherFromTokens(tokens.slice(i,j)),j<len&&matcherFromTokens(tokens=tokens.slice(j)),j<len&&toSelector(tokens))}matchers.push(matcher)}}return elementMatcher(matchers)}function matcherFromGroupMatchers(elementMatchers,setMatchers){var bySet=setMatchers.length>0,byElement=elementMatchers.length>0,superMatcher=function(seed,context,xml,results,outermost){var elem,j,matcher,matchedCount=0,i="0",unmatched=seed&&[],setMatched=[],contextBackup=outermostContext,elems=seed||byElement&&Expr.find["TAG"]("*",outermost),dirrunsUnique=dirruns+=contextBackup==null?1:Math.random()||.1,len=elems.length;if(outermost){outermostContext=context!==document&&context}for(;i!==len&&(elem=elems[i])!=null;i++){if(byElement&&elem){j=0;while(matcher=elementMatchers[j++]){if(matcher(elem,context,xml)){results.push(elem);break}}if(outermost){dirruns=dirrunsUnique}}if(bySet){if(elem=!matcher&&elem){matchedCount--}if(seed){unmatched.push(elem)}}}matchedCount+=i;if(bySet&&i!==matchedCount){j=0;while(matcher=setMatchers[j++]){matcher(unmatched,setMatched,context,xml)}if(seed){if(matchedCount>0){while(i--){if(!(unmatched[i]||setMatched[i])){setMatched[i]=pop.call(results)}}}setMatched=condense(setMatched)}push.apply(results,setMatched);if(outermost&&!seed&&setMatched.length>0&&matchedCount+setMatchers.length>1){Sizzle.uniqueSort(results)}}if(outermost){dirruns=dirrunsUnique;outermostContext=contextBackup}return unmatched};return bySet?markFunction(superMatcher):superMatcher}compile=Sizzle.compile=function(selector,match){var i,setMatchers=[],elementMatchers=[],cached=compilerCache[selector+" "];if(!cached){if(!match){match=tokenize(selector)}i=match.length;while(i--){cached=matcherFromTokens(match[i]);if(cached[expando]){setMatchers.push(cached)}else{elementMatchers.push(cached)}}cached=compilerCache(selector,matcherFromGroupMatchers(elementMatchers,setMatchers));cached.selector=selector}return cached};select=Sizzle.select=function(selector,context,results,seed){var i,tokens,token,type,find,compiled=typeof selector==="function"&&selector,match=!seed&&tokenize(selector=compiled.selector||selector);results=results||[];if(match.length===1){tokens=match[0]=match[0].slice(0);if(tokens.length>2&&(token=tokens[0]).type==="ID"&&support.getById&&context.nodeType===9&&documentIsHTML&&Expr.relative[tokens[1].type]){context=(Expr.find["ID"](token.matches[0].replace(runescape,funescape),context)||[])[0];if(!context){return results}else if(compiled){context=context.parentNode}selector=selector.slice(tokens.shift().value.length)}i=matchExpr["needsContext"].test(selector)?0:tokens.length;while(i--){token=tokens[i];if(Expr.relative[type=token.type]){break}if(find=Expr.find[type]){if(seed=find(token.matches[0].replace(runescape,funescape),rsibling.test(tokens[0].type)&&testContext(context.parentNode)||context)){tokens.splice(i,1);selector=seed.length&&toSelector(tokens);if(!selector){push.apply(results,seed);return results}break}}}}(compiled||compile(selector,match))(seed,context,!documentIsHTML,results,rsibling.test(selector)&&testContext(context.parentNode)||context);return results};support.sortStable=expando.split("").sort(sortOrder).join("")===expando;support.detectDuplicates=!!hasDuplicate;setDocument();support.sortDetached=assert(function(div1){return div1.compareDocumentPosition(document.createElement("div"))&1});if(!assert(function(div){div.innerHTML="<a href='#'></a>";return div.firstChild.getAttribute("href")==="#"})){addHandle("type|href|height|width",function(elem,name,isXML){if(!isXML){return elem.getAttribute(name,name.toLowerCase()==="type"?1:2)}})}if(!support.attributes||!assert(function(div){div.innerHTML="<input/>";div.firstChild.setAttribute("value","");return div.firstChild.getAttribute("value")===""})){addHandle("value",function(elem,name,isXML){if(!isXML&&elem.nodeName.toLowerCase()==="input"){return elem.defaultValue}})}if(!assert(function(div){return div.getAttribute("disabled")==null})){addHandle(booleans,function(elem,name,isXML){var val;if(!isXML){return elem[name]===true?name.toLowerCase():(val=elem.getAttributeNode(name))&&val.specified?val.value:null}})}return Sizzle}(window);jQuery.find=Sizzle;jQuery.expr=Sizzle.selectors;jQuery.expr[":"]=jQuery.expr.pseudos;jQuery.unique=Sizzle.uniqueSort;jQuery.text=Sizzle.getText;jQuery.isXMLDoc=Sizzle.isXML;jQuery.contains=Sizzle.contains;var rneedsContext=jQuery.expr.match.needsContext;var rsingleTag=/^<(\w+)\s*\/?>(?:<\/\1>|)$/;var risSimple=/^.[^:#\[\.,]*$/;function winnow(elements,qualifier,not){if(jQuery.isFunction(qualifier)){return jQuery.grep(elements,function(elem,i){return!!qualifier.call(elem,i,elem)!==not})}if(qualifier.nodeType){return jQuery.grep(elements,function(elem){return elem===qualifier!==not})}if(typeof qualifier==="string"){if(risSimple.test(qualifier)){return jQuery.filter(qualifier,elements,not)}qualifier=jQuery.filter(qualifier,elements)}return jQuery.grep(elements,function(elem){return jQuery.inArray(elem,qualifier)>=0!==not})}jQuery.filter=function(expr,elems,not){var elem=elems[0];if(not){expr=":not("+expr+")"}return elems.length===1&&elem.nodeType===1?jQuery.find.matchesSelector(elem,expr)?[elem]:[]:jQuery.find.matches(expr,jQuery.grep(elems,function(elem){return elem.nodeType===1}))};jQuery.fn.extend({find:function(selector){var i,ret=[],self=this,len=self.length;if(typeof selector!=="string"){return this.pushStack(jQuery(selector).filter(function(){for(i=0;i<len;i++){if(jQuery.contains(self[i],this)){return true}}}))}for(i=0;i<len;i++){jQuery.find(selector,self[i],ret)}ret=this.pushStack(len>1?jQuery.unique(ret):ret);ret.selector=this.selector?this.selector+" "+selector:selector;return ret},filter:function(selector){return this.pushStack(winnow(this,selector||[],false))},not:function(selector){return this.pushStack(winnow(this,selector||[],true))},is:function(selector){return!!winnow(this,typeof selector==="string"&&rneedsContext.test(selector)?jQuery(selector):selector||[],false).length}});var rootjQuery,document=window.document,rquickExpr=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,init=jQuery.fn.init=function(selector,context){var match,elem;if(!selector){return this}if(typeof selector==="string"){if(selector.charAt(0)==="<"&&selector.charAt(selector.length-1)===">"&&selector.length>=3){match=[null,selector,null]}else{match=rquickExpr.exec(selector)}if(match&&(match[1]||!context)){if(match[1]){context=context instanceof jQuery?context[0]:context;jQuery.merge(this,jQuery.parseHTML(match[1],context&&context.nodeType?context.ownerDocument||context:document,true));if(rsingleTag.test(match[1])&&jQuery.isPlainObject(context)){for(match in context){if(jQuery.isFunction(this[match])){this[match](context[match])}else{this.attr(match,context[match])}}}return this}else{elem=document.getElementById(match[2]);if(elem&&elem.parentNode){if(elem.id!==match[2]){return rootjQuery.find(selector)}this.length=1;this[0]=elem}this.context=document;this.selector=selector;return this}}else if(!context||context.jquery){return(context||rootjQuery).find(selector)}else{return this.constructor(context).find(selector)}}else if(selector.nodeType){this.context=this[0]=selector;this.length=1;return this}else if(jQuery.isFunction(selector)){return typeof rootjQuery.ready!=="undefined"?rootjQuery.ready(selector):selector(jQuery)}if(selector.selector!==undefined){this.selector=selector.selector;this.context=selector.context}return jQuery.makeArray(selector,this)};init.prototype=jQuery.fn;rootjQuery=jQuery(document);var rparentsprev=/^(?:parents|prev(?:Until|All))/,guaranteedUnique={children:true,contents:true,next:true,prev:true};jQuery.extend({dir:function(elem,dir,until){var matched=[],cur=elem[dir];while(cur&&cur.nodeType!==9&&(until===undefined||cur.nodeType!==1||!jQuery(cur).is(until))){if(cur.nodeType===1){matched.push(cur)}cur=cur[dir]}return matched},sibling:function(n,elem){var r=[];for(;n;n=n.nextSibling){if(n.nodeType===1&&n!==elem){r.push(n)}}return r}});jQuery.fn.extend({has:function(target){var i,targets=jQuery(target,this),len=targets.length;return this.filter(function(){for(i=0;i<len;i++){if(jQuery.contains(this,targets[i])){return true}}})},closest:function(selectors,context){var cur,i=0,l=this.length,matched=[],pos=rneedsContext.test(selectors)||typeof selectors!=="string"?jQuery(selectors,context||this.context):0;for(;i<l;i++){for(cur=this[i];cur&&cur!==context;cur=cur.parentNode){if(cur.nodeType<11&&(pos?pos.index(cur)>-1:cur.nodeType===1&&jQuery.find.matchesSelector(cur,selectors))){matched.push(cur);break}}}return this.pushStack(matched.length>1?jQuery.unique(matched):matched)},index:function(elem){if(!elem){return this[0]&&this[0].parentNode?this.first().prevAll().length:-1}if(typeof elem==="string"){return jQuery.inArray(this[0],jQuery(elem))}return jQuery.inArray(elem.jquery?elem[0]:elem,this)},add:function(selector,context){return this.pushStack(jQuery.unique(jQuery.merge(this.get(),jQuery(selector,context))))},addBack:function(selector){return this.add(selector==null?this.prevObject:this.prevObject.filter(selector))}});function sibling(cur,dir){do{cur=cur[dir]}while(cur&&cur.nodeType!==1);return cur}jQuery.each({parent:function(elem){var parent=elem.parentNode;return parent&&parent.nodeType!==11?parent:null},parents:function(elem){return jQuery.dir(elem,"parentNode")},parentsUntil:function(elem,i,until){return jQuery.dir(elem,"parentNode",until)},next:function(elem){return sibling(elem,"nextSibling")},prev:function(elem){return sibling(elem,"previousSibling")},nextAll:function(elem){return jQuery.dir(elem,"nextSibling")},prevAll:function(elem){return jQuery.dir(elem,"previousSibling")},nextUntil:function(elem,i,until){return jQuery.dir(elem,"nextSibling",until)},prevUntil:function(elem,i,until){return jQuery.dir(elem,"previousSibling",until)},siblings:function(elem){return jQuery.sibling((elem.parentNode||{}).firstChild,elem)},children:function(elem){return jQuery.sibling(elem.firstChild)},contents:function(elem){return jQuery.nodeName(elem,"iframe")?elem.contentDocument||elem.contentWindow.document:jQuery.merge([],elem.childNodes)}},function(name,fn){jQuery.fn[name]=function(until,selector){var ret=jQuery.map(this,fn,until);if(name.slice(-5)!=="Until"){selector=until}if(selector&&typeof selector==="string"){ret=jQuery.filter(selector,ret)}if(this.length>1){if(!guaranteedUnique[name]){ret=jQuery.unique(ret)}if(rparentsprev.test(name)){ret=ret.reverse()}}return this.pushStack(ret)}});var rnotwhite=/\S+/g;var optionsCache={};function createOptions(options){var object=optionsCache[options]={};jQuery.each(options.match(rnotwhite)||[],function(_,flag){object[flag]=true});return object}jQuery.Callbacks=function(options){options=typeof options==="string"?optionsCache[options]||createOptions(options):jQuery.extend({},options);var firing,memory,fired,firingLength,firingIndex,firingStart,list=[],stack=!options.once&&[],fire=function(data){memory=options.memory&&data;fired=true;firingIndex=firingStart||0;firingStart=0;firingLength=list.length;firing=true;for(;list&&firingIndex<firingLength;firingIndex++){if(list[firingIndex].apply(data[0],data[1])===false&&options.stopOnFalse){memory=false;break}}firing=false;if(list){if(stack){if(stack.length){fire(stack.shift())}}else if(memory){list=[]}else{self.disable()}}},self={add:function(){if(list){var start=list.length;(function add(args){jQuery.each(args,function(_,arg){var type=jQuery.type(arg);if(type==="function"){if(!options.unique||!self.has(arg)){list.push(arg)}}else if(arg&&arg.length&&type!=="string"){add(arg)}})})(arguments);if(firing){firingLength=list.length}else if(memory){firingStart=start;fire(memory)}}return this},remove:function(){if(list){jQuery.each(arguments,function(_,arg){var index;while((index=jQuery.inArray(arg,list,index))>-1){list.splice(index,1);if(firing){if(index<=firingLength){firingLength--}if(index<=firingIndex){firingIndex--}}}})}return this},has:function(fn){return fn?jQuery.inArray(fn,list)>-1:!!(list&&list.length)},empty:function(){list=[];firingLength=0;return this},disable:function(){list=stack=memory=undefined;return this},disabled:function(){return!list},lock:function(){stack=undefined;if(!memory){self.disable()}return this},locked:function(){return!stack},fireWith:function(context,args){if(list&&(!fired||stack)){args=args||[];args=[context,args.slice?args.slice():args];if(firing){stack.push(args)}else{fire(args)}}return this},fire:function(){self.fireWith(this,arguments);return this},fired:function(){return!!fired}};return self};jQuery.extend({Deferred:function(func){var tuples=[["resolve","done",jQuery.Callbacks("once memory"),"resolved"],["reject","fail",jQuery.Callbacks("once memory"),"rejected"],["notify","progress",jQuery.Callbacks("memory")]],state="pending",promise={state:function(){return state},always:function(){deferred.done(arguments).fail(arguments);return this},then:function(){var fns=arguments;return jQuery.Deferred(function(newDefer){jQuery.each(tuples,function(i,tuple){var fn=jQuery.isFunction(fns[i])&&fns[i];deferred[tuple[1]](function(){var returned=fn&&fn.apply(this,arguments);if(returned&&jQuery.isFunction(returned.promise)){returned.promise().done(newDefer.resolve).fail(newDefer.reject).progress(newDefer.notify)}else{newDefer[tuple[0]+"With"](this===promise?newDefer.promise():this,fn?[returned]:arguments)}})});fns=null}).promise()},promise:function(obj){return obj!=null?jQuery.extend(obj,promise):promise}},deferred={};promise.pipe=promise.then;jQuery.each(tuples,function(i,tuple){var list=tuple[2],stateString=tuple[3];promise[tuple[1]]=list.add;if(stateString){list.add(function(){state=stateString},tuples[i^1][2].disable,tuples[2][2].lock)}deferred[tuple[0]]=function(){deferred[tuple[0]+"With"](this===deferred?promise:this,arguments);return this};deferred[tuple[0]+"With"]=list.fireWith});promise.promise(deferred);if(func){func.call(deferred,deferred)}return deferred},when:function(subordinate){var i=0,resolveValues=slice.call(arguments),length=resolveValues.length,remaining=length!==1||subordinate&&jQuery.isFunction(subordinate.promise)?length:0,deferred=remaining===1?subordinate:jQuery.Deferred(),updateFunc=function(i,contexts,values){return function(value){contexts[i]=this;values[i]=arguments.length>1?slice.call(arguments):value;if(values===progressValues){deferred.notifyWith(contexts,values)}else if(!--remaining){deferred.resolveWith(contexts,values)}}},progressValues,progressContexts,resolveContexts;if(length>1){progressValues=new Array(length);progressContexts=new Array(length);resolveContexts=new Array(length);for(;i<length;i++){if(resolveValues[i]&&jQuery.isFunction(resolveValues[i].promise)){resolveValues[i].promise().done(updateFunc(i,resolveContexts,resolveValues)).fail(deferred.reject).progress(updateFunc(i,progressContexts,progressValues))}else{--remaining}}}if(!remaining){deferred.resolveWith(resolveContexts,resolveValues)}return deferred.promise()}});var readyList;jQuery.fn.ready=function(fn){jQuery.ready.promise().done(fn);return this};jQuery.extend({isReady:false,readyWait:1,holdReady:function(hold){if(hold){jQuery.readyWait++}else{jQuery.ready(true)}},ready:function(wait){if(wait===true?--jQuery.readyWait:jQuery.isReady){return}if(!document.body){return setTimeout(jQuery.ready)}jQuery.isReady=true;if(wait!==true&&--jQuery.readyWait>0){return}readyList.resolveWith(document,[jQuery]);if(jQuery.fn.triggerHandler){jQuery(document).triggerHandler("ready");jQuery(document).off("ready")}}});function detach(){if(document.addEventListener){document.removeEventListener("DOMContentLoaded",completed,false);window.removeEventListener("load",completed,false)}else{document.detachEvent("onreadystatechange",completed);window.detachEvent("onload",completed)}}function completed(){if(document.addEventListener||event.type==="load"||document.readyState==="complete"){detach();jQuery.ready()}}jQuery.ready.promise=function(obj){if(!readyList){readyList=jQuery.Deferred();if(document.readyState==="complete"){setTimeout(jQuery.ready)}else if(document.addEventListener){document.addEventListener("DOMContentLoaded",completed,false);window.addEventListener("load",completed,false)}else{document.attachEvent("onreadystatechange",completed);window.attachEvent("onload",completed);var top=false;try{top=window.frameElement==null&&document.documentElement}catch(e){}if(top&&top.doScroll){(function doScrollCheck(){if(!jQuery.isReady){try{top.doScroll("left")}catch(e){return setTimeout(doScrollCheck,50)}detach();jQuery.ready()}})()}}}return readyList.promise(obj)};var strundefined=typeof undefined;var i;for(i in jQuery(support)){break}support.ownLast=i!=="0";support.inlineBlockNeedsLayout=false;jQuery(function(){var val,div,body,container;body=document.getElementsByTagName("body")[0];if(!body||!body.style){return}div=document.createElement("div");container=document.createElement("div");container.style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px";body.appendChild(container).appendChild(div);if(typeof div.style.zoom!==strundefined){div.style.cssText="display:inline;margin:0;border:0;padding:1px;width:1px;zoom:1";support.inlineBlockNeedsLayout=val=div.offsetWidth===3;if(val){body.style.zoom=1}}body.removeChild(container)});(function(){var div=document.createElement("div");if(support.deleteExpando==null){support.deleteExpando=true;try{delete div.test}catch(e){support.deleteExpando=false}}div=null})();jQuery.acceptData=function(elem){var noData=jQuery.noData[(elem.nodeName+" ").toLowerCase()],nodeType=+elem.nodeType||1;return nodeType!==1&&nodeType!==9?false:!noData||noData!==true&&elem.getAttribute("classid")===noData};var rbrace=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,rmultiDash=/([A-Z])/g;function dataAttr(elem,key,data){if(data===undefined&&elem.nodeType===1){var name="data-"+key.replace(rmultiDash,"-$1").toLowerCase();data=elem.getAttribute(name);if(typeof data==="string"){try{data=data==="true"?true:data==="false"?false:data==="null"?null:+data+""===data?+data:rbrace.test(data)?jQuery.parseJSON(data):data}catch(e){}jQuery.data(elem,key,data)}else{data=undefined}}return data}function isEmptyDataObject(obj){var name;for(name in obj){if(name==="data"&&jQuery.isEmptyObject(obj[name])){continue}if(name!=="toJSON"){return false}}return true}function internalData(elem,name,data,pvt){if(!jQuery.acceptData(elem)){return}var ret,thisCache,internalKey=jQuery.expando,isNode=elem.nodeType,cache=isNode?jQuery.cache:elem,id=isNode?elem[internalKey]:elem[internalKey]&&internalKey;if((!id||!cache[id]||!pvt&&!cache[id].data)&&data===undefined&&typeof name==="string"){return}if(!id){if(isNode){id=elem[internalKey]=deletedIds.pop()||jQuery.guid++}else{id=internalKey}}if(!cache[id]){cache[id]=isNode?{}:{toJSON:jQuery.noop}}if(typeof name==="object"||typeof name==="function"){if(pvt){cache[id]=jQuery.extend(cache[id],name)}else{cache[id].data=jQuery.extend(cache[id].data,name)}}thisCache=cache[id];if(!pvt){if(!thisCache.data){thisCache.data={}}thisCache=thisCache.data}if(data!==undefined){thisCache[jQuery.camelCase(name)]=data}if(typeof name==="string"){ret=thisCache[name];if(ret==null){ret=thisCache[jQuery.camelCase(name)]}}else{ret=thisCache}return ret}function internalRemoveData(elem,name,pvt){if(!jQuery.acceptData(elem)){return}var thisCache,i,isNode=elem.nodeType,cache=isNode?jQuery.cache:elem,id=isNode?elem[jQuery.expando]:jQuery.expando;if(!cache[id]){return}if(name){thisCache=pvt?cache[id]:cache[id].data;if(thisCache){if(!jQuery.isArray(name)){if(name in thisCache){name=[name]}else{name=jQuery.camelCase(name);if(name in thisCache){name=[name]}else{name=name.split(" ")}}}else{name=name.concat(jQuery.map(name,jQuery.camelCase))}i=name.length;while(i--){delete thisCache[name[i]]}if(pvt?!isEmptyDataObject(thisCache):!jQuery.isEmptyObject(thisCache)){return}}}if(!pvt){delete cache[id].data;if(!isEmptyDataObject(cache[id])){return}}if(isNode){jQuery.cleanData([elem],true)}else if(support.deleteExpando||cache!=cache.window){delete cache[id]}else{cache[id]=null}}jQuery.extend({cache:{},noData:{"applet ":true,"embed ":true,"object ":"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(elem){elem=elem.nodeType?jQuery.cache[elem[jQuery.expando]]:elem[jQuery.expando];return!!elem&&!isEmptyDataObject(elem)},data:function(elem,name,data){return internalData(elem,name,data)},removeData:function(elem,name){return internalRemoveData(elem,name)},_data:function(elem,name,data){return internalData(elem,name,data,true)},_removeData:function(elem,name){return internalRemoveData(elem,name,true)}});jQuery.fn.extend({data:function(key,value){var i,name,data,elem=this[0],attrs=elem&&elem.attributes;if(key===undefined){if(this.length){data=jQuery.data(elem);if(elem.nodeType===1&&!jQuery._data(elem,"parsedAttrs")){i=attrs.length;while(i--){if(attrs[i]){name=attrs[i].name;if(name.indexOf("data-")===0){name=jQuery.camelCase(name.slice(5));dataAttr(elem,name,data[name])}}}jQuery._data(elem,"parsedAttrs",true)}}return data}if(typeof key==="object"){return this.each(function(){jQuery.data(this,key)})}return arguments.length>1?this.each(function(){jQuery.data(this,key,value)}):elem?dataAttr(elem,key,jQuery.data(elem,key)):undefined},removeData:function(key){return this.each(function(){jQuery.removeData(this,key)})}});jQuery.extend({queue:function(elem,type,data){var queue;if(elem){type=(type||"fx")+"queue";queue=jQuery._data(elem,type);if(data){if(!queue||jQuery.isArray(data)){queue=jQuery._data(elem,type,jQuery.makeArray(data))}else{queue.push(data)}}return queue||[]}},dequeue:function(elem,type){type=type||"fx";var queue=jQuery.queue(elem,type),startLength=queue.length,fn=queue.shift(),hooks=jQuery._queueHooks(elem,type),next=function(){jQuery.dequeue(elem,type)};if(fn==="inprogress"){fn=queue.shift();startLength--}if(fn){if(type==="fx"){queue.unshift("inprogress")}delete hooks.stop;
fn.call(elem,next,hooks)}if(!startLength&&hooks){hooks.empty.fire()}},_queueHooks:function(elem,type){var key=type+"queueHooks";return jQuery._data(elem,key)||jQuery._data(elem,key,{empty:jQuery.Callbacks("once memory").add(function(){jQuery._removeData(elem,type+"queue");jQuery._removeData(elem,key)})})}});jQuery.fn.extend({queue:function(type,data){var setter=2;if(typeof type!=="string"){data=type;type="fx";setter--}if(arguments.length<setter){return jQuery.queue(this[0],type)}return data===undefined?this:this.each(function(){var queue=jQuery.queue(this,type,data);jQuery._queueHooks(this,type);if(type==="fx"&&queue[0]!=="inprogress"){jQuery.dequeue(this,type)}})},dequeue:function(type){return this.each(function(){jQuery.dequeue(this,type)})},clearQueue:function(type){return this.queue(type||"fx",[])},promise:function(type,obj){var tmp,count=1,defer=jQuery.Deferred(),elements=this,i=this.length,resolve=function(){if(!--count){defer.resolveWith(elements,[elements])}};if(typeof type!=="string"){obj=type;type=undefined}type=type||"fx";while(i--){tmp=jQuery._data(elements[i],type+"queueHooks");if(tmp&&tmp.empty){count++;tmp.empty.add(resolve)}}resolve();return defer.promise(obj)}});var pnum=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source;var cssExpand=["Top","Right","Bottom","Left"];var isHidden=function(elem,el){elem=el||elem;return jQuery.css(elem,"display")==="none"||!jQuery.contains(elem.ownerDocument,elem)};var access=jQuery.access=function(elems,fn,key,value,chainable,emptyGet,raw){var i=0,length=elems.length,bulk=key==null;if(jQuery.type(key)==="object"){chainable=true;for(i in key){jQuery.access(elems,fn,i,key[i],true,emptyGet,raw)}}else if(value!==undefined){chainable=true;if(!jQuery.isFunction(value)){raw=true}if(bulk){if(raw){fn.call(elems,value);fn=null}else{bulk=fn;fn=function(elem,key,value){return bulk.call(jQuery(elem),value)}}}if(fn){for(;i<length;i++){fn(elems[i],key,raw?value:value.call(elems[i],i,fn(elems[i],key)))}}}return chainable?elems:bulk?fn.call(elems):length?fn(elems[0],key):emptyGet};var rcheckableType=/^(?:checkbox|radio)$/i;(function(){var input=document.createElement("input"),div=document.createElement("div"),fragment=document.createDocumentFragment();div.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>";support.leadingWhitespace=div.firstChild.nodeType===3;support.tbody=!div.getElementsByTagName("tbody").length;support.htmlSerialize=!!div.getElementsByTagName("link").length;support.html5Clone=document.createElement("nav").cloneNode(true).outerHTML!=="<:nav></:nav>";input.type="checkbox";input.checked=true;fragment.appendChild(input);support.appendChecked=input.checked;div.innerHTML="<textarea>x</textarea>";support.noCloneChecked=!!div.cloneNode(true).lastChild.defaultValue;fragment.appendChild(div);div.innerHTML="<input type='radio' checked='checked' name='t'/>";support.checkClone=div.cloneNode(true).cloneNode(true).lastChild.checked;support.noCloneEvent=true;if(div.attachEvent){div.attachEvent("onclick",function(){support.noCloneEvent=false});div.cloneNode(true).click()}if(support.deleteExpando==null){support.deleteExpando=true;try{delete div.test}catch(e){support.deleteExpando=false}}})();(function(){var i,eventName,div=document.createElement("div");for(i in{submit:true,change:true,focusin:true}){eventName="on"+i;if(!(support[i+"Bubbles"]=eventName in window)){div.setAttribute(eventName,"t");support[i+"Bubbles"]=div.attributes[eventName].expando===false}}div=null})();var rformElems=/^(?:input|select|textarea)$/i,rkeyEvent=/^key/,rmouseEvent=/^(?:mouse|pointer|contextmenu)|click/,rfocusMorph=/^(?:focusinfocus|focusoutblur)$/,rtypenamespace=/^([^.]*)(?:\.(.+)|)$/;function returnTrue(){return true}function returnFalse(){return false}function safeActiveElement(){try{return document.activeElement}catch(err){}}jQuery.event={global:{},add:function(elem,types,handler,data,selector){var tmp,events,t,handleObjIn,special,eventHandle,handleObj,handlers,type,namespaces,origType,elemData=jQuery._data(elem);if(!elemData){return}if(handler.handler){handleObjIn=handler;handler=handleObjIn.handler;selector=handleObjIn.selector}if(!handler.guid){handler.guid=jQuery.guid++}if(!(events=elemData.events)){events=elemData.events={}}if(!(eventHandle=elemData.handle)){eventHandle=elemData.handle=function(e){return typeof jQuery!==strundefined&&(!e||jQuery.event.triggered!==e.type)?jQuery.event.dispatch.apply(eventHandle.elem,arguments):undefined};eventHandle.elem=elem}types=(types||"").match(rnotwhite)||[""];t=types.length;while(t--){tmp=rtypenamespace.exec(types[t])||[];type=origType=tmp[1];namespaces=(tmp[2]||"").split(".").sort();if(!type){continue}special=jQuery.event.special[type]||{};type=(selector?special.delegateType:special.bindType)||type;special=jQuery.event.special[type]||{};handleObj=jQuery.extend({type:type,origType:origType,data:data,handler:handler,guid:handler.guid,selector:selector,needsContext:selector&&jQuery.expr.match.needsContext.test(selector),namespace:namespaces.join(".")},handleObjIn);if(!(handlers=events[type])){handlers=events[type]=[];handlers.delegateCount=0;if(!special.setup||special.setup.call(elem,data,namespaces,eventHandle)===false){if(elem.addEventListener){elem.addEventListener(type,eventHandle,false)}else if(elem.attachEvent){elem.attachEvent("on"+type,eventHandle)}}}if(special.add){special.add.call(elem,handleObj);if(!handleObj.handler.guid){handleObj.handler.guid=handler.guid}}if(selector){handlers.splice(handlers.delegateCount++,0,handleObj)}else{handlers.push(handleObj)}jQuery.event.global[type]=true}elem=null},remove:function(elem,types,handler,selector,mappedTypes){var j,handleObj,tmp,origCount,t,events,special,handlers,type,namespaces,origType,elemData=jQuery.hasData(elem)&&jQuery._data(elem);if(!elemData||!(events=elemData.events)){return}types=(types||"").match(rnotwhite)||[""];t=types.length;while(t--){tmp=rtypenamespace.exec(types[t])||[];type=origType=tmp[1];namespaces=(tmp[2]||"").split(".").sort();if(!type){for(type in events){jQuery.event.remove(elem,type+types[t],handler,selector,true)}continue}special=jQuery.event.special[type]||{};type=(selector?special.delegateType:special.bindType)||type;handlers=events[type]||[];tmp=tmp[2]&&new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)");origCount=j=handlers.length;while(j--){handleObj=handlers[j];if((mappedTypes||origType===handleObj.origType)&&(!handler||handler.guid===handleObj.guid)&&(!tmp||tmp.test(handleObj.namespace))&&(!selector||selector===handleObj.selector||selector==="**"&&handleObj.selector)){handlers.splice(j,1);if(handleObj.selector){handlers.delegateCount--}if(special.remove){special.remove.call(elem,handleObj)}}}if(origCount&&!handlers.length){if(!special.teardown||special.teardown.call(elem,namespaces,elemData.handle)===false){jQuery.removeEvent(elem,type,elemData.handle)}delete events[type]}}if(jQuery.isEmptyObject(events)){delete elemData.handle;jQuery._removeData(elem,"events")}},trigger:function(event,data,elem,onlyHandlers){var handle,ontype,cur,bubbleType,special,tmp,i,eventPath=[elem||document],type=hasOwn.call(event,"type")?event.type:event,namespaces=hasOwn.call(event,"namespace")?event.namespace.split("."):[];cur=tmp=elem=elem||document;if(elem.nodeType===3||elem.nodeType===8){return}if(rfocusMorph.test(type+jQuery.event.triggered)){return}if(type.indexOf(".")>=0){namespaces=type.split(".");type=namespaces.shift();namespaces.sort()}ontype=type.indexOf(":")<0&&"on"+type;event=event[jQuery.expando]?event:new jQuery.Event(type,typeof event==="object"&&event);event.isTrigger=onlyHandlers?2:3;event.namespace=namespaces.join(".");event.namespace_re=event.namespace?new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)"):null;event.result=undefined;if(!event.target){event.target=elem}data=data==null?[event]:jQuery.makeArray(data,[event]);special=jQuery.event.special[type]||{};if(!onlyHandlers&&special.trigger&&special.trigger.apply(elem,data)===false){return}if(!onlyHandlers&&!special.noBubble&&!jQuery.isWindow(elem)){bubbleType=special.delegateType||type;if(!rfocusMorph.test(bubbleType+type)){cur=cur.parentNode}for(;cur;cur=cur.parentNode){eventPath.push(cur);tmp=cur}if(tmp===(elem.ownerDocument||document)){eventPath.push(tmp.defaultView||tmp.parentWindow||window)}}i=0;while((cur=eventPath[i++])&&!event.isPropagationStopped()){event.type=i>1?bubbleType:special.bindType||type;handle=(jQuery._data(cur,"events")||{})[event.type]&&jQuery._data(cur,"handle");if(handle){handle.apply(cur,data)}handle=ontype&&cur[ontype];if(handle&&handle.apply&&jQuery.acceptData(cur)){event.result=handle.apply(cur,data);if(event.result===false){event.preventDefault()}}}event.type=type;if(!onlyHandlers&&!event.isDefaultPrevented()){if((!special._default||special._default.apply(eventPath.pop(),data)===false)&&jQuery.acceptData(elem)){if(ontype&&elem[type]&&!jQuery.isWindow(elem)){tmp=elem[ontype];if(tmp){elem[ontype]=null}jQuery.event.triggered=type;try{elem[type]()}catch(e){}jQuery.event.triggered=undefined;if(tmp){elem[ontype]=tmp}}}}return event.result},dispatch:function(event){event=jQuery.event.fix(event);var i,ret,handleObj,matched,j,handlerQueue=[],args=slice.call(arguments),handlers=(jQuery._data(this,"events")||{})[event.type]||[],special=jQuery.event.special[event.type]||{};args[0]=event;event.delegateTarget=this;if(special.preDispatch&&special.preDispatch.call(this,event)===false){return}handlerQueue=jQuery.event.handlers.call(this,event,handlers);i=0;while((matched=handlerQueue[i++])&&!event.isPropagationStopped()){event.currentTarget=matched.elem;j=0;while((handleObj=matched.handlers[j++])&&!event.isImmediatePropagationStopped()){if(!event.namespace_re||event.namespace_re.test(handleObj.namespace)){event.handleObj=handleObj;event.data=handleObj.data;ret=((jQuery.event.special[handleObj.origType]||{}).handle||handleObj.handler).apply(matched.elem,args);if(ret!==undefined){if((event.result=ret)===false){event.preventDefault();event.stopPropagation()}}}}}if(special.postDispatch){special.postDispatch.call(this,event)}return event.result},handlers:function(event,handlers){var sel,handleObj,matches,i,handlerQueue=[],delegateCount=handlers.delegateCount,cur=event.target;if(delegateCount&&cur.nodeType&&(!event.button||event.type!=="click")){for(;cur!=this;cur=cur.parentNode||this){if(cur.nodeType===1&&(cur.disabled!==true||event.type!=="click")){matches=[];for(i=0;i<delegateCount;i++){handleObj=handlers[i];sel=handleObj.selector+" ";if(matches[sel]===undefined){matches[sel]=handleObj.needsContext?jQuery(sel,this).index(cur)>=0:jQuery.find(sel,this,null,[cur]).length}if(matches[sel]){matches.push(handleObj)}}if(matches.length){handlerQueue.push({elem:cur,handlers:matches})}}}}if(delegateCount<handlers.length){handlerQueue.push({elem:this,handlers:handlers.slice(delegateCount)})}return handlerQueue},fix:function(event){if(event[jQuery.expando]){return event}var i,prop,copy,type=event.type,originalEvent=event,fixHook=this.fixHooks[type];if(!fixHook){this.fixHooks[type]=fixHook=rmouseEvent.test(type)?this.mouseHooks:rkeyEvent.test(type)?this.keyHooks:{}}copy=fixHook.props?this.props.concat(fixHook.props):this.props;event=new jQuery.Event(originalEvent);i=copy.length;while(i--){prop=copy[i];event[prop]=originalEvent[prop]}if(!event.target){event.target=originalEvent.srcElement||document}if(event.target.nodeType===3){event.target=event.target.parentNode}event.metaKey=!!event.metaKey;return fixHook.filter?fixHook.filter(event,originalEvent):event},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(event,original){if(event.which==null){event.which=original.charCode!=null?original.charCode:original.keyCode}return event}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(event,original){var body,eventDoc,doc,button=original.button,fromElement=original.fromElement;if(event.pageX==null&&original.clientX!=null){eventDoc=event.target.ownerDocument||document;doc=eventDoc.documentElement;body=eventDoc.body;event.pageX=original.clientX+(doc&&doc.scrollLeft||body&&body.scrollLeft||0)-(doc&&doc.clientLeft||body&&body.clientLeft||0);event.pageY=original.clientY+(doc&&doc.scrollTop||body&&body.scrollTop||0)-(doc&&doc.clientTop||body&&body.clientTop||0)}if(!event.relatedTarget&&fromElement){event.relatedTarget=fromElement===event.target?original.toElement:fromElement}if(!event.which&&button!==undefined){event.which=button&1?1:button&2?3:button&4?2:0}return event}},special:{load:{noBubble:true},focus:{trigger:function(){if(this!==safeActiveElement()&&this.focus){try{this.focus();return false}catch(e){}}},delegateType:"focusin"},blur:{trigger:function(){if(this===safeActiveElement()&&this.blur){this.blur();return false}},delegateType:"focusout"},click:{trigger:function(){if(jQuery.nodeName(this,"input")&&this.type==="checkbox"&&this.click){this.click();return false}},_default:function(event){return jQuery.nodeName(event.target,"a")}},beforeunload:{postDispatch:function(event){if(event.result!==undefined&&event.originalEvent){event.originalEvent.returnValue=event.result}}}},simulate:function(type,elem,event,bubble){var e=jQuery.extend(new jQuery.Event,event,{type:type,isSimulated:true,originalEvent:{}});if(bubble){jQuery.event.trigger(e,null,elem)}else{jQuery.event.dispatch.call(elem,e)}if(e.isDefaultPrevented()){event.preventDefault()}}};jQuery.removeEvent=document.removeEventListener?function(elem,type,handle){if(elem.removeEventListener){elem.removeEventListener(type,handle,false)}}:function(elem,type,handle){var name="on"+type;if(elem.detachEvent){if(typeof elem[name]===strundefined){elem[name]=null}elem.detachEvent(name,handle)}};jQuery.Event=function(src,props){if(!(this instanceof jQuery.Event)){return new jQuery.Event(src,props)}if(src&&src.type){this.originalEvent=src;this.type=src.type;this.isDefaultPrevented=src.defaultPrevented||src.defaultPrevented===undefined&&src.returnValue===false?returnTrue:returnFalse}else{this.type=src}if(props){jQuery.extend(this,props)}this.timeStamp=src&&src.timeStamp||jQuery.now();this[jQuery.expando]=true};jQuery.Event.prototype={isDefaultPrevented:returnFalse,isPropagationStopped:returnFalse,isImmediatePropagationStopped:returnFalse,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=returnTrue;if(!e){return}if(e.preventDefault){e.preventDefault()}else{e.returnValue=false}},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=returnTrue;if(!e){return}if(e.stopPropagation){e.stopPropagation()}e.cancelBubble=true},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=returnTrue;if(e&&e.stopImmediatePropagation){e.stopImmediatePropagation()}this.stopPropagation()}};jQuery.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(orig,fix){jQuery.event.special[orig]={delegateType:fix,bindType:fix,handle:function(event){var ret,target=this,related=event.relatedTarget,handleObj=event.handleObj;if(!related||related!==target&&!jQuery.contains(target,related)){event.type=handleObj.origType;ret=handleObj.handler.apply(this,arguments);event.type=fix}return ret}}});if(!support.submitBubbles){jQuery.event.special.submit={setup:function(){if(jQuery.nodeName(this,"form")){return false}jQuery.event.add(this,"click._submit keypress._submit",function(e){var elem=e.target,form=jQuery.nodeName(elem,"input")||jQuery.nodeName(elem,"button")?elem.form:undefined;if(form&&!jQuery._data(form,"submitBubbles")){jQuery.event.add(form,"submit._submit",function(event){event._submit_bubble=true});jQuery._data(form,"submitBubbles",true)}})},postDispatch:function(event){if(event._submit_bubble){delete event._submit_bubble;if(this.parentNode&&!event.isTrigger){jQuery.event.simulate("submit",this.parentNode,event,true)}}},teardown:function(){if(jQuery.nodeName(this,"form")){return false}jQuery.event.remove(this,"._submit")}}}if(!support.changeBubbles){jQuery.event.special.change={setup:function(){if(rformElems.test(this.nodeName)){if(this.type==="checkbox"||this.type==="radio"){jQuery.event.add(this,"propertychange._change",function(event){if(event.originalEvent.propertyName==="checked"){this._just_changed=true}});jQuery.event.add(this,"click._change",function(event){if(this._just_changed&&!event.isTrigger){this._just_changed=false}jQuery.event.simulate("change",this,event,true)})}return false}jQuery.event.add(this,"beforeactivate._change",function(e){var elem=e.target;if(rformElems.test(elem.nodeName)&&!jQuery._data(elem,"changeBubbles")){jQuery.event.add(elem,"change._change",function(event){if(this.parentNode&&!event.isSimulated&&!event.isTrigger){jQuery.event.simulate("change",this.parentNode,event,true)}});jQuery._data(elem,"changeBubbles",true)}})},handle:function(event){var elem=event.target;if(this!==elem||event.isSimulated||event.isTrigger||elem.type!=="radio"&&elem.type!=="checkbox"){return event.handleObj.handler.apply(this,arguments)}},teardown:function(){jQuery.event.remove(this,"._change");return!rformElems.test(this.nodeName)}}}if(!support.focusinBubbles){jQuery.each({focus:"focusin",blur:"focusout"},function(orig,fix){var handler=function(event){jQuery.event.simulate(fix,event.target,jQuery.event.fix(event),true)};jQuery.event.special[fix]={setup:function(){var doc=this.ownerDocument||this,attaches=jQuery._data(doc,fix);if(!attaches){doc.addEventListener(orig,handler,true)}jQuery._data(doc,fix,(attaches||0)+1)},teardown:function(){var doc=this.ownerDocument||this,attaches=jQuery._data(doc,fix)-1;if(!attaches){doc.removeEventListener(orig,handler,true);jQuery._removeData(doc,fix)}else{jQuery._data(doc,fix,attaches)}}}})}jQuery.fn.extend({on:function(types,selector,data,fn,one){var type,origFn;if(typeof types==="object"){if(typeof selector!=="string"){data=data||selector;selector=undefined}for(type in types){this.on(type,selector,data,types[type],one)}return this}if(data==null&&fn==null){fn=selector;data=selector=undefined}else if(fn==null){if(typeof selector==="string"){fn=data;data=undefined}else{fn=data;data=selector;selector=undefined}}if(fn===false){fn=returnFalse}else if(!fn){return this}if(one===1){origFn=fn;fn=function(event){jQuery().off(event);return origFn.apply(this,arguments)};fn.guid=origFn.guid||(origFn.guid=jQuery.guid++)}return this.each(function(){jQuery.event.add(this,types,fn,data,selector)})},one:function(types,selector,data,fn){return this.on(types,selector,data,fn,1)},off:function(types,selector,fn){var handleObj,type;if(types&&types.preventDefault&&types.handleObj){handleObj=types.handleObj;jQuery(types.delegateTarget).off(handleObj.namespace?handleObj.origType+"."+handleObj.namespace:handleObj.origType,handleObj.selector,handleObj.handler);return this}if(typeof types==="object"){for(type in types){this.off(type,selector,types[type])}return this}if(selector===false||typeof selector==="function"){fn=selector;selector=undefined}if(fn===false){fn=returnFalse}return this.each(function(){jQuery.event.remove(this,types,fn,selector)})},trigger:function(type,data){return this.each(function(){jQuery.event.trigger(type,data,this)})},triggerHandler:function(type,data){var elem=this[0];if(elem){return jQuery.event.trigger(type,data,elem,true)}}});function createSafeFragment(document){var list=nodeNames.split("|"),safeFrag=document.createDocumentFragment();if(safeFrag.createElement){while(list.length){safeFrag.createElement(list.pop())}}return safeFrag}var nodeNames="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|"+"header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",rinlinejQuery=/ jQuery\d+="(?:null|\d+)"/g,rnoshimcache=new RegExp("<(?:"+nodeNames+")[\\s/>]","i"),rleadingWhitespace=/^\s+/,rxhtmlTag=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,rtagName=/<([\w:]+)/,rtbody=/<tbody/i,rhtml=/<|&#?\w+;/,rnoInnerhtml=/<(?:script|style|link)/i,rchecked=/checked\s*(?:[^=]|=\s*.checked.)/i,rscriptType=/^$|\/(?:java|ecma)script/i,rscriptTypeMasked=/^true\/(.*)/,rcleanScript=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,wrapMap={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:support.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},safeFragment=createSafeFragment(document),fragmentDiv=safeFragment.appendChild(document.createElement("div"));wrapMap.optgroup=wrapMap.option;wrapMap.tbody=wrapMap.tfoot=wrapMap.colgroup=wrapMap.caption=wrapMap.thead;wrapMap.th=wrapMap.td;function getAll(context,tag){var elems,elem,i=0,found=typeof context.getElementsByTagName!==strundefined?context.getElementsByTagName(tag||"*"):typeof context.querySelectorAll!==strundefined?context.querySelectorAll(tag||"*"):undefined;if(!found){for(found=[],elems=context.childNodes||context;(elem=elems[i])!=null;i++){if(!tag||jQuery.nodeName(elem,tag)){found.push(elem)}else{jQuery.merge(found,getAll(elem,tag))}}}return tag===undefined||tag&&jQuery.nodeName(context,tag)?jQuery.merge([context],found):found}function fixDefaultChecked(elem){if(rcheckableType.test(elem.type)){elem.defaultChecked=elem.checked}}function manipulationTarget(elem,content){return jQuery.nodeName(elem,"table")&&jQuery.nodeName(content.nodeType!==11?content:content.firstChild,"tr")?elem.getElementsByTagName("tbody")[0]||elem.appendChild(elem.ownerDocument.createElement("tbody")):elem}function disableScript(elem){elem.type=(jQuery.find.attr(elem,"type")!==null)+"/"+elem.type;return elem}function restoreScript(elem){var match=rscriptTypeMasked.exec(elem.type);if(match){elem.type=match[1]}else{elem.removeAttribute("type")}return elem}function setGlobalEval(elems,refElements){var elem,i=0;for(;(elem=elems[i])!=null;i++){jQuery._data(elem,"globalEval",!refElements||jQuery._data(refElements[i],"globalEval"))}}function cloneCopyEvent(src,dest){if(dest.nodeType!==1||!jQuery.hasData(src)){return}var type,i,l,oldData=jQuery._data(src),curData=jQuery._data(dest,oldData),events=oldData.events;if(events){delete curData.handle;curData.events={};for(type in events){for(i=0,l=events[type].length;i<l;i++){jQuery.event.add(dest,type,events[type][i])}}}if(curData.data){curData.data=jQuery.extend({},curData.data)}}function fixCloneNodeIssues(src,dest){var nodeName,e,data;if(dest.nodeType!==1){return}nodeName=dest.nodeName.toLowerCase();if(!support.noCloneEvent&&dest[jQuery.expando]){data=jQuery._data(dest);for(e in data.events){jQuery.removeEvent(dest,e,data.handle)}dest.removeAttribute(jQuery.expando)}if(nodeName==="script"&&dest.text!==src.text){disableScript(dest).text=src.text;restoreScript(dest)}else if(nodeName==="object"){if(dest.parentNode){dest.outerHTML=src.outerHTML}if(support.html5Clone&&(src.innerHTML&&!jQuery.trim(dest.innerHTML))){dest.innerHTML=src.innerHTML}}else if(nodeName==="input"&&rcheckableType.test(src.type)){dest.defaultChecked=dest.checked=src.checked;if(dest.value!==src.value){dest.value=src.value}}else if(nodeName==="option"){dest.defaultSelected=dest.selected=src.defaultSelected}else if(nodeName==="input"||nodeName==="textarea"){dest.defaultValue=src.defaultValue}}jQuery.extend({clone:function(elem,dataAndEvents,deepDataAndEvents){var destElements,node,clone,i,srcElements,inPage=jQuery.contains(elem.ownerDocument,elem);if(support.html5Clone||jQuery.isXMLDoc(elem)||!rnoshimcache.test("<"+elem.nodeName+">")){clone=elem.cloneNode(true)}else{fragmentDiv.innerHTML=elem.outerHTML;fragmentDiv.removeChild(clone=fragmentDiv.firstChild)}if((!support.noCloneEvent||!support.noCloneChecked)&&(elem.nodeType===1||elem.nodeType===11)&&!jQuery.isXMLDoc(elem)){destElements=getAll(clone);srcElements=getAll(elem);for(i=0;(node=srcElements[i])!=null;++i){if(destElements[i]){fixCloneNodeIssues(node,destElements[i])}}}if(dataAndEvents){if(deepDataAndEvents){srcElements=srcElements||getAll(elem);destElements=destElements||getAll(clone);for(i=0;(node=srcElements[i])!=null;i++){cloneCopyEvent(node,destElements[i])}}else{cloneCopyEvent(elem,clone)}}destElements=getAll(clone,"script");if(destElements.length>0){setGlobalEval(destElements,!inPage&&getAll(elem,"script"))}destElements=srcElements=node=null;return clone},buildFragment:function(elems,context,scripts,selection){var j,elem,contains,tmp,tag,tbody,wrap,l=elems.length,safe=createSafeFragment(context),nodes=[],i=0;for(;i<l;i++){elem=elems[i];if(elem||elem===0){if(jQuery.type(elem)==="object"){jQuery.merge(nodes,elem.nodeType?[elem]:elem)}else if(!rhtml.test(elem)){nodes.push(context.createTextNode(elem))}else{tmp=tmp||safe.appendChild(context.createElement("div"));tag=(rtagName.exec(elem)||["",""])[1].toLowerCase();wrap=wrapMap[tag]||wrapMap._default;tmp.innerHTML=wrap[1]+elem.replace(rxhtmlTag,"<$1></$2>")+wrap[2];j=wrap[0];while(j--){tmp=tmp.lastChild}if(!support.leadingWhitespace&&rleadingWhitespace.test(elem)){nodes.push(context.createTextNode(rleadingWhitespace.exec(elem)[0]))}if(!support.tbody){elem=tag==="table"&&!rtbody.test(elem)?tmp.firstChild:wrap[1]==="<table>"&&!rtbody.test(elem)?tmp:0;j=elem&&elem.childNodes.length;while(j--){if(jQuery.nodeName(tbody=elem.childNodes[j],"tbody")&&!tbody.childNodes.length){elem.removeChild(tbody)}}}jQuery.merge(nodes,tmp.childNodes);tmp.textContent="";while(tmp.firstChild){tmp.removeChild(tmp.firstChild)}tmp=safe.lastChild}}}if(tmp){safe.removeChild(tmp)}if(!support.appendChecked){jQuery.grep(getAll(nodes,"input"),fixDefaultChecked)}i=0;while(elem=nodes[i++]){if(selection&&jQuery.inArray(elem,selection)!==-1){continue}contains=jQuery.contains(elem.ownerDocument,elem);tmp=getAll(safe.appendChild(elem),"script");if(contains){setGlobalEval(tmp)}if(scripts){j=0;while(elem=tmp[j++]){if(rscriptType.test(elem.type||"")){scripts.push(elem)}}}}tmp=null;return safe},cleanData:function(elems,acceptData){var elem,type,id,data,i=0,internalKey=jQuery.expando,cache=jQuery.cache,deleteExpando=support.deleteExpando,special=jQuery.event.special;for(;(elem=elems[i])!=null;i++){if(acceptData||jQuery.acceptData(elem)){id=elem[internalKey];data=id&&cache[id];if(data){if(data.events){for(type in data.events){if(special[type]){jQuery.event.remove(elem,type)}else{jQuery.removeEvent(elem,type,data.handle)}}}if(cache[id]){delete cache[id];if(deleteExpando){delete elem[internalKey]}else if(typeof elem.removeAttribute!==strundefined){elem.removeAttribute(internalKey)}else{elem[internalKey]=null}deletedIds.push(id)}}}}}});jQuery.fn.extend({text:function(value){return access(this,function(value){return value===undefined?jQuery.text(this):this.empty().append((this[0]&&this[0].ownerDocument||document).createTextNode(value))},null,value,arguments.length)},append:function(){return this.domManip(arguments,function(elem){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var target=manipulationTarget(this,elem);target.appendChild(elem)}})},prepend:function(){return this.domManip(arguments,function(elem){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var target=manipulationTarget(this,elem);target.insertBefore(elem,target.firstChild)}})},before:function(){return this.domManip(arguments,function(elem){if(this.parentNode){this.parentNode.insertBefore(elem,this)}})},after:function(){return this.domManip(arguments,function(elem){if(this.parentNode){this.parentNode.insertBefore(elem,this.nextSibling)}})},remove:function(selector,keepData){var elem,elems=selector?jQuery.filter(selector,this):this,i=0;for(;(elem=elems[i])!=null;i++){if(!keepData&&elem.nodeType===1){jQuery.cleanData(getAll(elem))}if(elem.parentNode){if(keepData&&jQuery.contains(elem.ownerDocument,elem)){setGlobalEval(getAll(elem,"script"))}elem.parentNode.removeChild(elem)}}return this},empty:function(){var elem,i=0;for(;(elem=this[i])!=null;i++){if(elem.nodeType===1){jQuery.cleanData(getAll(elem,false))}while(elem.firstChild){elem.removeChild(elem.firstChild)}if(elem.options&&jQuery.nodeName(elem,"select")){elem.options.length=0}}return this},clone:function(dataAndEvents,deepDataAndEvents){dataAndEvents=dataAndEvents==null?false:dataAndEvents;deepDataAndEvents=deepDataAndEvents==null?dataAndEvents:deepDataAndEvents;return this.map(function(){return jQuery.clone(this,dataAndEvents,deepDataAndEvents)})},html:function(value){return access(this,function(value){var elem=this[0]||{},i=0,l=this.length;if(value===undefined){return elem.nodeType===1?elem.innerHTML.replace(rinlinejQuery,""):undefined}if(typeof value==="string"&&!rnoInnerhtml.test(value)&&(support.htmlSerialize||!rnoshimcache.test(value))&&(support.leadingWhitespace||!rleadingWhitespace.test(value))&&!wrapMap[(rtagName.exec(value)||["",""])[1].toLowerCase()]){value=value.replace(rxhtmlTag,"<$1></$2>");try{for(;i<l;i++){elem=this[i]||{};if(elem.nodeType===1){jQuery.cleanData(getAll(elem,false));elem.innerHTML=value}}elem=0}catch(e){}}if(elem){this.empty().append(value)}},null,value,arguments.length)},replaceWith:function(){var arg=arguments[0];this.domManip(arguments,function(elem){arg=this.parentNode;jQuery.cleanData(getAll(this));if(arg){arg.replaceChild(elem,this)}});return arg&&(arg.length||arg.nodeType)?this:this.remove()},detach:function(selector){return this.remove(selector,true)},domManip:function(args,callback){args=concat.apply([],args);var first,node,hasScripts,scripts,doc,fragment,i=0,l=this.length,set=this,iNoClone=l-1,value=args[0],isFunction=jQuery.isFunction(value);if(isFunction||l>1&&typeof value==="string"&&!support.checkClone&&rchecked.test(value)){return this.each(function(index){var self=set.eq(index);if(isFunction){args[0]=value.call(this,index,self.html())}self.domManip(args,callback)})}if(l){fragment=jQuery.buildFragment(args,this[0].ownerDocument,false,this);first=fragment.firstChild;if(fragment.childNodes.length===1){fragment=first}if(first){scripts=jQuery.map(getAll(fragment,"script"),disableScript);hasScripts=scripts.length;for(;i<l;i++){node=fragment;if(i!==iNoClone){node=jQuery.clone(node,true,true);if(hasScripts){jQuery.merge(scripts,getAll(node,"script"))}}callback.call(this[i],node,i)}if(hasScripts){doc=scripts[scripts.length-1].ownerDocument;jQuery.map(scripts,restoreScript);for(i=0;i<hasScripts;i++){node=scripts[i];if(rscriptType.test(node.type||"")&&!jQuery._data(node,"globalEval")&&jQuery.contains(doc,node)){if(node.src){if(jQuery._evalUrl){jQuery._evalUrl(node.src)}}else{jQuery.globalEval((node.text||node.textContent||node.innerHTML||"").replace(rcleanScript,""))}}}}fragment=first=null}}return this}});jQuery.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(name,original){jQuery.fn[name]=function(selector){var elems,i=0,ret=[],insert=jQuery(selector),last=insert.length-1;for(;i<=last;i++){elems=i===last?this:this.clone(true);jQuery(insert[i])[original](elems);push.apply(ret,elems.get())}return this.pushStack(ret)}});var iframe,elemdisplay={};function actualDisplay(name,doc){var style,elem=jQuery(doc.createElement(name)).appendTo(doc.body),display=window.getDefaultComputedStyle&&(style=window.getDefaultComputedStyle(elem[0]))?style.display:jQuery.css(elem[0],"display");elem.detach();return display}function defaultDisplay(nodeName){var doc=document,display=elemdisplay[nodeName];if(!display){display=actualDisplay(nodeName,doc);if(display==="none"||!display){iframe=(iframe||jQuery("<iframe frameborder='0' width='0' height='0'/>")).appendTo(doc.documentElement);doc=(iframe[0].contentWindow||iframe[0].contentDocument).document;doc.write();doc.close();display=actualDisplay(nodeName,doc);iframe.detach()}elemdisplay[nodeName]=display}return display;
}(function(){var shrinkWrapBlocksVal;support.shrinkWrapBlocks=function(){if(shrinkWrapBlocksVal!=null){return shrinkWrapBlocksVal}shrinkWrapBlocksVal=false;var div,body,container;body=document.getElementsByTagName("body")[0];if(!body||!body.style){return}div=document.createElement("div");container=document.createElement("div");container.style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px";body.appendChild(container).appendChild(div);if(typeof div.style.zoom!==strundefined){div.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;"+"box-sizing:content-box;display:block;margin:0;border:0;"+"padding:1px;width:1px;zoom:1";div.appendChild(document.createElement("div")).style.width="5px";shrinkWrapBlocksVal=div.offsetWidth!==3}body.removeChild(container);return shrinkWrapBlocksVal}})();var rmargin=/^margin/;var rnumnonpx=new RegExp("^("+pnum+")(?!px)[a-z%]+$","i");var getStyles,curCSS,rposition=/^(top|right|bottom|left)$/;if(window.getComputedStyle){getStyles=function(elem){return elem.ownerDocument.defaultView.getComputedStyle(elem,null)};curCSS=function(elem,name,computed){var width,minWidth,maxWidth,ret,style=elem.style;computed=computed||getStyles(elem);ret=computed?computed.getPropertyValue(name)||computed[name]:undefined;if(computed){if(ret===""&&!jQuery.contains(elem.ownerDocument,elem)){ret=jQuery.style(elem,name)}if(rnumnonpx.test(ret)&&rmargin.test(name)){width=style.width;minWidth=style.minWidth;maxWidth=style.maxWidth;style.minWidth=style.maxWidth=style.width=ret;ret=computed.width;style.width=width;style.minWidth=minWidth;style.maxWidth=maxWidth}}return ret===undefined?ret:ret+""}}else if(document.documentElement.currentStyle){getStyles=function(elem){return elem.currentStyle};curCSS=function(elem,name,computed){var left,rs,rsLeft,ret,style=elem.style;computed=computed||getStyles(elem);ret=computed?computed[name]:undefined;if(ret==null&&style&&style[name]){ret=style[name]}if(rnumnonpx.test(ret)&&!rposition.test(name)){left=style.left;rs=elem.runtimeStyle;rsLeft=rs&&rs.left;if(rsLeft){rs.left=elem.currentStyle.left}style.left=name==="fontSize"?"1em":ret;ret=style.pixelLeft+"px";style.left=left;if(rsLeft){rs.left=rsLeft}}return ret===undefined?ret:ret+""||"auto"}}function addGetHookIf(conditionFn,hookFn){return{get:function(){var condition=conditionFn();if(condition==null){return}if(condition){delete this.get;return}return(this.get=hookFn).apply(this,arguments)}}}(function(){var div,style,a,pixelPositionVal,boxSizingReliableVal,reliableHiddenOffsetsVal,reliableMarginRightVal;div=document.createElement("div");div.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>";a=div.getElementsByTagName("a")[0];style=a&&a.style;if(!style){return}style.cssText="float:left;opacity:.5";support.opacity=style.opacity==="0.5";support.cssFloat=!!style.cssFloat;div.style.backgroundClip="content-box";div.cloneNode(true).style.backgroundClip="";support.clearCloneStyle=div.style.backgroundClip==="content-box";support.boxSizing=style.boxSizing===""||style.MozBoxSizing===""||style.WebkitBoxSizing==="";jQuery.extend(support,{reliableHiddenOffsets:function(){if(reliableHiddenOffsetsVal==null){computeStyleTests()}return reliableHiddenOffsetsVal},boxSizingReliable:function(){if(boxSizingReliableVal==null){computeStyleTests()}return boxSizingReliableVal},pixelPosition:function(){if(pixelPositionVal==null){computeStyleTests()}return pixelPositionVal},reliableMarginRight:function(){if(reliableMarginRightVal==null){computeStyleTests()}return reliableMarginRightVal}});function computeStyleTests(){var div,body,container,contents;body=document.getElementsByTagName("body")[0];if(!body||!body.style){return}div=document.createElement("div");container=document.createElement("div");container.style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px";body.appendChild(container).appendChild(div);div.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;"+"box-sizing:border-box;display:block;margin-top:1%;top:1%;"+"border:1px;padding:1px;width:4px;position:absolute";pixelPositionVal=boxSizingReliableVal=false;reliableMarginRightVal=true;if(window.getComputedStyle){pixelPositionVal=(window.getComputedStyle(div,null)||{}).top!=="1%";boxSizingReliableVal=(window.getComputedStyle(div,null)||{width:"4px"}).width==="4px";contents=div.appendChild(document.createElement("div"));contents.style.cssText=div.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;"+"box-sizing:content-box;display:block;margin:0;border:0;padding:0";contents.style.marginRight=contents.style.width="0";div.style.width="1px";reliableMarginRightVal=!parseFloat((window.getComputedStyle(contents,null)||{}).marginRight)}div.innerHTML="<table><tr><td></td><td>t</td></tr></table>";contents=div.getElementsByTagName("td");contents[0].style.cssText="margin:0;border:0;padding:0;display:none";reliableHiddenOffsetsVal=contents[0].offsetHeight===0;if(reliableHiddenOffsetsVal){contents[0].style.display="";contents[1].style.display="none";reliableHiddenOffsetsVal=contents[0].offsetHeight===0}body.removeChild(container)}})();jQuery.swap=function(elem,options,callback,args){var ret,name,old={};for(name in options){old[name]=elem.style[name];elem.style[name]=options[name]}ret=callback.apply(elem,args||[]);for(name in options){elem.style[name]=old[name]}return ret};var ralpha=/alpha\([^)]*\)/i,ropacity=/opacity\s*=\s*([^)]*)/,rdisplayswap=/^(none|table(?!-c[ea]).+)/,rnumsplit=new RegExp("^("+pnum+")(.*)$","i"),rrelNum=new RegExp("^([+-])=("+pnum+")","i"),cssShow={position:"absolute",visibility:"hidden",display:"block"},cssNormalTransform={letterSpacing:"0",fontWeight:"400"},cssPrefixes=["Webkit","O","Moz","ms"];function vendorPropName(style,name){if(name in style){return name}var capName=name.charAt(0).toUpperCase()+name.slice(1),origName=name,i=cssPrefixes.length;while(i--){name=cssPrefixes[i]+capName;if(name in style){return name}}return origName}function showHide(elements,show){var display,elem,hidden,values=[],index=0,length=elements.length;for(;index<length;index++){elem=elements[index];if(!elem.style){continue}values[index]=jQuery._data(elem,"olddisplay");display=elem.style.display;if(show){if(!values[index]&&display==="none"){elem.style.display=""}if(elem.style.display===""&&isHidden(elem)){values[index]=jQuery._data(elem,"olddisplay",defaultDisplay(elem.nodeName))}}else{hidden=isHidden(elem);if(display&&display!=="none"||!hidden){jQuery._data(elem,"olddisplay",hidden?display:jQuery.css(elem,"display"))}}}for(index=0;index<length;index++){elem=elements[index];if(!elem.style){continue}if(!show||elem.style.display==="none"||elem.style.display===""){elem.style.display=show?values[index]||"":"none"}}return elements}function setPositiveNumber(elem,value,subtract){var matches=rnumsplit.exec(value);return matches?Math.max(0,matches[1]-(subtract||0))+(matches[2]||"px"):value}function augmentWidthOrHeight(elem,name,extra,isBorderBox,styles){var i=extra===(isBorderBox?"border":"content")?4:name==="width"?1:0,val=0;for(;i<4;i+=2){if(extra==="margin"){val+=jQuery.css(elem,extra+cssExpand[i],true,styles)}if(isBorderBox){if(extra==="content"){val-=jQuery.css(elem,"padding"+cssExpand[i],true,styles)}if(extra!=="margin"){val-=jQuery.css(elem,"border"+cssExpand[i]+"Width",true,styles)}}else{val+=jQuery.css(elem,"padding"+cssExpand[i],true,styles);if(extra!=="padding"){val+=jQuery.css(elem,"border"+cssExpand[i]+"Width",true,styles)}}}return val}function getWidthOrHeight(elem,name,extra){var valueIsBorderBox=true,val=name==="width"?elem.offsetWidth:elem.offsetHeight,styles=getStyles(elem),isBorderBox=support.boxSizing&&jQuery.css(elem,"boxSizing",false,styles)==="border-box";if(val<=0||val==null){val=curCSS(elem,name,styles);if(val<0||val==null){val=elem.style[name]}if(rnumnonpx.test(val)){return val}valueIsBorderBox=isBorderBox&&(support.boxSizingReliable()||val===elem.style[name]);val=parseFloat(val)||0}return val+augmentWidthOrHeight(elem,name,extra||(isBorderBox?"border":"content"),valueIsBorderBox,styles)+"px"}jQuery.extend({cssHooks:{opacity:{get:function(elem,computed){if(computed){var ret=curCSS(elem,"opacity");return ret===""?"1":ret}}}},cssNumber:{columnCount:true,fillOpacity:true,flexGrow:true,flexShrink:true,fontWeight:true,lineHeight:true,opacity:true,order:true,orphans:true,widows:true,zIndex:true,zoom:true},cssProps:{"float":support.cssFloat?"cssFloat":"styleFloat"},style:function(elem,name,value,extra){if(!elem||elem.nodeType===3||elem.nodeType===8||!elem.style){return}var ret,type,hooks,origName=jQuery.camelCase(name),style=elem.style;name=jQuery.cssProps[origName]||(jQuery.cssProps[origName]=vendorPropName(style,origName));hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName];if(value!==undefined){type=typeof value;if(type==="string"&&(ret=rrelNum.exec(value))){value=(ret[1]+1)*ret[2]+parseFloat(jQuery.css(elem,name));type="number"}if(value==null||value!==value){return}if(type==="number"&&!jQuery.cssNumber[origName]){value+="px"}if(!support.clearCloneStyle&&value===""&&name.indexOf("background")===0){style[name]="inherit"}if(!hooks||!("set"in hooks)||(value=hooks.set(elem,value,extra))!==undefined){try{style[name]=value}catch(e){}}}else{if(hooks&&"get"in hooks&&(ret=hooks.get(elem,false,extra))!==undefined){return ret}return style[name]}},css:function(elem,name,extra,styles){var num,val,hooks,origName=jQuery.camelCase(name);name=jQuery.cssProps[origName]||(jQuery.cssProps[origName]=vendorPropName(elem.style,origName));hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName];if(hooks&&"get"in hooks){val=hooks.get(elem,true,extra)}if(val===undefined){val=curCSS(elem,name,styles)}if(val==="normal"&&name in cssNormalTransform){val=cssNormalTransform[name]}if(extra===""||extra){num=parseFloat(val);return extra===true||jQuery.isNumeric(num)?num||0:val}return val}});jQuery.each(["height","width"],function(i,name){jQuery.cssHooks[name]={get:function(elem,computed,extra){if(computed){return rdisplayswap.test(jQuery.css(elem,"display"))&&elem.offsetWidth===0?jQuery.swap(elem,cssShow,function(){return getWidthOrHeight(elem,name,extra)}):getWidthOrHeight(elem,name,extra)}},set:function(elem,value,extra){var styles=extra&&getStyles(elem);return setPositiveNumber(elem,value,extra?augmentWidthOrHeight(elem,name,extra,support.boxSizing&&jQuery.css(elem,"boxSizing",false,styles)==="border-box",styles):0)}}});if(!support.opacity){jQuery.cssHooks.opacity={get:function(elem,computed){return ropacity.test((computed&&elem.currentStyle?elem.currentStyle.filter:elem.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":computed?"1":""},set:function(elem,value){var style=elem.style,currentStyle=elem.currentStyle,opacity=jQuery.isNumeric(value)?"alpha(opacity="+value*100+")":"",filter=currentStyle&&currentStyle.filter||style.filter||"";style.zoom=1;if((value>=1||value==="")&&jQuery.trim(filter.replace(ralpha,""))===""&&style.removeAttribute){style.removeAttribute("filter");if(value===""||currentStyle&&!currentStyle.filter){return}}style.filter=ralpha.test(filter)?filter.replace(ralpha,opacity):filter+" "+opacity}}}jQuery.cssHooks.marginRight=addGetHookIf(support.reliableMarginRight,function(elem,computed){if(computed){return jQuery.swap(elem,{display:"inline-block"},curCSS,[elem,"marginRight"])}});jQuery.each({margin:"",padding:"",border:"Width"},function(prefix,suffix){jQuery.cssHooks[prefix+suffix]={expand:function(value){var i=0,expanded={},parts=typeof value==="string"?value.split(" "):[value];for(;i<4;i++){expanded[prefix+cssExpand[i]+suffix]=parts[i]||parts[i-2]||parts[0]}return expanded}};if(!rmargin.test(prefix)){jQuery.cssHooks[prefix+suffix].set=setPositiveNumber}});jQuery.fn.extend({css:function(name,value){return access(this,function(elem,name,value){var styles,len,map={},i=0;if(jQuery.isArray(name)){styles=getStyles(elem);len=name.length;for(;i<len;i++){map[name[i]]=jQuery.css(elem,name[i],false,styles)}return map}return value!==undefined?jQuery.style(elem,name,value):jQuery.css(elem,name)},name,value,arguments.length>1)},show:function(){return showHide(this,true)},hide:function(){return showHide(this)},toggle:function(state){if(typeof state==="boolean"){return state?this.show():this.hide()}return this.each(function(){if(isHidden(this)){jQuery(this).show()}else{jQuery(this).hide()}})}});function Tween(elem,options,prop,end,easing){return new Tween.prototype.init(elem,options,prop,end,easing)}jQuery.Tween=Tween;Tween.prototype={constructor:Tween,init:function(elem,options,prop,end,easing,unit){this.elem=elem;this.prop=prop;this.easing=easing||"swing";this.options=options;this.start=this.now=this.cur();this.end=end;this.unit=unit||(jQuery.cssNumber[prop]?"":"px")},cur:function(){var hooks=Tween.propHooks[this.prop];return hooks&&hooks.get?hooks.get(this):Tween.propHooks._default.get(this)},run:function(percent){var eased,hooks=Tween.propHooks[this.prop];if(this.options.duration){this.pos=eased=jQuery.easing[this.easing](percent,this.options.duration*percent,0,1,this.options.duration)}else{this.pos=eased=percent}this.now=(this.end-this.start)*eased+this.start;if(this.options.step){this.options.step.call(this.elem,this.now,this)}if(hooks&&hooks.set){hooks.set(this)}else{Tween.propHooks._default.set(this)}return this}};Tween.prototype.init.prototype=Tween.prototype;Tween.propHooks={_default:{get:function(tween){var result;if(tween.elem[tween.prop]!=null&&(!tween.elem.style||tween.elem.style[tween.prop]==null)){return tween.elem[tween.prop]}result=jQuery.css(tween.elem,tween.prop,"");return!result||result==="auto"?0:result},set:function(tween){if(jQuery.fx.step[tween.prop]){jQuery.fx.step[tween.prop](tween)}else if(tween.elem.style&&(tween.elem.style[jQuery.cssProps[tween.prop]]!=null||jQuery.cssHooks[tween.prop])){jQuery.style(tween.elem,tween.prop,tween.now+tween.unit)}else{tween.elem[tween.prop]=tween.now}}}};Tween.propHooks.scrollTop=Tween.propHooks.scrollLeft={set:function(tween){if(tween.elem.nodeType&&tween.elem.parentNode){tween.elem[tween.prop]=tween.now}}};jQuery.easing={linear:function(p){return p},swing:function(p){return.5-Math.cos(p*Math.PI)/2}};jQuery.fx=Tween.prototype.init;jQuery.fx.step={};var fxNow,timerId,rfxtypes=/^(?:toggle|show|hide)$/,rfxnum=new RegExp("^(?:([+-])=|)("+pnum+")([a-z%]*)$","i"),rrun=/queueHooks$/,animationPrefilters=[defaultPrefilter],tweeners={"*":[function(prop,value){var tween=this.createTween(prop,value),target=tween.cur(),parts=rfxnum.exec(value),unit=parts&&parts[3]||(jQuery.cssNumber[prop]?"":"px"),start=(jQuery.cssNumber[prop]||unit!=="px"&&+target)&&rfxnum.exec(jQuery.css(tween.elem,prop)),scale=1,maxIterations=20;if(start&&start[3]!==unit){unit=unit||start[3];parts=parts||[];start=+target||1;do{scale=scale||".5";start=start/scale;jQuery.style(tween.elem,prop,start+unit)}while(scale!==(scale=tween.cur()/target)&&scale!==1&&--maxIterations)}if(parts){start=tween.start=+start||+target||0;tween.unit=unit;tween.end=parts[1]?start+(parts[1]+1)*parts[2]:+parts[2]}return tween}]};function createFxNow(){setTimeout(function(){fxNow=undefined});return fxNow=jQuery.now()}function genFx(type,includeWidth){var which,attrs={height:type},i=0;includeWidth=includeWidth?1:0;for(;i<4;i+=2-includeWidth){which=cssExpand[i];attrs["margin"+which]=attrs["padding"+which]=type}if(includeWidth){attrs.opacity=attrs.width=type}return attrs}function createTween(value,prop,animation){var tween,collection=(tweeners[prop]||[]).concat(tweeners["*"]),index=0,length=collection.length;for(;index<length;index++){if(tween=collection[index].call(animation,prop,value)){return tween}}}function defaultPrefilter(elem,props,opts){var prop,value,toggle,tween,hooks,oldfire,display,checkDisplay,anim=this,orig={},style=elem.style,hidden=elem.nodeType&&isHidden(elem),dataShow=jQuery._data(elem,"fxshow");if(!opts.queue){hooks=jQuery._queueHooks(elem,"fx");if(hooks.unqueued==null){hooks.unqueued=0;oldfire=hooks.empty.fire;hooks.empty.fire=function(){if(!hooks.unqueued){oldfire()}}}hooks.unqueued++;anim.always(function(){anim.always(function(){hooks.unqueued--;if(!jQuery.queue(elem,"fx").length){hooks.empty.fire()}})})}if(elem.nodeType===1&&("height"in props||"width"in props)){opts.overflow=[style.overflow,style.overflowX,style.overflowY];display=jQuery.css(elem,"display");checkDisplay=display==="none"?jQuery._data(elem,"olddisplay")||defaultDisplay(elem.nodeName):display;if(checkDisplay==="inline"&&jQuery.css(elem,"float")==="none"){if(!support.inlineBlockNeedsLayout||defaultDisplay(elem.nodeName)==="inline"){style.display="inline-block"}else{style.zoom=1}}}if(opts.overflow){style.overflow="hidden";if(!support.shrinkWrapBlocks()){anim.always(function(){style.overflow=opts.overflow[0];style.overflowX=opts.overflow[1];style.overflowY=opts.overflow[2]})}}for(prop in props){value=props[prop];if(rfxtypes.exec(value)){delete props[prop];toggle=toggle||value==="toggle";if(value===(hidden?"hide":"show")){if(value==="show"&&dataShow&&dataShow[prop]!==undefined){hidden=true}else{continue}}orig[prop]=dataShow&&dataShow[prop]||jQuery.style(elem,prop)}else{display=undefined}}if(!jQuery.isEmptyObject(orig)){if(dataShow){if("hidden"in dataShow){hidden=dataShow.hidden}}else{dataShow=jQuery._data(elem,"fxshow",{})}if(toggle){dataShow.hidden=!hidden}if(hidden){jQuery(elem).show()}else{anim.done(function(){jQuery(elem).hide()})}anim.done(function(){var prop;jQuery._removeData(elem,"fxshow");for(prop in orig){jQuery.style(elem,prop,orig[prop])}});for(prop in orig){tween=createTween(hidden?dataShow[prop]:0,prop,anim);if(!(prop in dataShow)){dataShow[prop]=tween.start;if(hidden){tween.end=tween.start;tween.start=prop==="width"||prop==="height"?1:0}}}}else if((display==="none"?defaultDisplay(elem.nodeName):display)==="inline"){style.display=display}}function propFilter(props,specialEasing){var index,name,easing,value,hooks;for(index in props){name=jQuery.camelCase(index);easing=specialEasing[name];value=props[index];if(jQuery.isArray(value)){easing=value[1];value=props[index]=value[0]}if(index!==name){props[name]=value;delete props[index]}hooks=jQuery.cssHooks[name];if(hooks&&"expand"in hooks){value=hooks.expand(value);delete props[name];for(index in value){if(!(index in props)){props[index]=value[index];specialEasing[index]=easing}}}else{specialEasing[name]=easing}}}function Animation(elem,properties,options){var result,stopped,index=0,length=animationPrefilters.length,deferred=jQuery.Deferred().always(function(){delete tick.elem}),tick=function(){if(stopped){return false}var currentTime=fxNow||createFxNow(),remaining=Math.max(0,animation.startTime+animation.duration-currentTime),temp=remaining/animation.duration||0,percent=1-temp,index=0,length=animation.tweens.length;for(;index<length;index++){animation.tweens[index].run(percent)}deferred.notifyWith(elem,[animation,percent,remaining]);if(percent<1&&length){return remaining}else{deferred.resolveWith(elem,[animation]);return false}},animation=deferred.promise({elem:elem,props:jQuery.extend({},properties),opts:jQuery.extend(true,{specialEasing:{}},options),originalProperties:properties,originalOptions:options,startTime:fxNow||createFxNow(),duration:options.duration,tweens:[],createTween:function(prop,end){var tween=jQuery.Tween(elem,animation.opts,prop,end,animation.opts.specialEasing[prop]||animation.opts.easing);animation.tweens.push(tween);return tween},stop:function(gotoEnd){var index=0,length=gotoEnd?animation.tweens.length:0;if(stopped){return this}stopped=true;for(;index<length;index++){animation.tweens[index].run(1)}if(gotoEnd){deferred.resolveWith(elem,[animation,gotoEnd])}else{deferred.rejectWith(elem,[animation,gotoEnd])}return this}}),props=animation.props;propFilter(props,animation.opts.specialEasing);for(;index<length;index++){result=animationPrefilters[index].call(animation,elem,props,animation.opts);if(result){return result}}jQuery.map(props,createTween,animation);if(jQuery.isFunction(animation.opts.start)){animation.opts.start.call(elem,animation)}jQuery.fx.timer(jQuery.extend(tick,{elem:elem,anim:animation,queue:animation.opts.queue}));return animation.progress(animation.opts.progress).done(animation.opts.done,animation.opts.complete).fail(animation.opts.fail).always(animation.opts.always)}jQuery.Animation=jQuery.extend(Animation,{tweener:function(props,callback){if(jQuery.isFunction(props)){callback=props;props=["*"]}else{props=props.split(" ")}var prop,index=0,length=props.length;for(;index<length;index++){prop=props[index];tweeners[prop]=tweeners[prop]||[];tweeners[prop].unshift(callback)}},prefilter:function(callback,prepend){if(prepend){animationPrefilters.unshift(callback)}else{animationPrefilters.push(callback)}}});jQuery.speed=function(speed,easing,fn){var opt=speed&&typeof speed==="object"?jQuery.extend({},speed):{complete:fn||!fn&&easing||jQuery.isFunction(speed)&&speed,duration:speed,easing:fn&&easing||easing&&!jQuery.isFunction(easing)&&easing};opt.duration=jQuery.fx.off?0:typeof opt.duration==="number"?opt.duration:opt.duration in jQuery.fx.speeds?jQuery.fx.speeds[opt.duration]:jQuery.fx.speeds._default;if(opt.queue==null||opt.queue===true){opt.queue="fx"}opt.old=opt.complete;opt.complete=function(){if(jQuery.isFunction(opt.old)){opt.old.call(this)}if(opt.queue){jQuery.dequeue(this,opt.queue)}};return opt};jQuery.fn.extend({fadeTo:function(speed,to,easing,callback){return this.filter(isHidden).css("opacity",0).show().end().animate({opacity:to},speed,easing,callback)},animate:function(prop,speed,easing,callback){var empty=jQuery.isEmptyObject(prop),optall=jQuery.speed(speed,easing,callback),doAnimation=function(){var anim=Animation(this,jQuery.extend({},prop),optall);if(empty||jQuery._data(this,"finish")){anim.stop(true)}};doAnimation.finish=doAnimation;return empty||optall.queue===false?this.each(doAnimation):this.queue(optall.queue,doAnimation)},stop:function(type,clearQueue,gotoEnd){var stopQueue=function(hooks){var stop=hooks.stop;delete hooks.stop;stop(gotoEnd)};if(typeof type!=="string"){gotoEnd=clearQueue;clearQueue=type;type=undefined}if(clearQueue&&type!==false){this.queue(type||"fx",[])}return this.each(function(){var dequeue=true,index=type!=null&&type+"queueHooks",timers=jQuery.timers,data=jQuery._data(this);if(index){if(data[index]&&data[index].stop){stopQueue(data[index])}}else{for(index in data){if(data[index]&&data[index].stop&&rrun.test(index)){stopQueue(data[index])}}}for(index=timers.length;index--;){if(timers[index].elem===this&&(type==null||timers[index].queue===type)){timers[index].anim.stop(gotoEnd);dequeue=false;timers.splice(index,1)}}if(dequeue||!gotoEnd){jQuery.dequeue(this,type)}})},finish:function(type){if(type!==false){type=type||"fx"}return this.each(function(){var index,data=jQuery._data(this),queue=data[type+"queue"],hooks=data[type+"queueHooks"],timers=jQuery.timers,length=queue?queue.length:0;data.finish=true;jQuery.queue(this,type,[]);if(hooks&&hooks.stop){hooks.stop.call(this,true)}for(index=timers.length;index--;){if(timers[index].elem===this&&timers[index].queue===type){timers[index].anim.stop(true);timers.splice(index,1)}}for(index=0;index<length;index++){if(queue[index]&&queue[index].finish){queue[index].finish.call(this)}}delete data.finish})}});jQuery.each(["toggle","show","hide"],function(i,name){var cssFn=jQuery.fn[name];jQuery.fn[name]=function(speed,easing,callback){return speed==null||typeof speed==="boolean"?cssFn.apply(this,arguments):this.animate(genFx(name,true),speed,easing,callback)}});jQuery.each({slideDown:genFx("show"),slideUp:genFx("hide"),slideToggle:genFx("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(name,props){jQuery.fn[name]=function(speed,easing,callback){return this.animate(props,speed,easing,callback)}});jQuery.timers=[];jQuery.fx.tick=function(){var timer,timers=jQuery.timers,i=0;fxNow=jQuery.now();for(;i<timers.length;i++){timer=timers[i];if(!timer()&&timers[i]===timer){timers.splice(i--,1)}}if(!timers.length){jQuery.fx.stop()}fxNow=undefined};jQuery.fx.timer=function(timer){jQuery.timers.push(timer);if(timer()){jQuery.fx.start()}else{jQuery.timers.pop()}};jQuery.fx.interval=13;jQuery.fx.start=function(){if(!timerId){timerId=setInterval(jQuery.fx.tick,jQuery.fx.interval)}};jQuery.fx.stop=function(){clearInterval(timerId);timerId=null};jQuery.fx.speeds={slow:600,fast:200,_default:400};jQuery.fn.delay=function(time,type){time=jQuery.fx?jQuery.fx.speeds[time]||time:time;type=type||"fx";return this.queue(type,function(next,hooks){var timeout=setTimeout(next,time);hooks.stop=function(){clearTimeout(timeout)}})};(function(){var input,div,select,a,opt;div=document.createElement("div");div.setAttribute("className","t");div.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>";a=div.getElementsByTagName("a")[0];select=document.createElement("select");opt=select.appendChild(document.createElement("option"));input=div.getElementsByTagName("input")[0];a.style.cssText="top:1px";support.getSetAttribute=div.className!=="t";support.style=/top/.test(a.getAttribute("style"));support.hrefNormalized=a.getAttribute("href")==="/a";support.checkOn=!!input.value;support.optSelected=opt.selected;support.enctype=!!document.createElement("form").enctype;select.disabled=true;support.optDisabled=!opt.disabled;input=document.createElement("input");input.setAttribute("value","");support.input=input.getAttribute("value")==="";input.value="t";input.setAttribute("type","radio");support.radioValue=input.value==="t"})();var rreturn=/\r/g;jQuery.fn.extend({val:function(value){var hooks,ret,isFunction,elem=this[0];if(!arguments.length){if(elem){hooks=jQuery.valHooks[elem.type]||jQuery.valHooks[elem.nodeName.toLowerCase()];if(hooks&&"get"in hooks&&(ret=hooks.get(elem,"value"))!==undefined){return ret}ret=elem.value;return typeof ret==="string"?ret.replace(rreturn,""):ret==null?"":ret}return}isFunction=jQuery.isFunction(value);return this.each(function(i){var val;if(this.nodeType!==1){return}if(isFunction){val=value.call(this,i,jQuery(this).val())}else{val=value}if(val==null){val=""}else if(typeof val==="number"){val+=""}else if(jQuery.isArray(val)){val=jQuery.map(val,function(value){return value==null?"":value+""})}hooks=jQuery.valHooks[this.type]||jQuery.valHooks[this.nodeName.toLowerCase()];if(!hooks||!("set"in hooks)||hooks.set(this,val,"value")===undefined){this.value=val}})}});jQuery.extend({valHooks:{option:{get:function(elem){var val=jQuery.find.attr(elem,"value");return val!=null?val:jQuery.trim(jQuery.text(elem))}},select:{get:function(elem){var value,option,options=elem.options,index=elem.selectedIndex,one=elem.type==="select-one"||index<0,values=one?null:[],max=one?index+1:options.length,i=index<0?max:one?index:0;for(;i<max;i++){option=options[i];if((option.selected||i===index)&&(support.optDisabled?!option.disabled:option.getAttribute("disabled")===null)&&(!option.parentNode.disabled||!jQuery.nodeName(option.parentNode,"optgroup"))){value=jQuery(option).val();if(one){return value}values.push(value)}}return values},set:function(elem,value){var optionSet,option,options=elem.options,values=jQuery.makeArray(value),i=options.length;while(i--){option=options[i];if(jQuery.inArray(jQuery.valHooks.option.get(option),values)>=0){try{option.selected=optionSet=true}catch(_){option.scrollHeight}}else{option.selected=false}}if(!optionSet){elem.selectedIndex=-1}return options}}}});jQuery.each(["radio","checkbox"],function(){jQuery.valHooks[this]={set:function(elem,value){if(jQuery.isArray(value)){return elem.checked=jQuery.inArray(jQuery(elem).val(),value)>=0}}};if(!support.checkOn){jQuery.valHooks[this].get=function(elem){return elem.getAttribute("value")===null?"on":elem.value}}});var nodeHook,boolHook,attrHandle=jQuery.expr.attrHandle,ruseDefault=/^(?:checked|selected)$/i,getSetAttribute=support.getSetAttribute,getSetInput=support.input;jQuery.fn.extend({attr:function(name,value){return access(this,jQuery.attr,name,value,arguments.length>1)},removeAttr:function(name){return this.each(function(){jQuery.removeAttr(this,name)})}});jQuery.extend({attr:function(elem,name,value){var hooks,ret,nType=elem.nodeType;if(!elem||nType===3||nType===8||nType===2){return}if(typeof elem.getAttribute===strundefined){return jQuery.prop(elem,name,value)}if(nType!==1||!jQuery.isXMLDoc(elem)){name=name.toLowerCase();hooks=jQuery.attrHooks[name]||(jQuery.expr.match.bool.test(name)?boolHook:nodeHook)}if(value!==undefined){if(value===null){jQuery.removeAttr(elem,name)}else if(hooks&&"set"in hooks&&(ret=hooks.set(elem,value,name))!==undefined){return ret}else{elem.setAttribute(name,value+"");return value}}else if(hooks&&"get"in hooks&&(ret=hooks.get(elem,name))!==null){return ret}else{ret=jQuery.find.attr(elem,name);return ret==null?undefined:ret}},removeAttr:function(elem,value){var name,propName,i=0,attrNames=value&&value.match(rnotwhite);if(attrNames&&elem.nodeType===1){while(name=attrNames[i++]){propName=jQuery.propFix[name]||name;if(jQuery.expr.match.bool.test(name)){if(getSetInput&&getSetAttribute||!ruseDefault.test(name)){elem[propName]=false}else{elem[jQuery.camelCase("default-"+name)]=elem[propName]=false}}else{jQuery.attr(elem,name,"")}elem.removeAttribute(getSetAttribute?name:propName)}}},attrHooks:{type:{set:function(elem,value){if(!support.radioValue&&value==="radio"&&jQuery.nodeName(elem,"input")){var val=elem.value;elem.setAttribute("type",value);if(val){elem.value=val}return value}}}}});boolHook={set:function(elem,value,name){if(value===false){jQuery.removeAttr(elem,name)}else if(getSetInput&&getSetAttribute||!ruseDefault.test(name)){elem.setAttribute(!getSetAttribute&&jQuery.propFix[name]||name,name)}else{elem[jQuery.camelCase("default-"+name)]=elem[name]=true}return name}};jQuery.each(jQuery.expr.match.bool.source.match(/\w+/g),function(i,name){var getter=attrHandle[name]||jQuery.find.attr;attrHandle[name]=getSetInput&&getSetAttribute||!ruseDefault.test(name)?function(elem,name,isXML){var ret,handle;if(!isXML){handle=attrHandle[name];attrHandle[name]=ret;ret=getter(elem,name,isXML)!=null?name.toLowerCase():null;attrHandle[name]=handle}return ret}:function(elem,name,isXML){if(!isXML){return elem[jQuery.camelCase("default-"+name)]?name.toLowerCase():null}}});if(!getSetInput||!getSetAttribute){jQuery.attrHooks.value={set:function(elem,value,name){if(jQuery.nodeName(elem,"input")){elem.defaultValue=value}else{return nodeHook&&nodeHook.set(elem,value,name)}}}}if(!getSetAttribute){nodeHook={set:function(elem,value,name){var ret=elem.getAttributeNode(name);if(!ret){elem.setAttributeNode(ret=elem.ownerDocument.createAttribute(name))}ret.value=value+="";if(name==="value"||value===elem.getAttribute(name)){return value}}};attrHandle.id=attrHandle.name=attrHandle.coords=function(elem,name,isXML){var ret;if(!isXML){return(ret=elem.getAttributeNode(name))&&ret.value!==""?ret.value:null}};jQuery.valHooks.button={get:function(elem,name){var ret=elem.getAttributeNode(name);if(ret&&ret.specified){return ret.value}},set:nodeHook.set};jQuery.attrHooks.contenteditable={set:function(elem,value,name){nodeHook.set(elem,value===""?false:value,name)}};jQuery.each(["width","height"],function(i,name){jQuery.attrHooks[name]={set:function(elem,value){if(value===""){elem.setAttribute(name,"auto");return value}}}})}if(!support.style){jQuery.attrHooks.style={get:function(elem){return elem.style.cssText||undefined},set:function(elem,value){return elem.style.cssText=value+""}}}var rfocusable=/^(?:input|select|textarea|button|object)$/i,rclickable=/^(?:a|area)$/i;jQuery.fn.extend({prop:function(name,value){return access(this,jQuery.prop,name,value,arguments.length>1)},removeProp:function(name){name=jQuery.propFix[name]||name;return this.each(function(){try{this[name]=undefined;delete this[name]}catch(e){}})}});jQuery.extend({propFix:{"for":"htmlFor","class":"className"},prop:function(elem,name,value){var ret,hooks,notxml,nType=elem.nodeType;if(!elem||nType===3||nType===8||nType===2){return}notxml=nType!==1||!jQuery.isXMLDoc(elem);if(notxml){name=jQuery.propFix[name]||name;
hooks=jQuery.propHooks[name]}if(value!==undefined){return hooks&&"set"in hooks&&(ret=hooks.set(elem,value,name))!==undefined?ret:elem[name]=value}else{return hooks&&"get"in hooks&&(ret=hooks.get(elem,name))!==null?ret:elem[name]}},propHooks:{tabIndex:{get:function(elem){var tabindex=jQuery.find.attr(elem,"tabindex");return tabindex?parseInt(tabindex,10):rfocusable.test(elem.nodeName)||rclickable.test(elem.nodeName)&&elem.href?0:-1}}}});if(!support.hrefNormalized){jQuery.each(["href","src"],function(i,name){jQuery.propHooks[name]={get:function(elem){return elem.getAttribute(name,4)}}})}if(!support.optSelected){jQuery.propHooks.selected={get:function(elem){var parent=elem.parentNode;if(parent){parent.selectedIndex;if(parent.parentNode){parent.parentNode.selectedIndex}}return null}}}jQuery.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){jQuery.propFix[this.toLowerCase()]=this});if(!support.enctype){jQuery.propFix.enctype="encoding"}var rclass=/[\t\r\n\f]/g;jQuery.fn.extend({addClass:function(value){var classes,elem,cur,clazz,j,finalValue,i=0,len=this.length,proceed=typeof value==="string"&&value;if(jQuery.isFunction(value)){return this.each(function(j){jQuery(this).addClass(value.call(this,j,this.className))})}if(proceed){classes=(value||"").match(rnotwhite)||[];for(;i<len;i++){elem=this[i];cur=elem.nodeType===1&&(elem.className?(" "+elem.className+" ").replace(rclass," "):" ");if(cur){j=0;while(clazz=classes[j++]){if(cur.indexOf(" "+clazz+" ")<0){cur+=clazz+" "}}finalValue=jQuery.trim(cur);if(elem.className!==finalValue){elem.className=finalValue}}}}return this},removeClass:function(value){var classes,elem,cur,clazz,j,finalValue,i=0,len=this.length,proceed=arguments.length===0||typeof value==="string"&&value;if(jQuery.isFunction(value)){return this.each(function(j){jQuery(this).removeClass(value.call(this,j,this.className))})}if(proceed){classes=(value||"").match(rnotwhite)||[];for(;i<len;i++){elem=this[i];cur=elem.nodeType===1&&(elem.className?(" "+elem.className+" ").replace(rclass," "):"");if(cur){j=0;while(clazz=classes[j++]){while(cur.indexOf(" "+clazz+" ")>=0){cur=cur.replace(" "+clazz+" "," ")}}finalValue=value?jQuery.trim(cur):"";if(elem.className!==finalValue){elem.className=finalValue}}}}return this},toggleClass:function(value,stateVal){var type=typeof value;if(typeof stateVal==="boolean"&&type==="string"){return stateVal?this.addClass(value):this.removeClass(value)}if(jQuery.isFunction(value)){return this.each(function(i){jQuery(this).toggleClass(value.call(this,i,this.className,stateVal),stateVal)})}return this.each(function(){if(type==="string"){var className,i=0,self=jQuery(this),classNames=value.match(rnotwhite)||[];while(className=classNames[i++]){if(self.hasClass(className)){self.removeClass(className)}else{self.addClass(className)}}}else if(type===strundefined||type==="boolean"){if(this.className){jQuery._data(this,"__className__",this.className)}this.className=this.className||value===false?"":jQuery._data(this,"__className__")||""}})},hasClass:function(selector){var className=" "+selector+" ",i=0,l=this.length;for(;i<l;i++){if(this[i].nodeType===1&&(" "+this[i].className+" ").replace(rclass," ").indexOf(className)>=0){return true}}return false}});jQuery.each(("blur focus focusin focusout load resize scroll unload click dblclick "+"mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave "+"change select submit keydown keypress keyup error contextmenu").split(" "),function(i,name){jQuery.fn[name]=function(data,fn){return arguments.length>0?this.on(name,null,data,fn):this.trigger(name)}});jQuery.fn.extend({hover:function(fnOver,fnOut){return this.mouseenter(fnOver).mouseleave(fnOut||fnOver)},bind:function(types,data,fn){return this.on(types,null,data,fn)},unbind:function(types,fn){return this.off(types,null,fn)},delegate:function(selector,types,data,fn){return this.on(types,selector,data,fn)},undelegate:function(selector,types,fn){return arguments.length===1?this.off(selector,"**"):this.off(types,selector||"**",fn)}});var nonce=jQuery.now();var rquery=/\?/;var rvalidtokens=/(,)|(\[|{)|(}|])|"(?:[^"\\\r\n]|\\["\\\/bfnrt]|\\u[\da-fA-F]{4})*"\s*:?|true|false|null|-?(?!0\d)\d+(?:\.\d+|)(?:[eE][+-]?\d+|)/g;jQuery.parseJSON=function(data){if(window.JSON&&window.JSON.parse){return window.JSON.parse(data+"")}var requireNonComma,depth=null,str=jQuery.trim(data+"");return str&&!jQuery.trim(str.replace(rvalidtokens,function(token,comma,open,close){if(requireNonComma&&comma){depth=0}if(depth===0){return token}requireNonComma=open||comma;depth+=!close-!open;return""}))?Function("return "+str)():jQuery.error("Invalid JSON: "+data)};jQuery.parseXML=function(data){var xml,tmp;if(!data||typeof data!=="string"){return null}try{if(window.DOMParser){tmp=new DOMParser;xml=tmp.parseFromString(data,"text/xml")}else{xml=new ActiveXObject("Microsoft.XMLDOM");xml.async="false";xml.loadXML(data)}}catch(e){xml=undefined}if(!xml||!xml.documentElement||xml.getElementsByTagName("parsererror").length){jQuery.error("Invalid XML: "+data)}return xml};var ajaxLocParts,ajaxLocation,rhash=/#.*$/,rts=/([?&])_=[^&]*/,rheaders=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,rlocalProtocol=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,rnoContent=/^(?:GET|HEAD)$/,rprotocol=/^\/\//,rurl=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,prefilters={},transports={},allTypes="*/".concat("*");try{ajaxLocation=location.href}catch(e){ajaxLocation=document.createElement("a");ajaxLocation.href="";ajaxLocation=ajaxLocation.href}ajaxLocParts=rurl.exec(ajaxLocation.toLowerCase())||[];function addToPrefiltersOrTransports(structure){return function(dataTypeExpression,func){if(typeof dataTypeExpression!=="string"){func=dataTypeExpression;dataTypeExpression="*"}var dataType,i=0,dataTypes=dataTypeExpression.toLowerCase().match(rnotwhite)||[];if(jQuery.isFunction(func)){while(dataType=dataTypes[i++]){if(dataType.charAt(0)==="+"){dataType=dataType.slice(1)||"*";(structure[dataType]=structure[dataType]||[]).unshift(func)}else{(structure[dataType]=structure[dataType]||[]).push(func)}}}}}function inspectPrefiltersOrTransports(structure,options,originalOptions,jqXHR){var inspected={},seekingTransport=structure===transports;function inspect(dataType){var selected;inspected[dataType]=true;jQuery.each(structure[dataType]||[],function(_,prefilterOrFactory){var dataTypeOrTransport=prefilterOrFactory(options,originalOptions,jqXHR);if(typeof dataTypeOrTransport==="string"&&!seekingTransport&&!inspected[dataTypeOrTransport]){options.dataTypes.unshift(dataTypeOrTransport);inspect(dataTypeOrTransport);return false}else if(seekingTransport){return!(selected=dataTypeOrTransport)}});return selected}return inspect(options.dataTypes[0])||!inspected["*"]&&inspect("*")}function ajaxExtend(target,src){var deep,key,flatOptions=jQuery.ajaxSettings.flatOptions||{};for(key in src){if(src[key]!==undefined){(flatOptions[key]?target:deep||(deep={}))[key]=src[key]}}if(deep){jQuery.extend(true,target,deep)}return target}function ajaxHandleResponses(s,jqXHR,responses){var firstDataType,ct,finalDataType,type,contents=s.contents,dataTypes=s.dataTypes;while(dataTypes[0]==="*"){dataTypes.shift();if(ct===undefined){ct=s.mimeType||jqXHR.getResponseHeader("Content-Type")}}if(ct){for(type in contents){if(contents[type]&&contents[type].test(ct)){dataTypes.unshift(type);break}}}if(dataTypes[0]in responses){finalDataType=dataTypes[0]}else{for(type in responses){if(!dataTypes[0]||s.converters[type+" "+dataTypes[0]]){finalDataType=type;break}if(!firstDataType){firstDataType=type}}finalDataType=finalDataType||firstDataType}if(finalDataType){if(finalDataType!==dataTypes[0]){dataTypes.unshift(finalDataType)}return responses[finalDataType]}}function ajaxConvert(s,response,jqXHR,isSuccess){var conv2,current,conv,tmp,prev,converters={},dataTypes=s.dataTypes.slice();if(dataTypes[1]){for(conv in s.converters){converters[conv.toLowerCase()]=s.converters[conv]}}current=dataTypes.shift();while(current){if(s.responseFields[current]){jqXHR[s.responseFields[current]]=response}if(!prev&&isSuccess&&s.dataFilter){response=s.dataFilter(response,s.dataType)}prev=current;current=dataTypes.shift();if(current){if(current==="*"){current=prev}else if(prev!=="*"&&prev!==current){conv=converters[prev+" "+current]||converters["* "+current];if(!conv){for(conv2 in converters){tmp=conv2.split(" ");if(tmp[1]===current){conv=converters[prev+" "+tmp[0]]||converters["* "+tmp[0]];if(conv){if(conv===true){conv=converters[conv2]}else if(converters[conv2]!==true){current=tmp[0];dataTypes.unshift(tmp[1])}break}}}}if(conv!==true){if(conv&&s["throws"]){response=conv(response)}else{try{response=conv(response)}catch(e){return{state:"parsererror",error:conv?e:"No conversion from "+prev+" to "+current}}}}}}}return{state:"success",data:response}}jQuery.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:ajaxLocation,type:"GET",isLocal:rlocalProtocol.test(ajaxLocParts[1]),global:true,processData:true,async:true,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":allTypes,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":true,"text json":jQuery.parseJSON,"text xml":jQuery.parseXML},flatOptions:{url:true,context:true}},ajaxSetup:function(target,settings){return settings?ajaxExtend(ajaxExtend(target,jQuery.ajaxSettings),settings):ajaxExtend(jQuery.ajaxSettings,target)},ajaxPrefilter:addToPrefiltersOrTransports(prefilters),ajaxTransport:addToPrefiltersOrTransports(transports),ajax:function(url,options){if(typeof url==="object"){options=url;url=undefined}options=options||{};var parts,i,cacheURL,responseHeadersString,timeoutTimer,fireGlobals,transport,responseHeaders,s=jQuery.ajaxSetup({},options),callbackContext=s.context||s,globalEventContext=s.context&&(callbackContext.nodeType||callbackContext.jquery)?jQuery(callbackContext):jQuery.event,deferred=jQuery.Deferred(),completeDeferred=jQuery.Callbacks("once memory"),statusCode=s.statusCode||{},requestHeaders={},requestHeadersNames={},state=0,strAbort="canceled",jqXHR={readyState:0,getResponseHeader:function(key){var match;if(state===2){if(!responseHeaders){responseHeaders={};while(match=rheaders.exec(responseHeadersString)){responseHeaders[match[1].toLowerCase()]=match[2]}}match=responseHeaders[key.toLowerCase()]}return match==null?null:match},getAllResponseHeaders:function(){return state===2?responseHeadersString:null},setRequestHeader:function(name,value){var lname=name.toLowerCase();if(!state){name=requestHeadersNames[lname]=requestHeadersNames[lname]||name;requestHeaders[name]=value}return this},overrideMimeType:function(type){if(!state){s.mimeType=type}return this},statusCode:function(map){var code;if(map){if(state<2){for(code in map){statusCode[code]=[statusCode[code],map[code]]}}else{jqXHR.always(map[jqXHR.status])}}return this},abort:function(statusText){var finalText=statusText||strAbort;if(transport){transport.abort(finalText)}done(0,finalText);return this}};deferred.promise(jqXHR).complete=completeDeferred.add;jqXHR.success=jqXHR.done;jqXHR.error=jqXHR.fail;s.url=((url||s.url||ajaxLocation)+"").replace(rhash,"").replace(rprotocol,ajaxLocParts[1]+"//");s.type=options.method||options.type||s.method||s.type;s.dataTypes=jQuery.trim(s.dataType||"*").toLowerCase().match(rnotwhite)||[""];if(s.crossDomain==null){parts=rurl.exec(s.url.toLowerCase());s.crossDomain=!!(parts&&(parts[1]!==ajaxLocParts[1]||parts[2]!==ajaxLocParts[2]||(parts[3]||(parts[1]==="http:"?"80":"443"))!==(ajaxLocParts[3]||(ajaxLocParts[1]==="http:"?"80":"443"))))}if(s.data&&s.processData&&typeof s.data!=="string"){s.data=jQuery.param(s.data,s.traditional)}inspectPrefiltersOrTransports(prefilters,s,options,jqXHR);if(state===2){return jqXHR}fireGlobals=s.global;if(fireGlobals&&jQuery.active++===0){jQuery.event.trigger("ajaxStart")}s.type=s.type.toUpperCase();s.hasContent=!rnoContent.test(s.type);cacheURL=s.url;if(!s.hasContent){if(s.data){cacheURL=s.url+=(rquery.test(cacheURL)?"&":"?")+s.data;delete s.data}if(s.cache===false){s.url=rts.test(cacheURL)?cacheURL.replace(rts,"$1_="+nonce++):cacheURL+(rquery.test(cacheURL)?"&":"?")+"_="+nonce++}}if(s.ifModified){if(jQuery.lastModified[cacheURL]){jqXHR.setRequestHeader("If-Modified-Since",jQuery.lastModified[cacheURL])}if(jQuery.etag[cacheURL]){jqXHR.setRequestHeader("If-None-Match",jQuery.etag[cacheURL])}}if(s.data&&s.hasContent&&s.contentType!==false||options.contentType){jqXHR.setRequestHeader("Content-Type",s.contentType)}jqXHR.setRequestHeader("Accept",s.dataTypes[0]&&s.accepts[s.dataTypes[0]]?s.accepts[s.dataTypes[0]]+(s.dataTypes[0]!=="*"?", "+allTypes+"; q=0.01":""):s.accepts["*"]);for(i in s.headers){jqXHR.setRequestHeader(i,s.headers[i])}if(s.beforeSend&&(s.beforeSend.call(callbackContext,jqXHR,s)===false||state===2)){return jqXHR.abort()}strAbort="abort";for(i in{success:1,error:1,complete:1}){jqXHR[i](s[i])}transport=inspectPrefiltersOrTransports(transports,s,options,jqXHR);if(!transport){done(-1,"No Transport")}else{jqXHR.readyState=1;if(fireGlobals){globalEventContext.trigger("ajaxSend",[jqXHR,s])}if(s.async&&s.timeout>0){timeoutTimer=setTimeout(function(){jqXHR.abort("timeout")},s.timeout)}try{state=1;transport.send(requestHeaders,done)}catch(e){if(state<2){done(-1,e)}else{throw e}}}function done(status,nativeStatusText,responses,headers){var isSuccess,success,error,response,modified,statusText=nativeStatusText;if(state===2){return}state=2;if(timeoutTimer){clearTimeout(timeoutTimer)}transport=undefined;responseHeadersString=headers||"";jqXHR.readyState=status>0?4:0;isSuccess=status>=200&&status<300||status===304;if(responses){response=ajaxHandleResponses(s,jqXHR,responses)}response=ajaxConvert(s,response,jqXHR,isSuccess);if(isSuccess){if(s.ifModified){modified=jqXHR.getResponseHeader("Last-Modified");if(modified){jQuery.lastModified[cacheURL]=modified}modified=jqXHR.getResponseHeader("etag");if(modified){jQuery.etag[cacheURL]=modified}}if(status===204||s.type==="HEAD"){statusText="nocontent"}else if(status===304){statusText="notmodified"}else{statusText=response.state;success=response.data;error=response.error;isSuccess=!error}}else{error=statusText;if(status||!statusText){statusText="error";if(status<0){status=0}}}jqXHR.status=status;jqXHR.statusText=(nativeStatusText||statusText)+"";if(isSuccess){deferred.resolveWith(callbackContext,[success,statusText,jqXHR])}else{deferred.rejectWith(callbackContext,[jqXHR,statusText,error])}jqXHR.statusCode(statusCode);statusCode=undefined;if(fireGlobals){globalEventContext.trigger(isSuccess?"ajaxSuccess":"ajaxError",[jqXHR,s,isSuccess?success:error])}completeDeferred.fireWith(callbackContext,[jqXHR,statusText]);if(fireGlobals){globalEventContext.trigger("ajaxComplete",[jqXHR,s]);if(!--jQuery.active){jQuery.event.trigger("ajaxStop")}}}return jqXHR},getJSON:function(url,data,callback){return jQuery.get(url,data,callback,"json")},getScript:function(url,callback){return jQuery.get(url,undefined,callback,"script")}});jQuery.each(["get","post"],function(i,method){jQuery[method]=function(url,data,callback,type){if(jQuery.isFunction(data)){type=type||callback;callback=data;data=undefined}return jQuery.ajax({url:url,type:method,dataType:type,data:data,success:callback})}});jQuery.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(i,type){jQuery.fn[type]=function(fn){return this.on(type,fn)}});jQuery._evalUrl=function(url){return jQuery.ajax({url:url,type:"GET",dataType:"script",async:false,global:false,"throws":true})};jQuery.fn.extend({wrapAll:function(html){if(jQuery.isFunction(html)){return this.each(function(i){jQuery(this).wrapAll(html.call(this,i))})}if(this[0]){var wrap=jQuery(html,this[0].ownerDocument).eq(0).clone(true);if(this[0].parentNode){wrap.insertBefore(this[0])}wrap.map(function(){var elem=this;while(elem.firstChild&&elem.firstChild.nodeType===1){elem=elem.firstChild}return elem}).append(this)}return this},wrapInner:function(html){if(jQuery.isFunction(html)){return this.each(function(i){jQuery(this).wrapInner(html.call(this,i))})}return this.each(function(){var self=jQuery(this),contents=self.contents();if(contents.length){contents.wrapAll(html)}else{self.append(html)}})},wrap:function(html){var isFunction=jQuery.isFunction(html);return this.each(function(i){jQuery(this).wrapAll(isFunction?html.call(this,i):html)})},unwrap:function(){return this.parent().each(function(){if(!jQuery.nodeName(this,"body")){jQuery(this).replaceWith(this.childNodes)}}).end()}});jQuery.expr.filters.hidden=function(elem){return elem.offsetWidth<=0&&elem.offsetHeight<=0||!support.reliableHiddenOffsets()&&(elem.style&&elem.style.display||jQuery.css(elem,"display"))==="none"};jQuery.expr.filters.visible=function(elem){return!jQuery.expr.filters.hidden(elem)};var r20=/%20/g,rbracket=/\[\]$/,rCRLF=/\r?\n/g,rsubmitterTypes=/^(?:submit|button|image|reset|file)$/i,rsubmittable=/^(?:input|select|textarea|keygen)/i;function buildParams(prefix,obj,traditional,add){var name;if(jQuery.isArray(obj)){jQuery.each(obj,function(i,v){if(traditional||rbracket.test(prefix)){add(prefix,v)}else{buildParams(prefix+"["+(typeof v==="object"?i:"")+"]",v,traditional,add)}})}else if(!traditional&&jQuery.type(obj)==="object"){for(name in obj){buildParams(prefix+"["+name+"]",obj[name],traditional,add)}}else{add(prefix,obj)}}jQuery.param=function(a,traditional){var prefix,s=[],add=function(key,value){value=jQuery.isFunction(value)?value():value==null?"":value;s[s.length]=encodeURIComponent(key)+"="+encodeURIComponent(value)};if(traditional===undefined){traditional=jQuery.ajaxSettings&&jQuery.ajaxSettings.traditional}if(jQuery.isArray(a)||a.jquery&&!jQuery.isPlainObject(a)){jQuery.each(a,function(){add(this.name,this.value)})}else{for(prefix in a){buildParams(prefix,a[prefix],traditional,add)}}return s.join("&").replace(r20,"+")};jQuery.fn.extend({serialize:function(){return jQuery.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var elements=jQuery.prop(this,"elements");return elements?jQuery.makeArray(elements):this}).filter(function(){var type=this.type;return this.name&&!jQuery(this).is(":disabled")&&rsubmittable.test(this.nodeName)&&!rsubmitterTypes.test(type)&&(this.checked||!rcheckableType.test(type))}).map(function(i,elem){var val=jQuery(this).val();return val==null?null:jQuery.isArray(val)?jQuery.map(val,function(val){return{name:elem.name,value:val.replace(rCRLF,"\r\n")}}):{name:elem.name,value:val.replace(rCRLF,"\r\n")}}).get()}});jQuery.ajaxSettings.xhr=window.ActiveXObject!==undefined?function(){return!this.isLocal&&/^(get|post|head|put|delete|options)$/i.test(this.type)&&createStandardXHR()||createActiveXHR()}:createStandardXHR;var xhrId=0,xhrCallbacks={},xhrSupported=jQuery.ajaxSettings.xhr();if(window.ActiveXObject){jQuery(window).on("unload",function(){for(var key in xhrCallbacks){xhrCallbacks[key](undefined,true)}})}support.cors=!!xhrSupported&&"withCredentials"in xhrSupported;xhrSupported=support.ajax=!!xhrSupported;if(xhrSupported){jQuery.ajaxTransport(function(options){if(!options.crossDomain||support.cors){var callback;return{send:function(headers,complete){var i,xhr=options.xhr(),id=++xhrId;xhr.open(options.type,options.url,options.async,options.username,options.password);if(options.xhrFields){for(i in options.xhrFields){xhr[i]=options.xhrFields[i]}}if(options.mimeType&&xhr.overrideMimeType){xhr.overrideMimeType(options.mimeType)}if(!options.crossDomain&&!headers["X-Requested-With"]){headers["X-Requested-With"]="XMLHttpRequest"}for(i in headers){if(headers[i]!==undefined){xhr.setRequestHeader(i,headers[i]+"")}}xhr.send(options.hasContent&&options.data||null);callback=function(_,isAbort){var status,statusText,responses;if(callback&&(isAbort||xhr.readyState===4)){delete xhrCallbacks[id];callback=undefined;xhr.onreadystatechange=jQuery.noop;if(isAbort){if(xhr.readyState!==4){xhr.abort()}}else{responses={};status=xhr.status;if(typeof xhr.responseText==="string"){responses.text=xhr.responseText}try{statusText=xhr.statusText}catch(e){statusText=""}if(!status&&options.isLocal&&!options.crossDomain){status=responses.text?200:404}else if(status===1223){status=204}}}if(responses){complete(status,statusText,responses,xhr.getAllResponseHeaders())}};if(!options.async){callback()}else if(xhr.readyState===4){setTimeout(callback)}else{xhr.onreadystatechange=xhrCallbacks[id]=callback}},abort:function(){if(callback){callback(undefined,true)}}}}})}function createStandardXHR(){try{return new window.XMLHttpRequest}catch(e){}}function createActiveXHR(){try{return new window.ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}jQuery.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(text){jQuery.globalEval(text);return text}}});jQuery.ajaxPrefilter("script",function(s){if(s.cache===undefined){s.cache=false}if(s.crossDomain){s.type="GET";s.global=false}});jQuery.ajaxTransport("script",function(s){if(s.crossDomain){var script,head=document.head||jQuery("head")[0]||document.documentElement;return{send:function(_,callback){script=document.createElement("script");script.async=true;if(s.scriptCharset){script.charset=s.scriptCharset}script.src=s.url;script.onload=script.onreadystatechange=function(_,isAbort){if(isAbort||!script.readyState||/loaded|complete/.test(script.readyState)){script.onload=script.onreadystatechange=null;if(script.parentNode){script.parentNode.removeChild(script)}script=null;if(!isAbort){callback(200,"success")}}};head.insertBefore(script,head.firstChild)},abort:function(){if(script){script.onload(undefined,true)}}}}});var oldCallbacks=[],rjsonp=/(=)\?(?=&|$)|\?\?/;jQuery.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var callback=oldCallbacks.pop()||jQuery.expando+"_"+nonce++;this[callback]=true;return callback}});jQuery.ajaxPrefilter("json jsonp",function(s,originalSettings,jqXHR){var callbackName,overwritten,responseContainer,jsonProp=s.jsonp!==false&&(rjsonp.test(s.url)?"url":typeof s.data==="string"&&!(s.contentType||"").indexOf("application/x-www-form-urlencoded")&&rjsonp.test(s.data)&&"data");if(jsonProp||s.dataTypes[0]==="jsonp"){callbackName=s.jsonpCallback=jQuery.isFunction(s.jsonpCallback)?s.jsonpCallback():s.jsonpCallback;if(jsonProp){s[jsonProp]=s[jsonProp].replace(rjsonp,"$1"+callbackName)}else if(s.jsonp!==false){s.url+=(rquery.test(s.url)?"&":"?")+s.jsonp+"="+callbackName}s.converters["script json"]=function(){if(!responseContainer){jQuery.error(callbackName+" was not called")}return responseContainer[0]};s.dataTypes[0]="json";overwritten=window[callbackName];window[callbackName]=function(){responseContainer=arguments};jqXHR.always(function(){window[callbackName]=overwritten;if(s[callbackName]){s.jsonpCallback=originalSettings.jsonpCallback;oldCallbacks.push(callbackName)}if(responseContainer&&jQuery.isFunction(overwritten)){overwritten(responseContainer[0])}responseContainer=overwritten=undefined});return"script"}});jQuery.parseHTML=function(data,context,keepScripts){if(!data||typeof data!=="string"){return null}if(typeof context==="boolean"){keepScripts=context;context=false}context=context||document;var parsed=rsingleTag.exec(data),scripts=!keepScripts&&[];if(parsed){return[context.createElement(parsed[1])]}parsed=jQuery.buildFragment([data],context,scripts);if(scripts&&scripts.length){jQuery(scripts).remove()}return jQuery.merge([],parsed.childNodes)};var _load=jQuery.fn.load;jQuery.fn.load=function(url,params,callback){if(typeof url!=="string"&&_load){return _load.apply(this,arguments)}var selector,response,type,self=this,off=url.indexOf(" ");if(off>=0){selector=jQuery.trim(url.slice(off,url.length));url=url.slice(0,off)}if(jQuery.isFunction(params)){callback=params;params=undefined}else if(params&&typeof params==="object"){type="POST"}if(self.length>0){jQuery.ajax({url:url,type:type,dataType:"html",data:params}).done(function(responseText){response=arguments;self.html(selector?jQuery("<div>").append(jQuery.parseHTML(responseText)).find(selector):responseText)}).complete(callback&&function(jqXHR,status){self.each(callback,response||[jqXHR.responseText,status,jqXHR])})}return this};jQuery.expr.filters.animated=function(elem){return jQuery.grep(jQuery.timers,function(fn){return elem===fn.elem}).length};var docElem=window.document.documentElement;function getWindow(elem){return jQuery.isWindow(elem)?elem:elem.nodeType===9?elem.defaultView||elem.parentWindow:false}jQuery.offset={setOffset:function(elem,options,i){var curPosition,curLeft,curCSSTop,curTop,curOffset,curCSSLeft,calculatePosition,position=jQuery.css(elem,"position"),curElem=jQuery(elem),props={};if(position==="static"){elem.style.position="relative"}curOffset=curElem.offset();curCSSTop=jQuery.css(elem,"top");curCSSLeft=jQuery.css(elem,"left");calculatePosition=(position==="absolute"||position==="fixed")&&jQuery.inArray("auto",[curCSSTop,curCSSLeft])>-1;if(calculatePosition){curPosition=curElem.position();curTop=curPosition.top;curLeft=curPosition.left}else{curTop=parseFloat(curCSSTop)||0;curLeft=parseFloat(curCSSLeft)||0}if(jQuery.isFunction(options)){options=options.call(elem,i,curOffset)}if(options.top!=null){props.top=options.top-curOffset.top+curTop}if(options.left!=null){props.left=options.left-curOffset.left+curLeft}if("using"in options){options.using.call(elem,props)}else{curElem.css(props)}}};jQuery.fn.extend({offset:function(options){if(arguments.length){return options===undefined?this:this.each(function(i){jQuery.offset.setOffset(this,options,i)})}var docElem,win,box={top:0,left:0},elem=this[0],doc=elem&&elem.ownerDocument;if(!doc){return}docElem=doc.documentElement;if(!jQuery.contains(docElem,elem)){return box}if(typeof elem.getBoundingClientRect!==strundefined){box=elem.getBoundingClientRect()}win=getWindow(doc);return{top:box.top+(win.pageYOffset||docElem.scrollTop)-(docElem.clientTop||0),left:box.left+(win.pageXOffset||docElem.scrollLeft)-(docElem.clientLeft||0)}},position:function(){if(!this[0]){return}var offsetParent,offset,parentOffset={top:0,left:0},elem=this[0];if(jQuery.css(elem,"position")==="fixed"){offset=elem.getBoundingClientRect()}else{offsetParent=this.offsetParent();offset=this.offset();if(!jQuery.nodeName(offsetParent[0],"html")){parentOffset=offsetParent.offset()}parentOffset.top+=jQuery.css(offsetParent[0],"borderTopWidth",true);parentOffset.left+=jQuery.css(offsetParent[0],"borderLeftWidth",true)}return{top:offset.top-parentOffset.top-jQuery.css(elem,"marginTop",true),left:offset.left-parentOffset.left-jQuery.css(elem,"marginLeft",true)}},offsetParent:function(){return this.map(function(){var offsetParent=this.offsetParent||docElem;while(offsetParent&&(!jQuery.nodeName(offsetParent,"html")&&jQuery.css(offsetParent,"position")==="static")){offsetParent=offsetParent.offsetParent}return offsetParent||docElem})}});jQuery.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(method,prop){var top=/Y/.test(prop);jQuery.fn[method]=function(val){return access(this,function(elem,method,val){var win=getWindow(elem);if(val===undefined){return win?prop in win?win[prop]:win.document.documentElement[method]:elem[method]}if(win){win.scrollTo(!top?val:jQuery(win).scrollLeft(),top?val:jQuery(win).scrollTop())}else{elem[method]=val}},method,val,arguments.length,null)}});jQuery.each(["top","left"],function(i,prop){jQuery.cssHooks[prop]=addGetHookIf(support.pixelPosition,function(elem,computed){if(computed){computed=curCSS(elem,prop);return rnumnonpx.test(computed)?jQuery(elem).position()[prop]+"px":computed}})});jQuery.each({Height:"height",Width:"width"},function(name,type){jQuery.each({padding:"inner"+name,content:type,"":"outer"+name},function(defaultExtra,funcName){jQuery.fn[funcName]=function(margin,value){var chainable=arguments.length&&(defaultExtra||typeof margin!=="boolean"),extra=defaultExtra||(margin===true||value===true?"margin":"border");return access(this,function(elem,type,value){var doc;if(jQuery.isWindow(elem)){return elem.document.documentElement["client"+name]}if(elem.nodeType===9){doc=elem.documentElement;return Math.max(elem.body["scroll"+name],doc["scroll"+name],elem.body["offset"+name],doc["offset"+name],doc["client"+name])}return value===undefined?jQuery.css(elem,type,extra):jQuery.style(elem,type,value,extra)},type,chainable?margin:undefined,chainable,null)}})});jQuery.fn.size=function(){return this.length};jQuery.fn.andSelf=jQuery.fn.addBack;if(typeof define==="function"&&define.amd){define("jquery",[],function(){return jQuery})}var _jQuery=window.jQuery,_$=window.$;jQuery.noConflict=function(deep){if(window.$===jQuery){window.$=_$}if(deep&&window.jQuery===jQuery){window.jQuery=_jQuery}return jQuery};if(typeof noGlobal===strundefined){window.jQuery=window.$=jQuery}return jQuery});browserify_shim__define__module__export__(typeof $!="undefined"?$:window.$)}).call(global,undefined,undefined,undefined,undefined,function defineExport(ex){module.exports=ex})}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],27:[function(require,module,exports){(function(global){require("/Users/nileshgarg/apurva/h/h/static/scripts/vendor/jquery.js");var __browserify_shim_require__=require;(function browserifyShim(module,define,require){(function($){var converter={vertical:{x:false,y:true},horizontal:{x:true,y:false},both:{x:true,y:true},x:{x:true,y:false},y:{x:false,y:true}};var settings={duration:"fast",direction:"both"};var rootrx=/^(?:html)$/i;var borders=function(domElement,styles){styles=styles||(document.defaultView&&document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(domElement,null):domElement.currentStyle);var px=document.defaultView&&document.defaultView.getComputedStyle?true:false;var b={top:parseFloat(px?styles.borderTopWidth:$.css(domElement,"borderTopWidth"))||0,left:parseFloat(px?styles.borderLeftWidth:$.css(domElement,"borderLeftWidth"))||0,bottom:parseFloat(px?styles.borderBottomWidth:$.css(domElement,"borderBottomWidth"))||0,right:parseFloat(px?styles.borderRightWidth:$.css(domElement,"borderRightWidth"))||0};return{top:b.top,left:b.left,bottom:b.bottom,right:b.right,vertical:b.top+b.bottom,horizontal:b.left+b.right}};var dimensions=function($element){var win=$(window);var isRoot=rootrx.test($element[0].nodeName);return{border:isRoot?{top:0,left:0,bottom:0,right:0}:borders($element[0]),scroll:{top:(isRoot?win:$element).scrollTop(),left:(isRoot?win:$element).scrollLeft()},scrollbar:{right:isRoot?0:$element.innerWidth()-$element[0].clientWidth,bottom:isRoot?0:$element.innerHeight()-$element[0].clientHeight},rect:function(){var r=$element[0].getBoundingClientRect();return{top:isRoot?0:r.top,left:isRoot?0:r.left,bottom:isRoot?$element[0].clientHeight:r.bottom,right:isRoot?$element[0].clientWidth:r.right}}()}};$.fn.extend({scrollintoview:function(options){options=$.extend({},settings,options);options.direction=converter[typeof options.direction==="string"&&options.direction.toLowerCase()]||converter.both;var dirStr="";if(options.direction.x===true)dirStr="horizontal";if(options.direction.y===true)dirStr=dirStr?"both":"vertical";var el=this.eq(0);var scroller=el.closest(":scrollable("+dirStr+")");if(scroller.length>0){scroller=scroller.eq(0);var dim={e:dimensions(el),s:dimensions(scroller)};var rel={top:dim.e.rect.top-(dim.s.rect.top+dim.s.border.top),bottom:dim.s.rect.bottom-dim.s.border.bottom-dim.s.scrollbar.bottom-dim.e.rect.bottom,left:dim.e.rect.left-(dim.s.rect.left+dim.s.border.left),right:dim.s.rect.right-dim.s.border.right-dim.s.scrollbar.right-dim.e.rect.right};var animOptions={};if(options.direction.y===true){if(rel.top<0){animOptions.scrollTop=dim.s.scroll.top+rel.top;
}else if(rel.top>0&&rel.bottom<0){animOptions.scrollTop=dim.s.scroll.top+Math.min(rel.top,-rel.bottom)}}if(options.direction.x===true){if(rel.left<0){animOptions.scrollLeft=dim.s.scroll.left+rel.left}else if(rel.left>0&&rel.right<0){animOptions.scrollLeft=dim.s.scroll.left+Math.min(rel.left,-rel.right)}}if(!$.isEmptyObject(animOptions)){if(rootrx.test(scroller[0].nodeName)){scroller=$("html,body")}scroller.animate(animOptions,options.duration).eq(0).queue(function(next){$.isFunction(options.complete)&&options.complete.call(scroller[0]);next()})}else{$.isFunction(options.complete)&&options.complete.call(scroller[0])}}return this}});var scrollValue={auto:true,scroll:true,visible:false,hidden:false};$.extend($.expr[":"],{scrollable:function(element,index,meta,stack){var direction=converter[typeof meta[3]==="string"&&meta[3].toLowerCase()]||converter.both;var styles=document.defaultView&&document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(element,null):element.currentStyle;var overflow={x:scrollValue[styles.overflowX.toLowerCase()]||false,y:scrollValue[styles.overflowY.toLowerCase()]||false,isRoot:rootrx.test(element.nodeName)};if(!overflow.x&&!overflow.y&&!overflow.isRoot){return false}var size={height:{scroll:element.scrollHeight,client:element.clientHeight},width:{scroll:element.scrollWidth,client:element.clientWidth},scrollableX:function(){return(overflow.x||overflow.isRoot)&&this.width.scroll>this.width.client},scrollableY:function(){return(overflow.y||overflow.isRoot)&&this.height.scroll>this.height.client}};return direction.y&&size.scrollableY()||direction.x&&size.scrollableX()}})})(jQuery)}).call(global,module,undefined,undefined)}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"/Users/nileshgarg/apurva/h/h/static/scripts/vendor/jquery.js":26}],28:[function(require,module,exports){(function(global){var __browserify_shim_require__=require;(function browserifyShim(module,exports,require,define,browserify_shim__define__module__export__){var Channel=function(){"use strict";var s_curTranId=Math.floor(Math.random()*1000001);var s_boundChans={};function s_addBoundChan(win,origin,scope,handler){function hasWin(arr){for(var i=0;i<arr.length;i++)if(arr[i].win===win)return true;return false}var exists=false;if(origin==="*"){for(var k in s_boundChans){if(!s_boundChans.hasOwnProperty(k))continue;if(k==="*")continue;if(typeof s_boundChans[k][scope]==="object"){exists=hasWin(s_boundChans[k][scope]);if(exists)break}}}else{if(s_boundChans["*"]&&s_boundChans["*"][scope]){exists=hasWin(s_boundChans["*"][scope])}if(!exists&&s_boundChans[origin]&&s_boundChans[origin][scope]){exists=hasWin(s_boundChans[origin][scope])}}if(exists)throw"A channel is already bound to the same window which overlaps with origin '"+origin+"' and has scope '"+scope+"'";if(typeof s_boundChans[origin]!="object")s_boundChans[origin]={};if(typeof s_boundChans[origin][scope]!="object")s_boundChans[origin][scope]=[];s_boundChans[origin][scope].push({win:win,handler:handler})}function s_removeBoundChan(win,origin,scope){var arr=s_boundChans[origin][scope];for(var i=0;i<arr.length;i++){if(arr[i].win===win){arr.splice(i,1)}}if(s_boundChans[origin][scope].length===0){delete s_boundChans[origin][scope]}}function s_isArray(obj){if(Array.isArray)return Array.isArray(obj);else{return obj.constructor.toString().indexOf("Array")!=-1}}var s_transIds={};var s_onMessage=function(e){try{var m=JSON.parse(e.data);if(typeof m!=="object"||m===null)throw"malformed"}catch(e){return}var w=e.source;var o=e.origin;var s,i,meth;if(typeof m.method==="string"){var ar=m.method.split("::");if(ar.length==2){s=ar[0];meth=ar[1]}else{meth=m.method}}if(typeof m.id!=="undefined")i=m.id;if(typeof meth==="string"){var delivered=false;if(s_boundChans[o]&&s_boundChans[o][s]){for(var j=0;j<s_boundChans[o][s].length;j++){if(s_boundChans[o][s][j].win===w){s_boundChans[o][s][j].handler(o,meth,m);delivered=true;break}}}if(!delivered&&s_boundChans["*"]&&s_boundChans["*"][s]){for(var j=0;j<s_boundChans["*"][s].length;j++){if(s_boundChans["*"][s][j].win===w){s_boundChans["*"][s][j].handler(o,meth,m);break}}}}else if(typeof i!="undefined"){if(s_transIds[i])s_transIds[i](o,meth,m)}};if(window.addEventListener)window.addEventListener("message",s_onMessage,false);else if(window.attachEvent)window.attachEvent("onmessage",s_onMessage);return{build:function(cfg){var debug=function(m){if(cfg.debugOutput&&window.console&&window.console.log){try{if(typeof m!=="string")m=JSON.stringify(m)}catch(e){}console.log("["+chanId+"] "+m)}};if(!window.postMessage)throw"jschannel cannot run this browser, no postMessage";if(!window.JSON||!window.JSON.stringify||!window.JSON.parse){throw"jschannel cannot run this browser, no JSON parsing/serialization"}if(window.Prototype){console.log("patching Prototype's faulty Array.toJSON");var stringify=window.JSON.stringify;window.JSON.stringify=function(value){var _array_tojson=Array.prototype.toJSON;delete Array.prototype.toJSON;var r=stringify(value);Array.prototype.toJSON=_array_tojson;return r}}if(typeof cfg!="object")throw"Channel build invoked without a proper object argument";if(!cfg.window||!cfg.window.postMessage)throw"Channel.build() called without a valid window argument";if(window===cfg.window)throw"target window is same as present window -- not allowed";var validOrigin=false;if(typeof cfg.origin==="string"){var oMatch;if(cfg.origin==="*")validOrigin=true;else if(null!==(oMatch=cfg.origin.match(/^https?:\/\/(?:[-a-zA-Z0-9_\.])+(?::\d+)?/))){cfg.origin=oMatch[0].toLowerCase();validOrigin=true}else if(cfg.origin=="resource://pdf.js"){validOrigin=true}}if(!validOrigin)throw"Channel.build() called with an invalid origin";if(typeof cfg.scope!=="undefined"){if(typeof cfg.scope!=="string")throw"scope, when specified, must be a string";if(cfg.scope.split("::").length>1)throw"scope may not contain double colons: '::'"}var chanId=function(){var text="";var alpha="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";for(var i=0;i<5;i++)text+=alpha.charAt(Math.floor(Math.random()*alpha.length));return text}();var regTbl={};var outTbl={};var inTbl={};var ready=false;var pendingQueue=[];var createTransaction=function(id,origin,callbacks){var shouldDelayReturn=false;var completed=false;return{origin:origin,invoke:function(cbName,v){if(!inTbl[id])throw"attempting to invoke a callback of a nonexistent transaction: "+id;var valid=false;for(var i=0;i<callbacks.length;i++)if(cbName===callbacks[i]){valid=true;break}if(!valid)throw"request supports no such callback '"+cbName+"'";postMessage({id:id,callback:cbName,params:v})},error:function(error,message){completed=true;if(!inTbl[id])throw"error called for nonexistent message: "+id;delete inTbl[id];postMessage({id:id,error:error,message:message})},complete:function(v){completed=true;if(!inTbl[id])throw"complete called for nonexistent message: "+id;delete inTbl[id];postMessage({id:id,result:v})},delayReturn:function(delay){if(typeof delay==="boolean"){shouldDelayReturn=delay===true}return shouldDelayReturn},completed:function(){return completed}}};var setTransactionTimeout=function(transId,timeout,method){return window.setTimeout(function(){if(outTbl[transId]){var msg="timeout ("+timeout+"ms) exceeded on method '"+method+"'";(1,outTbl[transId].error)("timeout_error",msg);delete outTbl[transId];delete s_transIds[transId]}},timeout)};var onMessage=function(origin,method,m){if(typeof cfg.gotMessageObserver==="function"){try{cfg.gotMessageObserver(origin,m)}catch(e){debug("gotMessageObserver() raised an exception: "+e.toString())}}if(m.id&&method){if(regTbl[method]){var trans=createTransaction(m.id,origin,m.callbacks?m.callbacks:[]);inTbl[m.id]={};try{if(m.callbacks&&s_isArray(m.callbacks)&&m.callbacks.length>0){for(var i=0;i<m.callbacks.length;i++){var path=m.callbacks[i];var obj=m.params;var pathItems=path.split("/");for(var j=0;j<pathItems.length-1;j++){var cp=pathItems[j];if(typeof obj[cp]!=="object")obj[cp]={};obj=obj[cp]}obj[pathItems[pathItems.length-1]]=function(){var cbName=path;return function(params){return trans.invoke(cbName,params)}}()}}var resp=regTbl[method](trans,m.params);if(!trans.delayReturn()&&!trans.completed())trans.complete(resp)}catch(e){var error="runtime_error";var message=null;if(typeof e==="string"){message=e}else if(typeof e==="object"){if(e&&s_isArray(e)&&e.length==2){error=e[0];message=e[1]}else if(typeof e.error==="string"){error=e.error;if(!e.message)message="";else if(typeof e.message==="string")message=e.message;else e=e.message}}if(message===null){try{message=JSON.stringify(e);if(typeof message=="undefined")message=e.toString()}catch(e2){message=e.toString()}}trans.error(error,message)}}}else if(m.id&&m.callback){if(!outTbl[m.id]||!outTbl[m.id].callbacks||!outTbl[m.id].callbacks[m.callback]){debug("ignoring invalid callback, id:"+m.id+" ("+m.callback+")")}else{outTbl[m.id].callbacks[m.callback](m.params)}}else if(m.id){if(!outTbl[m.id]){debug("ignoring invalid response: "+m.id)}else{if(m.error){(1,outTbl[m.id].error)(m.error,m.message)}else{if(m.result!==undefined)(1,outTbl[m.id].success)(m.result);else(1,outTbl[m.id].success)()}delete outTbl[m.id];delete s_transIds[m.id]}}else if(method){if(regTbl[method]){regTbl[method]({origin:origin},m.params)}}};s_addBoundChan(cfg.window,cfg.origin,typeof cfg.scope==="string"?cfg.scope:"",onMessage);var scopeMethod=function(m){if(typeof cfg.scope==="string"&&cfg.scope.length)m=[cfg.scope,m].join("::");return m};var postMessage=function(msg,force){if(!msg)throw"postMessage called with null message";var verb=ready?"post  ":"queue ";debug(verb+" message: "+JSON.stringify(msg));if(!force&&!ready){pendingQueue.push(msg)}else{if(typeof cfg.postMessageObserver==="function"){try{cfg.postMessageObserver(cfg.origin,msg)}catch(e){debug("postMessageObserver() raised an exception: "+e.toString())}}cfg.window.postMessage(JSON.stringify(msg),cfg.origin)}};var onReady=function(trans,type){debug("ready msg received");if(ready)throw"received ready message while in ready state.  help!";if(type==="ping"){chanId+="-R"}else{chanId+="-L"}obj.unbind("__ready");ready=true;debug("ready msg accepted.");if(type==="ping"){obj.notify({method:"__ready",params:"pong"})}while(pendingQueue.length){postMessage(pendingQueue.pop())}if(typeof cfg.onReady==="function")cfg.onReady(obj)};var obj={unbind:function(method){if(regTbl[method]){if(!delete regTbl[method])throw"can't delete method: "+method;return true}return false},bind:function(method,cb){if(!method||typeof method!=="string")throw"'method' argument to bind must be string";if(!cb||typeof cb!=="function")throw"callback missing from bind params";if(regTbl[method])throw"method '"+method+"' is already bound!";regTbl[method]=cb;return this},call:function(m){if(!m)throw"missing arguments to call function";if(!m.method||typeof m.method!=="string")throw"'method' argument to call must be string";if(!m.success||typeof m.success!=="function")throw"'success' callback missing from call";var callbacks={};var callbackNames=[];var seen=[];var pruneFunctions=function(path,obj){if(seen.indexOf(obj)>=0){throw"params cannot be a recursive data structure"}seen.push(obj);if(typeof obj==="object"){for(var k in obj){if(!obj.hasOwnProperty(k))continue;var np=path+(path.length?"/":"")+k;if(typeof obj[k]==="function"){callbacks[np]=obj[k];callbackNames.push(np);delete obj[k]}else if(typeof obj[k]==="object"){pruneFunctions(np,obj[k])}}}};pruneFunctions("",m.params);var msg={id:s_curTranId,method:scopeMethod(m.method),params:m.params};if(callbackNames.length)msg.callbacks=callbackNames;if(m.timeout)setTransactionTimeout(s_curTranId,m.timeout,scopeMethod(m.method));outTbl[s_curTranId]={callbacks:callbacks,error:m.error,success:m.success};s_transIds[s_curTranId]=onMessage;s_curTranId++;postMessage(msg)},notify:function(m){if(!m)throw"missing arguments to notify function";if(!m.method||typeof m.method!=="string")throw"'method' argument to notify must be string";postMessage({method:scopeMethod(m.method),params:m.params})},destroy:function(){s_removeBoundChan(cfg.window,cfg.origin,typeof cfg.scope==="string"?cfg.scope:"");if(window.removeEventListener)window.removeEventListener("message",onMessage,false);else if(window.detachEvent)window.detachEvent("onmessage",onMessage);ready=false;regTbl={};inTbl={};outTbl={};cfg.origin=null;pendingQueue=[];debug("channel destroyed");chanId=""}};obj.bind("__ready",onReady);setTimeout(function(){postMessage({method:scopeMethod("__ready"),params:"ping"},true)},0);return obj}}}();browserify_shim__define__module__export__(typeof Channel!="undefined"?Channel:window.Channel)}).call(global,undefined,undefined,undefined,undefined,function defineExport(ex){module.exports=ex})}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],29:[function(require,module,exports){(function(global){var __browserify_shim_require__=require;(function browserifyShim(module,exports,require,define,browserify_shim__define__module__export__){(function(){var __bind=function(fn,me){return function(){return fn.apply(me,arguments)}};window.PageTextMapperCore=function(){function PageTextMapperCore(){this._onPageRendered=__bind(this._onPageRendered,this)}PageTextMapperCore.prototype.CONTEXT_LEN=32;PageTextMapperCore.prototype.getPageIndexForPos=function(pos){var info,_i,_len,_ref;_ref=this.pageInfo;for(_i=0,_len=_ref.length;_i<_len;_i++){info=_ref[_i];if(info.start<=pos&&pos<info.end){return info.index;console.log("Not on page "+info.index)}}return-1};PageTextMapperCore.prototype._onPageRendered=function(index){if(!(this._isPageRendered(index)&&this.pageInfo[index])){setTimeout(function(_this){return function(){return _this._onPageRendered(index)}}(this),1e3);return}return this._mapPage(this.pageInfo[index])};PageTextMapperCore.prototype.isPageMapped=function(index){var _ref;return((_ref=this.pageInfo[index])!=null?_ref.domMapper:void 0)!=null};PageTextMapperCore.prototype._mapPage=function(info){var renderedContent;info.node=this.getRootNodeForPage(info.index);info.domMapper=new DomTextMapper("d-t-m for page #"+info.index);info.domMapper.setRootNode(info.node);info.domMapper.documentChanged();if(this.requiresSmartStringPadding){info.domMapper.setExpectedContent(info.content)}info.domMapper.scan();renderedContent=info.domMapper.getCorpus();if(renderedContent!==info.content){console.log("Oops. Mismatch between rendered and extracted text, while mapping page #"+info.index+"!");console.trace();console.log("Rendered: "+renderedContent);console.log("Extracted: "+info.content)}return setTimeout(function(){var event;event=document.createEvent("UIEvents");event.initUIEvent("docPageMapped",false,false,window,0);event.pageIndex=info.index;return window.dispatchEvent(event)})};PageTextMapperCore.prototype._updateMap=function(info){info.domMapper.documentChanged();return info.domMapper.scan()};PageTextMapperCore.prototype._unmapPage=function(info){var event;delete info.domMapper;event=document.createEvent("UIEvents");event.initUIEvent("docPageUnmapped",false,false,window,0);event.pageIndex=info.index;return window.dispatchEvent(event)};PageTextMapperCore.prototype._onScroll=function(){var event;event=document.createEvent("UIEvents");event.initUIEvent("docPageScrolling",false,false,window,0);return window.dispatchEvent(event)};PageTextMapperCore.prototype.getInfoForNode=function(node){var info,k,nodeData,pageData,v;pageData=this.getPageForNode(node);if(!pageData.domMapper){return null}nodeData=pageData.domMapper.getInfoForNode(node);info={};for(k in nodeData){v=nodeData[k];info[k]=v}info.start+=pageData.start;info.end+=pageData.start;info.pageIndex=pageData.index;return info};PageTextMapperCore.prototype.getStartPosForNode=function(node){var nodeStart,pageData;pageData=this.getPageForNode(node);nodeStart=pageData.domMapper.getStartPosForNode(node);return pageData.start+nodeStart};PageTextMapperCore.prototype.getEndPosForNode=function(node){var nodeEnd,pageData;pageData=this.getPageForNode(node);nodeEnd=pageData.domMapper.getEndPosForNode(node);return pageData.start+nodeEnd};PageTextMapperCore.prototype.getMappingsForCharRange=function(start,end,pages){var endIndex,getSection,index,sections,startIndex,_i,_j,_len,_ref,_results;startIndex=this.getPageIndexForPos(start);endIndex=this.getPageIndexForPos(end);getSection=function(_this){return function(index){var info,mappings,realEnd,realStart;info=_this.pageInfo[index];realStart=Math.max(info.start,start)-info.start;realEnd=Math.min(info.end,end)-info.start;mappings=info.domMapper.getMappingsForCharRange(realStart,realEnd);return mappings.sections[0]}}(this);sections={};_ref=pages!=null?pages:function(){_results=[];for(var _j=startIndex;startIndex<=endIndex?_j<=endIndex:_j>=endIndex;startIndex<=endIndex?_j++:_j--){_results.push(_j)}return _results}.apply(this);for(_i=0,_len=_ref.length;_i<_len;_i++){index=_ref[_i];sections[index]=getSection(index)}return{sections:sections}};PageTextMapperCore.prototype.getCorpus=function(){if(!this._corpus){throw new Error("Hey! Called getCorpus() before corpus defined!")}return this._corpus};PageTextMapperCore.prototype.getContextForCharRange=function(start,end){var prefix,prefixLen,prefixStart,suffix;prefixStart=Math.max(0,start-this.CONTEXT_LEN);prefixLen=start-prefixStart;prefix=this._corpus.substr(prefixStart,prefixLen);suffix=this._corpus.substr(end,this.CONTEXT_LEN);return[prefix.trim(),suffix.trim()]};PageTextMapperCore.prototype._onHavePageContents=function(){var info,pos;this._corpus=function(){var _i,_len,_ref,_results;_ref=this.pageInfo;_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++){info=_ref[_i];_results.push(info.content)}return _results}.call(this).join(" ");pos=0;return this.pageInfo.forEach(function(_this){return function(info,i){info.len=info.content.length;info.start=pos;return info.end=pos+=info.len+1}}(this))};PageTextMapperCore.prototype._onAfterScan=function(){return this.pageInfo.forEach(function(_this){return function(info,i){if(_this._isPageRendered(i)){return _this._mapPage(info)}}}(this))};return PageTextMapperCore}()}).call(this);browserify_shim__define__module__export__(typeof PageTextMapperCore!="undefined"?PageTextMapperCore:window.PageTextMapperCore)}).call(global,undefined,undefined,undefined,undefined,function defineExport(ex){module.exports=ex})}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],30:[function(require,module,exports){(function(global){var __browserify_shim_require__=require;(function browserifyShim(module,exports,require,define,browserify_shim__define__module__export__){(function(){window.DTM_ExactMatcher=function(){function DTM_ExactMatcher(){this.distinct=true;this.caseSensitive=false}DTM_ExactMatcher.prototype.setDistinct=function(value){return this.distinct=value};DTM_ExactMatcher.prototype.setCaseSensitive=function(value){return this.caseSensitive=value};DTM_ExactMatcher.prototype.search=function(text,pattern){var i,index,pLen,results;pLen=pattern.length;results=[];index=0;if(!this.caseSensitive){text=text.toLowerCase();pattern=pattern.toLowerCase()}while((i=text.indexOf(pattern))>-1){(function(_this){return function(){results.push({start:index+i,end:index+i+pLen});if(_this.distinct){text=text.substr(i+pLen);return index+=i+pLen}else{text=text.substr(i+1);return index+=i+1}}})(this)()}return results};return DTM_ExactMatcher}();window.DTM_RegexMatcher=function(){function DTM_RegexMatcher(){this.caseSensitive=false}DTM_RegexMatcher.prototype.setCaseSensitive=function(value){return this.caseSensitive=value};DTM_RegexMatcher.prototype.search=function(text,pattern){var m,re,_results;re=new RegExp(pattern,this.caseSensitive?"g":"gi");_results=[];while(m=re.exec(text)){_results.push({start:m.index,end:m.index+m[0].length})}return _results};return DTM_RegexMatcher}();window.DTM_DMPMatcher=function(){function DTM_DMPMatcher(){this.dmp=new diff_match_patch;this.dmp.Diff_Timeout=0;this.caseSensitive=false}DTM_DMPMatcher.prototype._reverse=function(text){return text.split("").reverse().join("")};DTM_DMPMatcher.prototype.getMaxPatternLength=function(){return this.dmp.Match_MaxBits};DTM_DMPMatcher.prototype.setMatchDistance=function(distance){return this.dmp.Match_Distance=distance};DTM_DMPMatcher.prototype.getMatchDistance=function(){return this.dmp.Match_Distance};DTM_DMPMatcher.prototype.setMatchThreshold=function(threshold){return this.dmp.Match_Threshold=threshold};DTM_DMPMatcher.prototype.getMatchThreshold=function(){return this.dmp.Match_Threshold};DTM_DMPMatcher.prototype.getCaseSensitive=function(){return caseSensitive};DTM_DMPMatcher.prototype.setCaseSensitive=function(value){return this.caseSensitive=value};DTM_DMPMatcher.prototype.search=function(text,pattern,expectedStartLoc,options){var endIndex,endLen,endLoc,endPos,endSlice,found,matchLen,maxLen,pLen,result,startIndex,startLen,startPos,startSlice;if(expectedStartLoc==null){expectedStartLoc=0}if(options==null){options={}}if(expectedStartLoc<0){throw new Error("Can't search at negative indices!")}if(expectedStartLoc!==Math.floor(expectedStartLoc)){throw new Error("Expected start location must be an integer.")}if(!this.caseSensitive){text=text.toLowerCase();pattern=pattern.toLowerCase()}pLen=pattern.length;maxLen=this.getMaxPatternLength();if(pLen<=maxLen){result=this.searchForSlice(text,pattern,expectedStartLoc)}else{startSlice=pattern.substr(0,maxLen);startPos=this.searchForSlice(text,startSlice,expectedStartLoc);if(startPos!=null){startLen=startPos.end-startPos.start;endSlice=pattern.substr(pLen-maxLen,maxLen);endLoc=startPos.start+pLen-maxLen;endPos=this.searchForSlice(text,endSlice,endLoc);if(endPos!=null){endLen=endPos.end-endPos.start;matchLen=endPos.end-startPos.start;startIndex=startPos.start;endIndex=endPos.end;if(pLen*.5<=matchLen&&matchLen<=pLen*1.5){result={start:startIndex,end:endPos.end}}}}}if(result==null){return[]}if(options.withLevenhstein||options.withDiff){found=text.substr(result.start,result.end-result.start);result.diff=this.dmp.diff_main(pattern,found);if(options.withLevenshstein){result.lev=this.dmp.diff_levenshtein(result.diff)}if(options.withDiff){this.dmp.diff_cleanupSemantic(result.diff);result.diffHTML=this.dmp.diff_prettyHtml(result.diff)}}return[result]};DTM_DMPMatcher.prototype.compare=function(text1,text2){var result;if(!(text1!=null&&text2!=null)){throw new Error("Can not compare non-existing strings!")}result={};result.diff=this.dmp.diff_main(text1,text2);result.lev=this.dmp.diff_levenshtein(result.diff);result.errorLevel=result.lev/text1.length;this.dmp.diff_cleanupSemantic(result.diff);result.diffHTML=this.dmp.diff_prettyHtml(result.diff);return result};DTM_DMPMatcher.prototype.searchForSlice=function(text,slice,expectedStartLoc){var dneIndex,endIndex,expectedDneLoc,expectedEndLoc,nrettap,r1,r2,result,startIndex,txet;r1=this.dmp.match_main(text,slice,expectedStartLoc);startIndex=r1.index;if(startIndex===-1){return null}txet=this._reverse(text);nrettap=this._reverse(slice);expectedEndLoc=startIndex+slice.length;expectedDneLoc=text.length-expectedEndLoc;r2=this.dmp.match_main(txet,nrettap,expectedDneLoc);dneIndex=r2.index;endIndex=text.length-dneIndex;return result={start:startIndex,end:endIndex}};return DTM_DMPMatcher}()}).call(this);browserify_shim__define__module__export__(typeof TextMatchEngines!="undefined"?TextMatchEngines:window.TextMatchEngines)}).call(global,undefined,undefined,undefined,undefined,function defineExport(ex){module.exports=ex})}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],31:[function(require,module,exports){(function(process,global){var __browserify_shim_require__=require;(function browserifyShim(module,exports,require,define,browserify_shim__define__module__export__){(function(){"use strict";function lib$es6$promise$utils$$objectOrFunction(x){return typeof x==="function"||typeof x==="object"&&x!==null}function lib$es6$promise$utils$$isFunction(x){return typeof x==="function"}function lib$es6$promise$utils$$isMaybeThenable(x){return typeof x==="object"&&x!==null}var lib$es6$promise$utils$$_isArray;if(!Array.isArray){lib$es6$promise$utils$$_isArray=function(x){return Object.prototype.toString.call(x)==="[object Array]"}}else{lib$es6$promise$utils$$_isArray=Array.isArray}var lib$es6$promise$utils$$isArray=lib$es6$promise$utils$$_isArray;var lib$es6$promise$asap$$len=0;var lib$es6$promise$asap$$toString={}.toString;var lib$es6$promise$asap$$vertxNext;function lib$es6$promise$asap$$asap(callback,arg){lib$es6$promise$asap$$queue[lib$es6$promise$asap$$len]=callback;lib$es6$promise$asap$$queue[lib$es6$promise$asap$$len+1]=arg;lib$es6$promise$asap$$len+=2;if(lib$es6$promise$asap$$len===2){lib$es6$promise$asap$$scheduleFlush()}}var lib$es6$promise$asap$$default=lib$es6$promise$asap$$asap;var lib$es6$promise$asap$$browserWindow=typeof window!=="undefined"?window:undefined;var lib$es6$promise$asap$$browserGlobal=lib$es6$promise$asap$$browserWindow||{};var lib$es6$promise$asap$$BrowserMutationObserver=lib$es6$promise$asap$$browserGlobal.MutationObserver||lib$es6$promise$asap$$browserGlobal.WebKitMutationObserver;var lib$es6$promise$asap$$isNode=typeof process!=="undefined"&&{}.toString.call(process)==="[object process]";var lib$es6$promise$asap$$isWorker=typeof Uint8ClampedArray!=="undefined"&&typeof importScripts!=="undefined"&&typeof MessageChannel!=="undefined";function lib$es6$promise$asap$$useNextTick(){var nextTick=process.nextTick;var version=process.versions.node.match(/^(?:(\d+)\.)?(?:(\d+)\.)?(\*|\d+)$/);if(Array.isArray(version)&&version[1]==="0"&&version[2]==="10"){nextTick=setImmediate}return function(){nextTick(lib$es6$promise$asap$$flush)}}function lib$es6$promise$asap$$useVertxTimer(){return function(){lib$es6$promise$asap$$vertxNext(lib$es6$promise$asap$$flush)}}function lib$es6$promise$asap$$useMutationObserver(){var iterations=0;var observer=new lib$es6$promise$asap$$BrowserMutationObserver(lib$es6$promise$asap$$flush);var node=document.createTextNode("");observer.observe(node,{characterData:true});return function(){node.data=iterations=++iterations%2}}function lib$es6$promise$asap$$useMessageChannel(){var channel=new MessageChannel;channel.port1.onmessage=lib$es6$promise$asap$$flush;return function(){channel.port2.postMessage(0)}}function lib$es6$promise$asap$$useSetTimeout(){return function(){setTimeout(lib$es6$promise$asap$$flush,1)}}var lib$es6$promise$asap$$queue=new Array(1e3);function lib$es6$promise$asap$$flush(){for(var i=0;i<lib$es6$promise$asap$$len;i+=2){var callback=lib$es6$promise$asap$$queue[i];var arg=lib$es6$promise$asap$$queue[i+1];callback(arg);lib$es6$promise$asap$$queue[i]=undefined;lib$es6$promise$asap$$queue[i+1]=undefined}lib$es6$promise$asap$$len=0}function lib$es6$promise$asap$$attemptVertex(){try{var r=require;var vertx=r("vertx");lib$es6$promise$asap$$vertxNext=vertx.runOnLoop||vertx.runOnContext;return lib$es6$promise$asap$$useVertxTimer()}catch(e){return lib$es6$promise$asap$$useSetTimeout()}}var lib$es6$promise$asap$$scheduleFlush;if(lib$es6$promise$asap$$isNode){lib$es6$promise$asap$$scheduleFlush=lib$es6$promise$asap$$useNextTick()}else if(lib$es6$promise$asap$$BrowserMutationObserver){lib$es6$promise$asap$$scheduleFlush=lib$es6$promise$asap$$useMutationObserver()}else if(lib$es6$promise$asap$$isWorker){lib$es6$promise$asap$$scheduleFlush=lib$es6$promise$asap$$useMessageChannel()}else if(lib$es6$promise$asap$$browserWindow===undefined&&typeof require==="function"){lib$es6$promise$asap$$scheduleFlush=lib$es6$promise$asap$$attemptVertex()}else{lib$es6$promise$asap$$scheduleFlush=lib$es6$promise$asap$$useSetTimeout()}function lib$es6$promise$$internal$$noop(){}var lib$es6$promise$$internal$$PENDING=void 0;var lib$es6$promise$$internal$$FULFILLED=1;var lib$es6$promise$$internal$$REJECTED=2;var lib$es6$promise$$internal$$GET_THEN_ERROR=new lib$es6$promise$$internal$$ErrorObject;function lib$es6$promise$$internal$$selfFullfillment(){return new TypeError("You cannot resolve a promise with itself")}function lib$es6$promise$$internal$$cannotReturnOwn(){return new TypeError("A promises callback cannot return that same promise.")}function lib$es6$promise$$internal$$getThen(promise){try{return promise.then}catch(error){lib$es6$promise$$internal$$GET_THEN_ERROR.error=error;return lib$es6$promise$$internal$$GET_THEN_ERROR}}function lib$es6$promise$$internal$$tryThen(then,value,fulfillmentHandler,rejectionHandler){try{then.call(value,fulfillmentHandler,rejectionHandler)}catch(e){return e}}function lib$es6$promise$$internal$$handleForeignThenable(promise,thenable,then){lib$es6$promise$asap$$default(function(promise){var sealed=false;var error=lib$es6$promise$$internal$$tryThen(then,thenable,function(value){if(sealed){return}sealed=true;if(thenable!==value){lib$es6$promise$$internal$$resolve(promise,value)}else{lib$es6$promise$$internal$$fulfill(promise,value)}},function(reason){if(sealed){return}sealed=true;lib$es6$promise$$internal$$reject(promise,reason)},"Settle: "+(promise._label||" unknown promise"));if(!sealed&&error){sealed=true;lib$es6$promise$$internal$$reject(promise,error)}},promise)}function lib$es6$promise$$internal$$handleOwnThenable(promise,thenable){if(thenable._state===lib$es6$promise$$internal$$FULFILLED){lib$es6$promise$$internal$$fulfill(promise,thenable._result)}else if(thenable._state===lib$es6$promise$$internal$$REJECTED){lib$es6$promise$$internal$$reject(promise,thenable._result)}else{lib$es6$promise$$internal$$subscribe(thenable,undefined,function(value){lib$es6$promise$$internal$$resolve(promise,value)},function(reason){lib$es6$promise$$internal$$reject(promise,reason)})}}function lib$es6$promise$$internal$$handleMaybeThenable(promise,maybeThenable){if(maybeThenable.constructor===promise.constructor){lib$es6$promise$$internal$$handleOwnThenable(promise,maybeThenable)}else{var then=lib$es6$promise$$internal$$getThen(maybeThenable);if(then===lib$es6$promise$$internal$$GET_THEN_ERROR){lib$es6$promise$$internal$$reject(promise,lib$es6$promise$$internal$$GET_THEN_ERROR.error)}else if(then===undefined){lib$es6$promise$$internal$$fulfill(promise,maybeThenable)}else if(lib$es6$promise$utils$$isFunction(then)){lib$es6$promise$$internal$$handleForeignThenable(promise,maybeThenable,then)}else{lib$es6$promise$$internal$$fulfill(promise,maybeThenable)}}}function lib$es6$promise$$internal$$resolve(promise,value){if(promise===value){lib$es6$promise$$internal$$reject(promise,lib$es6$promise$$internal$$selfFullfillment())}else if(lib$es6$promise$utils$$objectOrFunction(value)){lib$es6$promise$$internal$$handleMaybeThenable(promise,value)}else{lib$es6$promise$$internal$$fulfill(promise,value)}}function lib$es6$promise$$internal$$publishRejection(promise){if(promise._onerror){promise._onerror(promise._result)}lib$es6$promise$$internal$$publish(promise)}function lib$es6$promise$$internal$$fulfill(promise,value){if(promise._state!==lib$es6$promise$$internal$$PENDING){return}promise._result=value;promise._state=lib$es6$promise$$internal$$FULFILLED;if(promise._subscribers.length!==0){lib$es6$promise$asap$$default(lib$es6$promise$$internal$$publish,promise)}}function lib$es6$promise$$internal$$reject(promise,reason){if(promise._state!==lib$es6$promise$$internal$$PENDING){return}promise._state=lib$es6$promise$$internal$$REJECTED;promise._result=reason;lib$es6$promise$asap$$default(lib$es6$promise$$internal$$publishRejection,promise)}function lib$es6$promise$$internal$$subscribe(parent,child,onFulfillment,onRejection){var subscribers=parent._subscribers;var length=subscribers.length;parent._onerror=null;subscribers[length]=child;subscribers[length+lib$es6$promise$$internal$$FULFILLED]=onFulfillment;subscribers[length+lib$es6$promise$$internal$$REJECTED]=onRejection;if(length===0&&parent._state){lib$es6$promise$asap$$default(lib$es6$promise$$internal$$publish,parent)}}function lib$es6$promise$$internal$$publish(promise){
var subscribers=promise._subscribers;var settled=promise._state;if(subscribers.length===0){return}var child,callback,detail=promise._result;for(var i=0;i<subscribers.length;i+=3){child=subscribers[i];callback=subscribers[i+settled];if(child){lib$es6$promise$$internal$$invokeCallback(settled,child,callback,detail)}else{callback(detail)}}promise._subscribers.length=0}function lib$es6$promise$$internal$$ErrorObject(){this.error=null}var lib$es6$promise$$internal$$TRY_CATCH_ERROR=new lib$es6$promise$$internal$$ErrorObject;function lib$es6$promise$$internal$$tryCatch(callback,detail){try{return callback(detail)}catch(e){lib$es6$promise$$internal$$TRY_CATCH_ERROR.error=e;return lib$es6$promise$$internal$$TRY_CATCH_ERROR}}function lib$es6$promise$$internal$$invokeCallback(settled,promise,callback,detail){var hasCallback=lib$es6$promise$utils$$isFunction(callback),value,error,succeeded,failed;if(hasCallback){value=lib$es6$promise$$internal$$tryCatch(callback,detail);if(value===lib$es6$promise$$internal$$TRY_CATCH_ERROR){failed=true;error=value.error;value=null}else{succeeded=true}if(promise===value){lib$es6$promise$$internal$$reject(promise,lib$es6$promise$$internal$$cannotReturnOwn());return}}else{value=detail;succeeded=true}if(promise._state!==lib$es6$promise$$internal$$PENDING){}else if(hasCallback&&succeeded){lib$es6$promise$$internal$$resolve(promise,value)}else if(failed){lib$es6$promise$$internal$$reject(promise,error)}else if(settled===lib$es6$promise$$internal$$FULFILLED){lib$es6$promise$$internal$$fulfill(promise,value)}else if(settled===lib$es6$promise$$internal$$REJECTED){lib$es6$promise$$internal$$reject(promise,value)}}function lib$es6$promise$$internal$$initializePromise(promise,resolver){try{resolver(function resolvePromise(value){lib$es6$promise$$internal$$resolve(promise,value)},function rejectPromise(reason){lib$es6$promise$$internal$$reject(promise,reason)})}catch(e){lib$es6$promise$$internal$$reject(promise,e)}}function lib$es6$promise$enumerator$$Enumerator(Constructor,input){var enumerator=this;enumerator._instanceConstructor=Constructor;enumerator.promise=new Constructor(lib$es6$promise$$internal$$noop);if(enumerator._validateInput(input)){enumerator._input=input;enumerator.length=input.length;enumerator._remaining=input.length;enumerator._init();if(enumerator.length===0){lib$es6$promise$$internal$$fulfill(enumerator.promise,enumerator._result)}else{enumerator.length=enumerator.length||0;enumerator._enumerate();if(enumerator._remaining===0){lib$es6$promise$$internal$$fulfill(enumerator.promise,enumerator._result)}}}else{lib$es6$promise$$internal$$reject(enumerator.promise,enumerator._validationError())}}lib$es6$promise$enumerator$$Enumerator.prototype._validateInput=function(input){return lib$es6$promise$utils$$isArray(input)};lib$es6$promise$enumerator$$Enumerator.prototype._validationError=function(){return new Error("Array Methods must be provided an Array")};lib$es6$promise$enumerator$$Enumerator.prototype._init=function(){this._result=new Array(this.length)};var lib$es6$promise$enumerator$$default=lib$es6$promise$enumerator$$Enumerator;lib$es6$promise$enumerator$$Enumerator.prototype._enumerate=function(){var enumerator=this;var length=enumerator.length;var promise=enumerator.promise;var input=enumerator._input;for(var i=0;promise._state===lib$es6$promise$$internal$$PENDING&&i<length;i++){enumerator._eachEntry(input[i],i)}};lib$es6$promise$enumerator$$Enumerator.prototype._eachEntry=function(entry,i){var enumerator=this;var c=enumerator._instanceConstructor;if(lib$es6$promise$utils$$isMaybeThenable(entry)){if(entry.constructor===c&&entry._state!==lib$es6$promise$$internal$$PENDING){entry._onerror=null;enumerator._settledAt(entry._state,i,entry._result)}else{enumerator._willSettleAt(c.resolve(entry),i)}}else{enumerator._remaining--;enumerator._result[i]=entry}};lib$es6$promise$enumerator$$Enumerator.prototype._settledAt=function(state,i,value){var enumerator=this;var promise=enumerator.promise;if(promise._state===lib$es6$promise$$internal$$PENDING){enumerator._remaining--;if(state===lib$es6$promise$$internal$$REJECTED){lib$es6$promise$$internal$$reject(promise,value)}else{enumerator._result[i]=value}}if(enumerator._remaining===0){lib$es6$promise$$internal$$fulfill(promise,enumerator._result)}};lib$es6$promise$enumerator$$Enumerator.prototype._willSettleAt=function(promise,i){var enumerator=this;lib$es6$promise$$internal$$subscribe(promise,undefined,function(value){enumerator._settledAt(lib$es6$promise$$internal$$FULFILLED,i,value)},function(reason){enumerator._settledAt(lib$es6$promise$$internal$$REJECTED,i,reason)})};function lib$es6$promise$promise$all$$all(entries){return new lib$es6$promise$enumerator$$default(this,entries).promise}var lib$es6$promise$promise$all$$default=lib$es6$promise$promise$all$$all;function lib$es6$promise$promise$race$$race(entries){var Constructor=this;var promise=new Constructor(lib$es6$promise$$internal$$noop);if(!lib$es6$promise$utils$$isArray(entries)){lib$es6$promise$$internal$$reject(promise,new TypeError("You must pass an array to race."));return promise}var length=entries.length;function onFulfillment(value){lib$es6$promise$$internal$$resolve(promise,value)}function onRejection(reason){lib$es6$promise$$internal$$reject(promise,reason)}for(var i=0;promise._state===lib$es6$promise$$internal$$PENDING&&i<length;i++){lib$es6$promise$$internal$$subscribe(Constructor.resolve(entries[i]),undefined,onFulfillment,onRejection)}return promise}var lib$es6$promise$promise$race$$default=lib$es6$promise$promise$race$$race;function lib$es6$promise$promise$resolve$$resolve(object){var Constructor=this;if(object&&typeof object==="object"&&object.constructor===Constructor){return object}var promise=new Constructor(lib$es6$promise$$internal$$noop);lib$es6$promise$$internal$$resolve(promise,object);return promise}var lib$es6$promise$promise$resolve$$default=lib$es6$promise$promise$resolve$$resolve;function lib$es6$promise$promise$reject$$reject(reason){var Constructor=this;var promise=new Constructor(lib$es6$promise$$internal$$noop);lib$es6$promise$$internal$$reject(promise,reason);return promise}var lib$es6$promise$promise$reject$$default=lib$es6$promise$promise$reject$$reject;var lib$es6$promise$promise$$counter=0;function lib$es6$promise$promise$$needsResolver(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function lib$es6$promise$promise$$needsNew(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}var lib$es6$promise$promise$$default=lib$es6$promise$promise$$Promise;function lib$es6$promise$promise$$Promise(resolver){this._id=lib$es6$promise$promise$$counter++;this._state=undefined;this._result=undefined;this._subscribers=[];if(lib$es6$promise$$internal$$noop!==resolver){if(!lib$es6$promise$utils$$isFunction(resolver)){lib$es6$promise$promise$$needsResolver()}if(!(this instanceof lib$es6$promise$promise$$Promise)){lib$es6$promise$promise$$needsNew()}lib$es6$promise$$internal$$initializePromise(this,resolver)}}lib$es6$promise$promise$$Promise.all=lib$es6$promise$promise$all$$default;lib$es6$promise$promise$$Promise.race=lib$es6$promise$promise$race$$default;lib$es6$promise$promise$$Promise.resolve=lib$es6$promise$promise$resolve$$default;lib$es6$promise$promise$$Promise.reject=lib$es6$promise$promise$reject$$default;lib$es6$promise$promise$$Promise.prototype={constructor:lib$es6$promise$promise$$Promise,then:function(onFulfillment,onRejection){var parent=this;var state=parent._state;if(state===lib$es6$promise$$internal$$FULFILLED&&!onFulfillment||state===lib$es6$promise$$internal$$REJECTED&&!onRejection){return this}var child=new this.constructor(lib$es6$promise$$internal$$noop);var result=parent._result;if(state){var callback=arguments[state-1];lib$es6$promise$asap$$default(function(){lib$es6$promise$$internal$$invokeCallback(state,child,callback,result)})}else{lib$es6$promise$$internal$$subscribe(parent,child,onFulfillment,onRejection)}return child},"catch":function(onRejection){return this.then(null,onRejection)}};function lib$es6$promise$polyfill$$polyfill(){var local;if(typeof global!=="undefined"){local=global}else if(typeof self!=="undefined"){local=self}else{try{local=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}}var P=local.Promise;if(P&&Object.prototype.toString.call(P.resolve())==="[object Promise]"&&!P.cast){return}local.Promise=lib$es6$promise$promise$$default}var lib$es6$promise$polyfill$$default=lib$es6$promise$polyfill$$polyfill;var lib$es6$promise$umd$$ES6Promise={Promise:lib$es6$promise$promise$$default,polyfill:lib$es6$promise$polyfill$$default};if(typeof define==="function"&&define["amd"]){define(function(){return lib$es6$promise$umd$$ES6Promise})}else if(typeof module!=="undefined"&&module["exports"]){module["exports"]=lib$es6$promise$umd$$ES6Promise}else if(typeof this!=="undefined"){this["ES6Promise"]=lib$es6$promise$umd$$ES6Promise}lib$es6$promise$polyfill$$default()}).call(this);browserify_shim__define__module__export__(typeof ES6Promise!="undefined"?ES6Promise:window.ES6Promise)}).call(global,undefined,undefined,undefined,undefined,function defineExport(ex){module.exports=ex})}).call(this,require("_process"),typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{_process:36}],32:[function(require,module,exports){var hasOwn=Object.prototype.hasOwnProperty;var toStr=Object.prototype.toString;var undefined;var isArray=function isArray(arr){if(typeof Array.isArray==="function"){return Array.isArray(arr)}return toStr.call(arr)==="[object Array]"};var isPlainObject=function isPlainObject(obj){"use strict";if(!obj||toStr.call(obj)!=="[object Object]"){return false}var has_own_constructor=hasOwn.call(obj,"constructor");var has_is_property_of_method=obj.constructor&&obj.constructor.prototype&&hasOwn.call(obj.constructor.prototype,"isPrototypeOf");if(obj.constructor&&!has_own_constructor&&!has_is_property_of_method){return false}var key;for(key in obj){}return key===undefined||hasOwn.call(obj,key)};module.exports=function extend(){"use strict";var options,name,src,copy,copyIsArray,clone,target=arguments[0],i=1,length=arguments.length,deep=false;if(typeof target==="boolean"){deep=target;target=arguments[1]||{};i=2}else if(typeof target!=="object"&&typeof target!=="function"||target==null){target={}}for(;i<length;++i){options=arguments[i];if(options!=null){for(name in options){src=target[name];copy=options[name];if(target===copy){continue}if(deep&&copy&&(isPlainObject(copy)||(copyIsArray=isArray(copy)))){if(copyIsArray){copyIsArray=false;clone=src&&isArray(src)?src:[]}else{clone=src&&isPlainObject(src)?src:{}}target[name]=extend(deep,clone,copy)}else if(copy!==undefined){target[name]=copy}}}}return target}},{}],33:[function(require,module,exports){(function(global){var __browserify_shim_require__=require;(function browserifyShim(module,exports,require,define,browserify_shim__define__module__export__){(function(window,document,exportName,undefined){"use strict";var VENDOR_PREFIXES=["","webkit","moz","MS","ms","o"];var TEST_ELEMENT=document.createElement("div");var TYPE_FUNCTION="function";var round=Math.round;var abs=Math.abs;var now=Date.now;function setTimeoutContext(fn,timeout,context){return setTimeout(bindFn(fn,context),timeout)}function invokeArrayArg(arg,fn,context){if(Array.isArray(arg)){each(arg,context[fn],context);return true}return false}function each(obj,iterator,context){var i;if(!obj){return}if(obj.forEach){obj.forEach(iterator,context)}else if(obj.length!==undefined){i=0;while(i<obj.length){iterator.call(context,obj[i],i,obj);i++}}else{for(i in obj){obj.hasOwnProperty(i)&&iterator.call(context,obj[i],i,obj)}}}function extend(dest,src,merge){var keys=Object.keys(src);var i=0;while(i<keys.length){if(!merge||merge&&dest[keys[i]]===undefined){dest[keys[i]]=src[keys[i]]}i++}return dest}function merge(dest,src){return extend(dest,src,true)}function inherit(child,base,properties){var baseP=base.prototype,childP;childP=child.prototype=Object.create(baseP);childP.constructor=child;childP._super=baseP;if(properties){extend(childP,properties)}}function bindFn(fn,context){return function boundFn(){return fn.apply(context,arguments)}}function boolOrFn(val,args){if(typeof val==TYPE_FUNCTION){return val.apply(args?args[0]||undefined:undefined,args)}return val}function ifUndefined(val1,val2){return val1===undefined?val2:val1}function addEventListeners(target,types,handler){each(splitStr(types),function(type){target.addEventListener(type,handler,false)})}function removeEventListeners(target,types,handler){each(splitStr(types),function(type){target.removeEventListener(type,handler,false)})}function hasParent(node,parent){while(node){if(node==parent){return true}node=node.parentNode}return false}function inStr(str,find){return str.indexOf(find)>-1}function splitStr(str){return str.trim().split(/\s+/g)}function inArray(src,find,findByKey){if(src.indexOf&&!findByKey){return src.indexOf(find)}else{var i=0;while(i<src.length){if(findByKey&&src[i][findByKey]==find||!findByKey&&src[i]===find){return i}i++}return-1}}function toArray(obj){return Array.prototype.slice.call(obj,0)}function uniqueArray(src,key,sort){var results=[];var values=[];var i=0;while(i<src.length){var val=key?src[i][key]:src[i];if(inArray(values,val)<0){results.push(src[i])}values[i]=val;i++}if(sort){if(!key){results=results.sort()}else{results=results.sort(function sortUniqueArray(a,b){return a[key]>b[key]})}}return results}function prefixed(obj,property){var prefix,prop;var camelProp=property[0].toUpperCase()+property.slice(1);var i=0;while(i<VENDOR_PREFIXES.length){prefix=VENDOR_PREFIXES[i];prop=prefix?prefix+camelProp:property;if(prop in obj){return prop}i++}return undefined}var _uniqueId=1;function uniqueId(){return _uniqueId++}function getWindowForElement(element){var doc=element.ownerDocument;return doc.defaultView||doc.parentWindow}var MOBILE_REGEX=/mobile|tablet|ip(ad|hone|od)|android/i;var SUPPORT_TOUCH="ontouchstart"in window;var SUPPORT_POINTER_EVENTS=prefixed(window,"PointerEvent")!==undefined;var SUPPORT_ONLY_TOUCH=SUPPORT_TOUCH&&MOBILE_REGEX.test(navigator.userAgent);var INPUT_TYPE_TOUCH="touch";var INPUT_TYPE_PEN="pen";var INPUT_TYPE_MOUSE="mouse";var INPUT_TYPE_KINECT="kinect";var COMPUTE_INTERVAL=25;var INPUT_START=1;var INPUT_MOVE=2;var INPUT_END=4;var INPUT_CANCEL=8;var DIRECTION_NONE=1;var DIRECTION_LEFT=2;var DIRECTION_RIGHT=4;var DIRECTION_UP=8;var DIRECTION_DOWN=16;var DIRECTION_HORIZONTAL=DIRECTION_LEFT|DIRECTION_RIGHT;var DIRECTION_VERTICAL=DIRECTION_UP|DIRECTION_DOWN;var DIRECTION_ALL=DIRECTION_HORIZONTAL|DIRECTION_VERTICAL;var PROPS_XY=["x","y"];var PROPS_CLIENT_XY=["clientX","clientY"];function Input(manager,callback){var self=this;this.manager=manager;this.callback=callback;this.element=manager.element;this.target=manager.options.inputTarget;this.domHandler=function(ev){if(boolOrFn(manager.options.enable,[manager])){self.handler(ev)}};this.init()}Input.prototype={handler:function(){},init:function(){this.evEl&&addEventListeners(this.element,this.evEl,this.domHandler);this.evTarget&&addEventListeners(this.target,this.evTarget,this.domHandler);this.evWin&&addEventListeners(getWindowForElement(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&removeEventListeners(this.element,this.evEl,this.domHandler);this.evTarget&&removeEventListeners(this.target,this.evTarget,this.domHandler);this.evWin&&removeEventListeners(getWindowForElement(this.element),this.evWin,this.domHandler)}};function createInputInstance(manager){var Type;var inputClass=manager.options.inputClass;if(inputClass){Type=inputClass}else if(SUPPORT_POINTER_EVENTS){Type=PointerEventInput}else if(SUPPORT_ONLY_TOUCH){Type=TouchInput}else if(!SUPPORT_TOUCH){Type=MouseInput}else{Type=TouchMouseInput}return new Type(manager,inputHandler)}function inputHandler(manager,eventType,input){var pointersLen=input.pointers.length;var changedPointersLen=input.changedPointers.length;var isFirst=eventType&INPUT_START&&pointersLen-changedPointersLen===0;var isFinal=eventType&(INPUT_END|INPUT_CANCEL)&&pointersLen-changedPointersLen===0;input.isFirst=!!isFirst;input.isFinal=!!isFinal;if(isFirst){manager.session={}}input.eventType=eventType;computeInputData(manager,input);manager.emit("hammer.input",input);manager.recognize(input);manager.session.prevInput=input}function computeInputData(manager,input){var session=manager.session;var pointers=input.pointers;var pointersLength=pointers.length;if(!session.firstInput){session.firstInput=simpleCloneInputData(input)}if(pointersLength>1&&!session.firstMultiple){session.firstMultiple=simpleCloneInputData(input)}else if(pointersLength===1){session.firstMultiple=false}var firstInput=session.firstInput;var firstMultiple=session.firstMultiple;var offsetCenter=firstMultiple?firstMultiple.center:firstInput.center;var center=input.center=getCenter(pointers);input.timeStamp=now();input.deltaTime=input.timeStamp-firstInput.timeStamp;input.angle=getAngle(offsetCenter,center);input.distance=getDistance(offsetCenter,center);computeDeltaXY(session,input);input.offsetDirection=getDirection(input.deltaX,input.deltaY);input.scale=firstMultiple?getScale(firstMultiple.pointers,pointers):1;input.rotation=firstMultiple?getRotation(firstMultiple.pointers,pointers):0;computeIntervalInputData(session,input);var target=manager.element;if(hasParent(input.srcEvent.target,target)){target=input.srcEvent.target}input.target=target}function computeDeltaXY(session,input){var center=input.center;var offset=session.offsetDelta||{};var prevDelta=session.prevDelta||{};var prevInput=session.prevInput||{};if(input.eventType===INPUT_START||prevInput.eventType===INPUT_END){prevDelta=session.prevDelta={x:prevInput.deltaX||0,y:prevInput.deltaY||0};offset=session.offsetDelta={x:center.x,y:center.y}}input.deltaX=prevDelta.x+(center.x-offset.x);input.deltaY=prevDelta.y+(center.y-offset.y)}function computeIntervalInputData(session,input){var last=session.lastInterval||input,deltaTime=input.timeStamp-last.timeStamp,velocity,velocityX,velocityY,direction;if(input.eventType!=INPUT_CANCEL&&(deltaTime>COMPUTE_INTERVAL||last.velocity===undefined)){var deltaX=last.deltaX-input.deltaX;var deltaY=last.deltaY-input.deltaY;var v=getVelocity(deltaTime,deltaX,deltaY);velocityX=v.x;velocityY=v.y;velocity=abs(v.x)>abs(v.y)?v.x:v.y;direction=getDirection(deltaX,deltaY);session.lastInterval=input}else{velocity=last.velocity;velocityX=last.velocityX;velocityY=last.velocityY;direction=last.direction}input.velocity=velocity;input.velocityX=velocityX;input.velocityY=velocityY;input.direction=direction}function simpleCloneInputData(input){var pointers=[];var i=0;while(i<input.pointers.length){pointers[i]={clientX:round(input.pointers[i].clientX),clientY:round(input.pointers[i].clientY)};i++}return{timeStamp:now(),pointers:pointers,center:getCenter(pointers),deltaX:input.deltaX,deltaY:input.deltaY}}function getCenter(pointers){var pointersLength=pointers.length;if(pointersLength===1){return{x:round(pointers[0].clientX),y:round(pointers[0].clientY)}}var x=0,y=0,i=0;while(i<pointersLength){x+=pointers[i].clientX;y+=pointers[i].clientY;i++}return{x:round(x/pointersLength),y:round(y/pointersLength)}}function getVelocity(deltaTime,x,y){return{x:x/deltaTime||0,y:y/deltaTime||0}}function getDirection(x,y){if(x===y){return DIRECTION_NONE}if(abs(x)>=abs(y)){return x>0?DIRECTION_LEFT:DIRECTION_RIGHT}return y>0?DIRECTION_UP:DIRECTION_DOWN}function getDistance(p1,p2,props){if(!props){props=PROPS_XY}var x=p2[props[0]]-p1[props[0]],y=p2[props[1]]-p1[props[1]];return Math.sqrt(x*x+y*y)}function getAngle(p1,p2,props){if(!props){props=PROPS_XY}var x=p2[props[0]]-p1[props[0]],y=p2[props[1]]-p1[props[1]];return Math.atan2(y,x)*180/Math.PI}function getRotation(start,end){return getAngle(end[1],end[0],PROPS_CLIENT_XY)-getAngle(start[1],start[0],PROPS_CLIENT_XY)}function getScale(start,end){return getDistance(end[0],end[1],PROPS_CLIENT_XY)/getDistance(start[0],start[1],PROPS_CLIENT_XY)}var MOUSE_INPUT_MAP={mousedown:INPUT_START,mousemove:INPUT_MOVE,mouseup:INPUT_END};var MOUSE_ELEMENT_EVENTS="mousedown";var MOUSE_WINDOW_EVENTS="mousemove mouseup";function MouseInput(){this.evEl=MOUSE_ELEMENT_EVENTS;this.evWin=MOUSE_WINDOW_EVENTS;this.allow=true;this.pressed=false;Input.apply(this,arguments)}inherit(MouseInput,Input,{handler:function MEhandler(ev){var eventType=MOUSE_INPUT_MAP[ev.type];if(eventType&INPUT_START&&ev.button===0){this.pressed=true}if(eventType&INPUT_MOVE&&ev.which!==1){eventType=INPUT_END}if(!this.pressed||!this.allow){return}if(eventType&INPUT_END){this.pressed=false}this.callback(this.manager,eventType,{pointers:[ev],changedPointers:[ev],pointerType:INPUT_TYPE_MOUSE,srcEvent:ev})}});var POINTER_INPUT_MAP={pointerdown:INPUT_START,pointermove:INPUT_MOVE,pointerup:INPUT_END,pointercancel:INPUT_CANCEL,pointerout:INPUT_CANCEL};var IE10_POINTER_TYPE_ENUM={2:INPUT_TYPE_TOUCH,3:INPUT_TYPE_PEN,4:INPUT_TYPE_MOUSE,5:INPUT_TYPE_KINECT};var POINTER_ELEMENT_EVENTS="pointerdown";var POINTER_WINDOW_EVENTS="pointermove pointerup pointercancel";if(window.MSPointerEvent){POINTER_ELEMENT_EVENTS="MSPointerDown";POINTER_WINDOW_EVENTS="MSPointerMove MSPointerUp MSPointerCancel"}function PointerEventInput(){this.evEl=POINTER_ELEMENT_EVENTS;this.evWin=POINTER_WINDOW_EVENTS;Input.apply(this,arguments);this.store=this.manager.session.pointerEvents=[]}inherit(PointerEventInput,Input,{handler:function PEhandler(ev){var store=this.store;var removePointer=false;var eventTypeNormalized=ev.type.toLowerCase().replace("ms","");var eventType=POINTER_INPUT_MAP[eventTypeNormalized];var pointerType=IE10_POINTER_TYPE_ENUM[ev.pointerType]||ev.pointerType;var isTouch=pointerType==INPUT_TYPE_TOUCH;var storeIndex=inArray(store,ev.pointerId,"pointerId");if(eventType&INPUT_START&&(ev.button===0||isTouch)){if(storeIndex<0){store.push(ev);storeIndex=store.length-1}}else if(eventType&(INPUT_END|INPUT_CANCEL)){removePointer=true}if(storeIndex<0){return}store[storeIndex]=ev;this.callback(this.manager,eventType,{pointers:store,changedPointers:[ev],pointerType:pointerType,srcEvent:ev});if(removePointer){store.splice(storeIndex,1)}}});var SINGLE_TOUCH_INPUT_MAP={touchstart:INPUT_START,touchmove:INPUT_MOVE,touchend:INPUT_END,touchcancel:INPUT_CANCEL};var SINGLE_TOUCH_TARGET_EVENTS="touchstart";var SINGLE_TOUCH_WINDOW_EVENTS="touchstart touchmove touchend touchcancel";function SingleTouchInput(){this.evTarget=SINGLE_TOUCH_TARGET_EVENTS;this.evWin=SINGLE_TOUCH_WINDOW_EVENTS;this.started=false;Input.apply(this,arguments)}inherit(SingleTouchInput,Input,{handler:function TEhandler(ev){var type=SINGLE_TOUCH_INPUT_MAP[ev.type];if(type===INPUT_START){this.started=true}if(!this.started){return}var touches=normalizeSingleTouches.call(this,ev,type);if(type&(INPUT_END|INPUT_CANCEL)&&touches[0].length-touches[1].length===0){this.started=false}this.callback(this.manager,type,{pointers:touches[0],changedPointers:touches[1],pointerType:INPUT_TYPE_TOUCH,srcEvent:ev})}});function normalizeSingleTouches(ev,type){var all=toArray(ev.touches);var changed=toArray(ev.changedTouches);if(type&(INPUT_END|INPUT_CANCEL)){all=uniqueArray(all.concat(changed),"identifier",true)}return[all,changed]}var TOUCH_INPUT_MAP={touchstart:INPUT_START,touchmove:INPUT_MOVE,touchend:INPUT_END,touchcancel:INPUT_CANCEL};var TOUCH_TARGET_EVENTS="touchstart touchmove touchend touchcancel";function TouchInput(){this.evTarget=TOUCH_TARGET_EVENTS;this.targetIds={};Input.apply(this,arguments)}inherit(TouchInput,Input,{handler:function MTEhandler(ev){var type=TOUCH_INPUT_MAP[ev.type];var touches=getTouches.call(this,ev,type);if(!touches){return}this.callback(this.manager,type,{pointers:touches[0],changedPointers:touches[1],pointerType:INPUT_TYPE_TOUCH,srcEvent:ev})}});function getTouches(ev,type){var allTouches=toArray(ev.touches);var targetIds=this.targetIds;if(type&(INPUT_START|INPUT_MOVE)&&allTouches.length===1){targetIds[allTouches[0].identifier]=true;return[allTouches,allTouches]}var i,targetTouches,changedTouches=toArray(ev.changedTouches),changedTargetTouches=[],target=this.target;targetTouches=allTouches.filter(function(touch){return hasParent(touch.target,target)});if(type===INPUT_START){i=0;while(i<targetTouches.length){targetIds[targetTouches[i].identifier]=true;i++}}i=0;while(i<changedTouches.length){if(targetIds[changedTouches[i].identifier]){changedTargetTouches.push(changedTouches[i])}if(type&(INPUT_END|INPUT_CANCEL)){delete targetIds[changedTouches[i].identifier]}i++}if(!changedTargetTouches.length){return}return[uniqueArray(targetTouches.concat(changedTargetTouches),"identifier",true),changedTargetTouches]}function TouchMouseInput(){Input.apply(this,arguments);var handler=bindFn(this.handler,this);this.touch=new TouchInput(this.manager,handler);this.mouse=new MouseInput(this.manager,handler)}inherit(TouchMouseInput,Input,{handler:function TMEhandler(manager,inputEvent,inputData){var isTouch=inputData.pointerType==INPUT_TYPE_TOUCH,isMouse=inputData.pointerType==INPUT_TYPE_MOUSE;if(isTouch){this.mouse.allow=false}else if(isMouse&&!this.mouse.allow){return}if(inputEvent&(INPUT_END|INPUT_CANCEL)){this.mouse.allow=true}this.callback(manager,inputEvent,inputData)},destroy:function destroy(){this.touch.destroy();this.mouse.destroy()}});var PREFIXED_TOUCH_ACTION=prefixed(TEST_ELEMENT.style,"touchAction");var NATIVE_TOUCH_ACTION=PREFIXED_TOUCH_ACTION!==undefined;var TOUCH_ACTION_COMPUTE="compute";var TOUCH_ACTION_AUTO="auto";var TOUCH_ACTION_MANIPULATION="manipulation";var TOUCH_ACTION_NONE="none";var TOUCH_ACTION_PAN_X="pan-x";var TOUCH_ACTION_PAN_Y="pan-y";function TouchAction(manager,value){this.manager=manager;this.set(value)}TouchAction.prototype={set:function(value){if(value==TOUCH_ACTION_COMPUTE){value=this.compute()}if(NATIVE_TOUCH_ACTION){this.manager.element.style[PREFIXED_TOUCH_ACTION]=value}this.actions=value.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var actions=[];each(this.manager.recognizers,function(recognizer){if(boolOrFn(recognizer.options.enable,[recognizer])){actions=actions.concat(recognizer.getTouchAction())}});return cleanTouchActions(actions.join(" "))},preventDefaults:function(input){if(NATIVE_TOUCH_ACTION){return}var srcEvent=input.srcEvent;var direction=input.offsetDirection;if(this.manager.session.prevented){srcEvent.preventDefault();return}var actions=this.actions;var hasNone=inStr(actions,TOUCH_ACTION_NONE);var hasPanY=inStr(actions,TOUCH_ACTION_PAN_Y);var hasPanX=inStr(actions,TOUCH_ACTION_PAN_X);if(hasNone||hasPanY&&direction&DIRECTION_HORIZONTAL||hasPanX&&direction&DIRECTION_VERTICAL){return this.preventSrc(srcEvent)}},preventSrc:function(srcEvent){this.manager.session.prevented=true;srcEvent.preventDefault()}};function cleanTouchActions(actions){if(inStr(actions,TOUCH_ACTION_NONE)){return TOUCH_ACTION_NONE}var hasPanX=inStr(actions,TOUCH_ACTION_PAN_X);var hasPanY=inStr(actions,TOUCH_ACTION_PAN_Y);if(hasPanX&&hasPanY){return TOUCH_ACTION_PAN_X+" "+TOUCH_ACTION_PAN_Y}if(hasPanX||hasPanY){return hasPanX?TOUCH_ACTION_PAN_X:TOUCH_ACTION_PAN_Y}if(inStr(actions,TOUCH_ACTION_MANIPULATION)){return TOUCH_ACTION_MANIPULATION}return TOUCH_ACTION_AUTO}var STATE_POSSIBLE=1;var STATE_BEGAN=2;var STATE_CHANGED=4;var STATE_ENDED=8;var STATE_RECOGNIZED=STATE_ENDED;var STATE_CANCELLED=16;var STATE_FAILED=32;function Recognizer(options){this.id=uniqueId();this.manager=null;this.options=merge(options||{},this.defaults);this.options.enable=ifUndefined(this.options.enable,true);this.state=STATE_POSSIBLE;this.simultaneous={};this.requireFail=[]}Recognizer.prototype={defaults:{},set:function(options){extend(this.options,options);this.manager&&this.manager.touchAction.update();return this},recognizeWith:function(otherRecognizer){if(invokeArrayArg(otherRecognizer,"recognizeWith",this)){return this}var simultaneous=this.simultaneous;otherRecognizer=getRecognizerByNameIfManager(otherRecognizer,this);if(!simultaneous[otherRecognizer.id]){simultaneous[otherRecognizer.id]=otherRecognizer;otherRecognizer.recognizeWith(this)}return this},dropRecognizeWith:function(otherRecognizer){if(invokeArrayArg(otherRecognizer,"dropRecognizeWith",this)){return this}otherRecognizer=getRecognizerByNameIfManager(otherRecognizer,this);delete this.simultaneous[otherRecognizer.id];return this},requireFailure:function(otherRecognizer){if(invokeArrayArg(otherRecognizer,"requireFailure",this)){return this}var requireFail=this.requireFail;otherRecognizer=getRecognizerByNameIfManager(otherRecognizer,this);if(inArray(requireFail,otherRecognizer)===-1){requireFail.push(otherRecognizer);otherRecognizer.requireFailure(this)}return this},dropRequireFailure:function(otherRecognizer){if(invokeArrayArg(otherRecognizer,"dropRequireFailure",this)){return this}otherRecognizer=getRecognizerByNameIfManager(otherRecognizer,this);var index=inArray(this.requireFail,otherRecognizer);if(index>-1){this.requireFail.splice(index,1)}return this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(otherRecognizer){return!!this.simultaneous[otherRecognizer.id]},emit:function(input){var self=this;var state=this.state;function emit(withState){self.manager.emit(self.options.event+(withState?stateStr(state):""),input)}if(state<STATE_ENDED){emit(true)}emit();if(state>=STATE_ENDED){emit(true)}},tryEmit:function(input){if(this.canEmit()){return this.emit(input)}this.state=STATE_FAILED},canEmit:function(){var i=0;while(i<this.requireFail.length){if(!(this.requireFail[i].state&(STATE_FAILED|STATE_POSSIBLE))){return false}i++}return true},recognize:function(inputData){var inputDataClone=extend({},inputData);if(!boolOrFn(this.options.enable,[this,inputDataClone])){this.reset();this.state=STATE_FAILED;return}if(this.state&(STATE_RECOGNIZED|STATE_CANCELLED|STATE_FAILED)){this.state=STATE_POSSIBLE}this.state=this.process(inputDataClone);if(this.state&(STATE_BEGAN|STATE_CHANGED|STATE_ENDED|STATE_CANCELLED)){this.tryEmit(inputDataClone)}},process:function(inputData){},getTouchAction:function(){},reset:function(){}};function stateStr(state){if(state&STATE_CANCELLED){return"cancel"}else if(state&STATE_ENDED){return"end"}else if(state&STATE_CHANGED){return"move"}else if(state&STATE_BEGAN){return"start"}return""}function directionStr(direction){if(direction==DIRECTION_DOWN){return"down"}else if(direction==DIRECTION_UP){return"up"}else if(direction==DIRECTION_LEFT){return"left"}else if(direction==DIRECTION_RIGHT){return"right"}return""}function getRecognizerByNameIfManager(otherRecognizer,recognizer){var manager=recognizer.manager;if(manager){return manager.get(otherRecognizer)}return otherRecognizer}function AttrRecognizer(){Recognizer.apply(this,arguments)}inherit(AttrRecognizer,Recognizer,{defaults:{pointers:1},attrTest:function(input){var optionPointers=this.options.pointers;return optionPointers===0||input.pointers.length===optionPointers},process:function(input){var state=this.state;var eventType=input.eventType;var isRecognized=state&(STATE_BEGAN|STATE_CHANGED);var isValid=this.attrTest(input);if(isRecognized&&(eventType&INPUT_CANCEL||!isValid)){return state|STATE_CANCELLED}else if(isRecognized||isValid){if(eventType&INPUT_END){return state|STATE_ENDED}else if(!(state&STATE_BEGAN)){return STATE_BEGAN}return state|STATE_CHANGED}return STATE_FAILED}});function PanRecognizer(){AttrRecognizer.apply(this,arguments);this.pX=null;this.pY=null}inherit(PanRecognizer,AttrRecognizer,{defaults:{event:"pan",threshold:10,pointers:1,direction:DIRECTION_ALL},getTouchAction:function(){var direction=this.options.direction;var actions=[];if(direction&DIRECTION_HORIZONTAL){actions.push(TOUCH_ACTION_PAN_Y)}if(direction&DIRECTION_VERTICAL){actions.push(TOUCH_ACTION_PAN_X)}return actions},directionTest:function(input){
var options=this.options;var hasMoved=true;var distance=input.distance;var direction=input.direction;var x=input.deltaX;var y=input.deltaY;if(!(direction&options.direction)){if(options.direction&DIRECTION_HORIZONTAL){direction=x===0?DIRECTION_NONE:x<0?DIRECTION_LEFT:DIRECTION_RIGHT;hasMoved=x!=this.pX;distance=Math.abs(input.deltaX)}else{direction=y===0?DIRECTION_NONE:y<0?DIRECTION_UP:DIRECTION_DOWN;hasMoved=y!=this.pY;distance=Math.abs(input.deltaY)}}input.direction=direction;return hasMoved&&distance>options.threshold&&direction&options.direction},attrTest:function(input){return AttrRecognizer.prototype.attrTest.call(this,input)&&(this.state&STATE_BEGAN||!(this.state&STATE_BEGAN)&&this.directionTest(input))},emit:function(input){this.pX=input.deltaX;this.pY=input.deltaY;var direction=directionStr(input.direction);if(direction){this.manager.emit(this.options.event+direction,input)}this._super.emit.call(this,input)}});function PinchRecognizer(){AttrRecognizer.apply(this,arguments)}inherit(PinchRecognizer,AttrRecognizer,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[TOUCH_ACTION_NONE]},attrTest:function(input){return this._super.attrTest.call(this,input)&&(Math.abs(input.scale-1)>this.options.threshold||this.state&STATE_BEGAN)},emit:function(input){this._super.emit.call(this,input);if(input.scale!==1){var inOut=input.scale<1?"in":"out";this.manager.emit(this.options.event+inOut,input)}}});function PressRecognizer(){Recognizer.apply(this,arguments);this._timer=null;this._input=null}inherit(PressRecognizer,Recognizer,{defaults:{event:"press",pointers:1,time:500,threshold:5},getTouchAction:function(){return[TOUCH_ACTION_AUTO]},process:function(input){var options=this.options;var validPointers=input.pointers.length===options.pointers;var validMovement=input.distance<options.threshold;var validTime=input.deltaTime>options.time;this._input=input;if(!validMovement||!validPointers||input.eventType&(INPUT_END|INPUT_CANCEL)&&!validTime){this.reset()}else if(input.eventType&INPUT_START){this.reset();this._timer=setTimeoutContext(function(){this.state=STATE_RECOGNIZED;this.tryEmit()},options.time,this)}else if(input.eventType&INPUT_END){return STATE_RECOGNIZED}return STATE_FAILED},reset:function(){clearTimeout(this._timer)},emit:function(input){if(this.state!==STATE_RECOGNIZED){return}if(input&&input.eventType&INPUT_END){this.manager.emit(this.options.event+"up",input)}else{this._input.timeStamp=now();this.manager.emit(this.options.event,this._input)}}});function RotateRecognizer(){AttrRecognizer.apply(this,arguments)}inherit(RotateRecognizer,AttrRecognizer,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[TOUCH_ACTION_NONE]},attrTest:function(input){return this._super.attrTest.call(this,input)&&(Math.abs(input.rotation)>this.options.threshold||this.state&STATE_BEGAN)}});function SwipeRecognizer(){AttrRecognizer.apply(this,arguments)}inherit(SwipeRecognizer,AttrRecognizer,{defaults:{event:"swipe",threshold:10,velocity:.65,direction:DIRECTION_HORIZONTAL|DIRECTION_VERTICAL,pointers:1},getTouchAction:function(){return PanRecognizer.prototype.getTouchAction.call(this)},attrTest:function(input){var direction=this.options.direction;var velocity;if(direction&(DIRECTION_HORIZONTAL|DIRECTION_VERTICAL)){velocity=input.velocity}else if(direction&DIRECTION_HORIZONTAL){velocity=input.velocityX}else if(direction&DIRECTION_VERTICAL){velocity=input.velocityY}return this._super.attrTest.call(this,input)&&direction&input.direction&&input.distance>this.options.threshold&&abs(velocity)>this.options.velocity&&input.eventType&INPUT_END},emit:function(input){var direction=directionStr(input.direction);if(direction){this.manager.emit(this.options.event+direction,input)}this.manager.emit(this.options.event,input)}});function TapRecognizer(){Recognizer.apply(this,arguments);this.pTime=false;this.pCenter=false;this._timer=null;this._input=null;this.count=0}inherit(TapRecognizer,Recognizer,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:2,posThreshold:10},getTouchAction:function(){return[TOUCH_ACTION_MANIPULATION]},process:function(input){var options=this.options;var validPointers=input.pointers.length===options.pointers;var validMovement=input.distance<options.threshold;var validTouchTime=input.deltaTime<options.time;this.reset();if(input.eventType&INPUT_START&&this.count===0){return this.failTimeout()}if(validMovement&&validTouchTime&&validPointers){if(input.eventType!=INPUT_END){return this.failTimeout()}var validInterval=this.pTime?input.timeStamp-this.pTime<options.interval:true;var validMultiTap=!this.pCenter||getDistance(this.pCenter,input.center)<options.posThreshold;this.pTime=input.timeStamp;this.pCenter=input.center;if(!validMultiTap||!validInterval){this.count=1}else{this.count+=1}this._input=input;var tapCount=this.count%options.taps;if(tapCount===0){if(!this.hasRequireFailures()){return STATE_RECOGNIZED}else{this._timer=setTimeoutContext(function(){this.state=STATE_RECOGNIZED;this.tryEmit()},options.interval,this);return STATE_BEGAN}}}return STATE_FAILED},failTimeout:function(){this._timer=setTimeoutContext(function(){this.state=STATE_FAILED},this.options.interval,this);return STATE_FAILED},reset:function(){clearTimeout(this._timer)},emit:function(){if(this.state==STATE_RECOGNIZED){this._input.tapCount=this.count;this.manager.emit(this.options.event,this._input)}}});function Hammer(element,options){options=options||{};options.recognizers=ifUndefined(options.recognizers,Hammer.defaults.preset);return new Manager(element,options)}Hammer.VERSION="2.0.4";Hammer.defaults={domEvents:false,touchAction:TOUCH_ACTION_COMPUTE,enable:true,inputTarget:null,inputClass:null,preset:[[RotateRecognizer,{enable:false}],[PinchRecognizer,{enable:false},["rotate"]],[SwipeRecognizer,{direction:DIRECTION_HORIZONTAL}],[PanRecognizer,{direction:DIRECTION_HORIZONTAL},["swipe"]],[TapRecognizer],[TapRecognizer,{event:"doubletap",taps:2},["tap"]],[PressRecognizer]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var STOP=1;var FORCED_STOP=2;function Manager(element,options){options=options||{};this.options=merge(options,Hammer.defaults);this.options.inputTarget=this.options.inputTarget||element;this.handlers={};this.session={};this.recognizers=[];this.element=element;this.input=createInputInstance(this);this.touchAction=new TouchAction(this,this.options.touchAction);toggleCssProps(this,true);each(options.recognizers,function(item){var recognizer=this.add(new item[0](item[1]));item[2]&&recognizer.recognizeWith(item[2]);item[3]&&recognizer.requireFailure(item[3])},this)}Manager.prototype={set:function(options){extend(this.options,options);if(options.touchAction){this.touchAction.update()}if(options.inputTarget){this.input.destroy();this.input.target=options.inputTarget;this.input.init()}return this},stop:function(force){this.session.stopped=force?FORCED_STOP:STOP},recognize:function(inputData){var session=this.session;if(session.stopped){return}this.touchAction.preventDefaults(inputData);var recognizer;var recognizers=this.recognizers;var curRecognizer=session.curRecognizer;if(!curRecognizer||curRecognizer&&curRecognizer.state&STATE_RECOGNIZED){curRecognizer=session.curRecognizer=null}var i=0;while(i<recognizers.length){recognizer=recognizers[i];if(session.stopped!==FORCED_STOP&&(!curRecognizer||recognizer==curRecognizer||recognizer.canRecognizeWith(curRecognizer))){recognizer.recognize(inputData)}else{recognizer.reset()}if(!curRecognizer&&recognizer.state&(STATE_BEGAN|STATE_CHANGED|STATE_ENDED)){curRecognizer=session.curRecognizer=recognizer}i++}},get:function(recognizer){if(recognizer instanceof Recognizer){return recognizer}var recognizers=this.recognizers;for(var i=0;i<recognizers.length;i++){if(recognizers[i].options.event==recognizer){return recognizers[i]}}return null},add:function(recognizer){if(invokeArrayArg(recognizer,"add",this)){return this}var existing=this.get(recognizer.options.event);if(existing){this.remove(existing)}this.recognizers.push(recognizer);recognizer.manager=this;this.touchAction.update();return recognizer},remove:function(recognizer){if(invokeArrayArg(recognizer,"remove",this)){return this}var recognizers=this.recognizers;recognizer=this.get(recognizer);recognizers.splice(inArray(recognizers,recognizer),1);this.touchAction.update();return this},on:function(events,handler){var handlers=this.handlers;each(splitStr(events),function(event){handlers[event]=handlers[event]||[];handlers[event].push(handler)});return this},off:function(events,handler){var handlers=this.handlers;each(splitStr(events),function(event){if(!handler){delete handlers[event]}else{handlers[event].splice(inArray(handlers[event],handler),1)}});return this},emit:function(event,data){if(this.options.domEvents){triggerDomEvent(event,data)}var handlers=this.handlers[event]&&this.handlers[event].slice();if(!handlers||!handlers.length){return}data.type=event;data.preventDefault=function(){data.srcEvent.preventDefault()};var i=0;while(i<handlers.length){handlers[i](data);i++}},destroy:function(){this.element&&toggleCssProps(this,false);this.handlers={};this.session={};this.input.destroy();this.element=null}};function toggleCssProps(manager,add){var element=manager.element;each(manager.options.cssProps,function(value,name){element.style[prefixed(element.style,name)]=add?value:""})}function triggerDomEvent(event,data){var gestureEvent=document.createEvent("Event");gestureEvent.initEvent(event,true,true);gestureEvent.gesture=data;data.target.dispatchEvent(gestureEvent)}extend(Hammer,{INPUT_START:INPUT_START,INPUT_MOVE:INPUT_MOVE,INPUT_END:INPUT_END,INPUT_CANCEL:INPUT_CANCEL,STATE_POSSIBLE:STATE_POSSIBLE,STATE_BEGAN:STATE_BEGAN,STATE_CHANGED:STATE_CHANGED,STATE_ENDED:STATE_ENDED,STATE_RECOGNIZED:STATE_RECOGNIZED,STATE_CANCELLED:STATE_CANCELLED,STATE_FAILED:STATE_FAILED,DIRECTION_NONE:DIRECTION_NONE,DIRECTION_LEFT:DIRECTION_LEFT,DIRECTION_RIGHT:DIRECTION_RIGHT,DIRECTION_UP:DIRECTION_UP,DIRECTION_DOWN:DIRECTION_DOWN,DIRECTION_HORIZONTAL:DIRECTION_HORIZONTAL,DIRECTION_VERTICAL:DIRECTION_VERTICAL,DIRECTION_ALL:DIRECTION_ALL,Manager:Manager,Input:Input,TouchAction:TouchAction,TouchInput:TouchInput,MouseInput:MouseInput,PointerEventInput:PointerEventInput,TouchMouseInput:TouchMouseInput,SingleTouchInput:SingleTouchInput,Recognizer:Recognizer,AttrRecognizer:AttrRecognizer,Tap:TapRecognizer,Pan:PanRecognizer,Swipe:SwipeRecognizer,Pinch:PinchRecognizer,Rotate:RotateRecognizer,Press:PressRecognizer,on:addEventListeners,off:removeEventListeners,each:each,merge:merge,extend:extend,inherit:inherit,bindFn:bindFn,prefixed:prefixed});if(typeof define==TYPE_FUNCTION&&define.amd){define(function(){return Hammer})}else if(typeof module!="undefined"&&module.exports){module.exports=Hammer}else{window[exportName]=Hammer}})(window,document,"Hammer");browserify_shim__define__module__export__(typeof Hammer!="undefined"?Hammer:window.Hammer)}).call(global,undefined,undefined,undefined,undefined,function defineExport(ex){module.exports=ex})}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],34:[function(require,module,exports){var now=require("performance-now"),global=typeof window==="undefined"?{}:window,vendors=["moz","webkit"],suffix="AnimationFrame",raf=global["request"+suffix],caf=global["cancel"+suffix]||global["cancelRequest"+suffix],isNative=true;for(var i=0;i<vendors.length&&!raf;i++){raf=global[vendors[i]+"Request"+suffix];caf=global[vendors[i]+"Cancel"+suffix]||global[vendors[i]+"CancelRequest"+suffix]}if(!raf||!caf){isNative=false;var last=0,id=0,queue=[],frameDuration=1e3/60;raf=function(callback){if(queue.length===0){var _now=now(),next=Math.max(0,frameDuration-(_now-last));last=next+_now;setTimeout(function(){var cp=queue.slice(0);queue.length=0;for(var i=0;i<cp.length;i++){if(!cp[i].cancelled){try{cp[i].callback(last)}catch(e){setTimeout(function(){throw e},0)}}}},Math.round(next))}queue.push({handle:++id,callback:callback,cancelled:false});return id};caf=function(handle){for(var i=0;i<queue.length;i++){if(queue[i].handle===handle){queue[i].cancelled=true}}}}module.exports=function(fn){if(!isNative){return raf.call(global,fn)}return raf.call(global,function(){try{fn.apply(this,arguments)}catch(e){setTimeout(function(){throw e},0)}})};module.exports.cancel=function(){caf.apply(global,arguments)}},{"performance-now":35}],35:[function(require,module,exports){(function(process){(function(){var getNanoSeconds,hrtime,loadTime;if(typeof performance!=="undefined"&&performance!==null&&performance.now){module.exports=function(){return performance.now()}}else if(typeof process!=="undefined"&&process!==null&&process.hrtime){module.exports=function(){return(getNanoSeconds()-loadTime)/1e6};hrtime=process.hrtime;getNanoSeconds=function(){var hr;hr=hrtime();return hr[0]*1e9+hr[1]};loadTime=getNanoSeconds()}else if(Date.now){module.exports=function(){return Date.now()-loadTime};loadTime=Date.now()}else{module.exports=function(){return(new Date).getTime()-loadTime};loadTime=(new Date).getTime()}}).call(this)}).call(this,require("_process"))},{_process:36}],36:[function(require,module,exports){var process=module.exports={};var queue=[];var draining=false;var currentQueue;var queueIndex=-1;function cleanUpNextTick(){draining=false;if(currentQueue.length){queue=currentQueue.concat(queue)}else{queueIndex=-1}if(queue.length){drainQueue()}}function drainQueue(){if(draining){return}var timeout=setTimeout(cleanUpNextTick);draining=true;var len=queue.length;while(len){currentQueue=queue;queue=[];while(++queueIndex<len){currentQueue[queueIndex].run()}queueIndex=-1;len=queue.length}currentQueue=null;draining=false;clearTimeout(timeout)}process.nextTick=function(fun){var args=new Array(arguments.length-1);if(arguments.length>1){for(var i=1;i<arguments.length;i++){args[i-1]=arguments[i]}}queue.push(new Item(fun,args));if(queue.length===1&&!draining){setTimeout(drainQueue,0)}};function Item(fun,array){this.fun=fun;this.array=array}Item.prototype.run=function(){this.fun.apply(null,this.array)};process.title="browser";process.browser=true;process.env={};process.argv=[];process.version="";process.versions={};function noop(){}process.on=noop;process.addListener=noop;process.once=noop;process.off=noop;process.removeListener=noop;process.removeAllListeners=noop;process.emit=noop;process.binding=function(name){throw new Error("process.binding is not supported")};process.cwd=function(){return"/"};process.chdir=function(dir){throw new Error("process.chdir is not supported")};process.umask=function(){return 0}},{}]},{},[4]);