@using Model.Extended
@model IList<NoteData>

<div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
    <h4 class="modal-title">Notes</h4>

</div>
<div class="modal-body">
    

    @{
             
        if (Model.Count > 0) {
            string pattern = @"!\[Image Description\]\((?<link>.*)\)";
            string replacement = "<img src=\"${link}\">";
            //string input = "Detailed Flipflop diagram ![Image Description](http://cpuville.com/images/register_2.jpg) to use";
             
            foreach (var note in Model)
            {
                string noteText = "";
                var annotatedText = "\"" + @note.QuotedText + "\"";
                if(@note.NoteText != null)
                    noteText = System.Text.RegularExpressions.Regex.Replace(@note.NoteText, pattern, replacement);
                
                    
                
                <div class="single-note-box">
                    <p class="text-primary"><em>@annotatedText</em></p>
                    <p class="text-info"><small>@noteText</small></p>
                </div>
            }
        }
        else
        {
            <p class="text-warning"><em>No notes for this page</em></p>
        }

    }

</div>
<div class="modal-footer">
    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
    @*<button type="button" class="btn btn-primary">Save changes</button>*@
</div>