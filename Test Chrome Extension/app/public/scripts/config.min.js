(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){function configureHttp($httpProvider){$httpProvider.defaults.xsrfHeaderName="X-CSRF-Token";$httpProvider.interceptors.push("jwtInterceptor")}configureHttp.$inject=["$httpProvider"];module.exports=configureHttp},{}],2:[function(require,module,exports){var querystring=require("querystring");var authPromise=null;var tokenPromise=null;var currentToken=null;function fetchToken($http,$q,jwtHelper,serviceUrl,session){var tokenUrl=new URL("token",serviceUrl).href;if(currentToken===null||jwtHelper.isTokenExpired(currentToken)){if(tokenPromise===null){var data={assertion:session.state.csrf};var config={params:data,skipAuthorization:true,transformRequest:function(data){return querystring.stringify(data)}};var request=$http.get(tokenUrl,config);tokenPromise=request.then(function(response){tokenPromise=null;currentToken=response.data;return currentToken})}return tokenPromise}else{return $q.when(currentToken)}}fetchToken.$inject=["$http","$q","jwtHelper","serviceUrl","session"];function tokenGetter($injector,config,serviceUrl){var requestUrl=config.url;if(requestUrl!==serviceUrl){if(requestUrl.slice(0,serviceUrl.length)===serviceUrl){return authPromise.then(function(){return $injector.invoke(fetchToken)}).catch(function(){return null})}}return null}tokenGetter.$inject=["$injector","config","serviceUrl"];function checkAuthentication($injector,$q,session){if(authPromise===null){var deferred=$q.defer();authPromise=deferred.promise;session.load().$promise.then(function(data){if(data.userid){$injector.invoke(fetchToken).then(function(token){deferred.resolve(token)})}else{deferred.reject("no session")}}).catch(function(){deferred.reject("request failure")})}return authPromise}checkAuthentication.$inject=["$injector","$q","session"];function forgetAuthentication($q,flash,session){return session.logout({}).$promise.then(function(){authPromise=$q.reject("no session");tokenPromise=null;currentToken=null;return null}).catch(function(err){flash.error("Sign out failed!");throw err})}forgetAuthentication.$inject=["$q","flash","session"];function requestAuthentication($injector,$q,$rootScope){return authPromise.catch(function(){var deferred=$q.defer();$rootScope.$on("auth",function(event,err,data){if(err){deferred.reject(err)}else{$injector.invoke(fetchToken).then(function(token){authPromise=deferred.promise;deferred.resolve(token)})}});return deferred.promise})}requestAuthentication.$inject=["$injector","$q","$rootScope"];function configureIdentity(identityProvider,jwtInterceptorProvider){identityProvider.checkAuthentication=checkAuthentication;identityProvider.forgetAuthentication=forgetAuthentication;identityProvider.requestAuthentication=requestAuthentication;jwtInterceptorProvider.tokenGetter=tokenGetter}configureIdentity.$inject=["identityProvider","jwtInterceptorProvider"];module.exports=configureIdentity},{querystring:6}],3:[function(require,module,exports){(function(global){var angular=typeof window!=="undefined"?window["angular"]:typeof global!=="undefined"?global["angular"]:null;var configureHttp=require("./http");var configureIdentity=require("./identity");module.exports=angular.module("h").config(configureHttp).config(configureIdentity)}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./http":1,"./identity":2}],4:[function(require,module,exports){"use strict";function hasOwnProperty(obj,prop){return Object.prototype.hasOwnProperty.call(obj,prop)}module.exports=function(qs,sep,eq,options){sep=sep||"&";eq=eq||"=";var obj={};if(typeof qs!=="string"||qs.length===0){return obj}var regexp=/\+/g;qs=qs.split(sep);var maxKeys=1e3;if(options&&typeof options.maxKeys==="number"){maxKeys=options.maxKeys}var len=qs.length;if(maxKeys>0&&len>maxKeys){len=maxKeys}for(var i=0;i<len;++i){var x=qs[i].replace(regexp,"%20"),idx=x.indexOf(eq),kstr,vstr,k,v;if(idx>=0){kstr=x.substr(0,idx);vstr=x.substr(idx+1)}else{kstr=x;vstr=""}k=decodeURIComponent(kstr);v=decodeURIComponent(vstr);if(!hasOwnProperty(obj,k)){obj[k]=v}else if(isArray(obj[k])){obj[k].push(v)}else{obj[k]=[obj[k],v]}}return obj};var isArray=Array.isArray||function(xs){return Object.prototype.toString.call(xs)==="[object Array]"}},{}],5:[function(require,module,exports){"use strict";var stringifyPrimitive=function(v){switch(typeof v){case"string":return v;case"boolean":return v?"true":"false";case"number":return isFinite(v)?v:"";default:return""}};module.exports=function(obj,sep,eq,name){sep=sep||"&";eq=eq||"=";if(obj===null){obj=undefined}if(typeof obj==="object"){return map(objectKeys(obj),function(k){var ks=encodeURIComponent(stringifyPrimitive(k))+eq;if(isArray(obj[k])){return map(obj[k],function(v){return ks+encodeURIComponent(stringifyPrimitive(v))}).join(sep)}else{return ks+encodeURIComponent(stringifyPrimitive(obj[k]))}}).join(sep)}if(!name)return"";return encodeURIComponent(stringifyPrimitive(name))+eq+encodeURIComponent(stringifyPrimitive(obj))};var isArray=Array.isArray||function(xs){return Object.prototype.toString.call(xs)==="[object Array]"};function map(xs,f){if(xs.map)return xs.map(f);var res=[];for(var i=0;i<xs.length;i++){res.push(f(xs[i],i))}return res}var objectKeys=Object.keys||function(obj){var res=[];for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))res.push(key)}return res}},{}],6:[function(require,module,exports){"use strict";exports.decode=exports.parse=require("./decode");exports.encode=exports.stringify=require("./encode")},{"./decode":4,"./encode":5}]},{},[3]);